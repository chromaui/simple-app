import{r as t,c as s,h as i,H as h,g as e}from"./p-0d847530.js";import{a1 as r,aV as n,b9 as o,b8 as a,t as c,ak as d,dj as l}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import"./p-0d62bf9d.js";import"./p-d70b188c.js";import"./p-815d6c40.js";const u=class{constructor(i){t(this,i),this.value=null,this.readonly=!1,this.isVisible=!0,this.colorsZone=["light-orange","transparent","danger-light"],this.zones=[],this.zoneData=[],this.validityChanged=s(this,"validityChanged",7),this.inputBlurred=s(this,"inputBlurred",7),this.inputFocused=s(this,"inputFocused",7),this.inputChanged=s(this,"inputChanged",7),this.dragStarted=s(this,"dragStarted",7),this.dragEnded=s(this,"dragEnded",7)}async isValid(){this.validate()}componentWillLoad(){this.zoneData=this.setConfigZones(),this.setEasingAnimation()}componentDidLoad(){this.outerContainer&&(this.zoneElements=Array.from(this.outerContainer.querySelectorAll(".drop-zone")),this.zoneElements&&(this.setDropZones(),this.setTags(),this.setWordsCounter()))}validate(){return this.checkArray(this.value)&&(this.validity=r(this.value.map(t=>t.length),this.answer.map(t=>t.length))),this.validityChanged.emit(this.validity),this.validity}setEasingAnimation(){try{this.ease=n.easeOut.config(.5)}catch(t){}}setDropZones(){this.zones=this.zoneData.map(t=>this.setDropZone(t))}setDropZone(t){return t.element=this.zoneElements.find(s=>s.id===t.id),t.parent=t&&t.element&&t.element.parentNode,t}setConfigZones(){return[1,2,3].map(t=>{let s={};return s.id=`zone-${t}`,s.grid=!0,s.colorClass=this.colorsZone[t-1],s.threshold="60%",s.sortProp="value",s.parent=null,s.element=null,s.tags=[],this.checkArray(this.answer)&&(1===t?s.answers=this.answer[0]:3===t&&(s.answers=this.answer[1])),s})}addTagButton(t,s){if(t&&s){const i=document.createElement("yoo-button");return i.classList.add("tag"),i.text=s,"zone-2"!==t.id&&(i.textColor=t.colorClass),t.element&&t.element.appendChild(i)}}setTags(){!this.readonly&&this.checkArray(this.values)&&(this.checkArray(this.value)?(this.values.filter(t=>!this.value[0].includes(t)&&!this.value[1].includes(t)).sort().forEach(t=>this.setTag(t,1)),this.value.forEach((t,s)=>{t.forEach(t=>this.setTag(t,1===s?2:0))})):this.values.sort().forEach(t=>this.setTag(t,1)))}setConfigTag(t,s){let i={x:0,y:0,left:0,top:0};return i.value=t,i.zone=this.zoneData[s],i.element=this.addTagButton(i.zone,t),i.zone.element=i.element.parentElement,i.zone.element.appendChild(i.element),i.clone=i.element.cloneNode(!0),i.clone.text=i.value,i.clone.classList.add("clone"),i.lastZone=i.zone,i}setTweenLiteEffect(t,s){try{o.set(t,s)}catch(t){}}setTag(t,s){let i=this.setConfigTag(t,s);this.setTweenLiteEffect([i.element,i.clone],{x:"+=0"});const h=()=>{this.dragStarted.emit(!0),i.zone&&!this.hitTest(i.zone,i.clone,0)&&(i.lastZone=i.zone,this.removeTag(i),i.zone=null)},e=()=>{i.draggable.disable(),this.setTweenLiteEffect(i.element,{left:0,top:0}),i.zone||(i.zone=i.lastZone,this.zones.forEach(t=>{this.hitTest(t,i.clone)&&!this.isDropZoneFull(t)&&(i.zone=t)})),this.addTag(i);let t=this.getOffset(i),s={onComplete:()=>{this.outerContainer.removeChild(i.clone),i.element.textColor=i.zone.colorClass,this.setTweenLiteEffect(i.element,{autoAlpha:1})}};this.setTweenLiteEffect(i.element,{left:0,top:0}),s.x="-="+t.x,s.y="-="+t.y,o.to(i.clone,.3,s),this.setWordsCounter(),this.value=this.getUserAnswers(),l(this.value,this),this.dragEnded.emit(!0)};if(!this.readonly)try{i.draggable=new a(i.clone,{onDrag:h,onRelease:e,callbackScope:this}).disable()}catch(t){}this.addTag(i);const r=t=>{t.preventDefault();let s=this.getPosition(i.element),h=this.outerContainer.getBoundingClientRect();this.outerContainer.appendChild(i.clone),i.clone.style.top=`${s.y-h.top}px`,i.clone.style.left=`${s.x-h.left}px`,this.setTweenLiteEffect(i.element,{autoAlpha:0,zIndex:a.zIndex+1}),this.setTweenLiteEffect(i.clone,{transform:"unset"}),i.draggable.enable(),i.draggable.update(),i.draggable.startDrag(t)};return this.readonly||(i.element.onmousedown=r,i.element.ontouchstart=r),i}addTag(t){t.zone.tags.indexOf(t)<=-1&&(t.zone.tags.push(t),t.zone.element.appendChild(t.element),this.updateTags(t.zone),this.updatePosition(t),this.layoutTags(t.zone))}removeTag(t){let s=t.zone.tags.indexOf(t);s>=0&&(t.zone.tags.splice(s,1),t.zone.element.removeChild(t.element),this.updateTags(t.zone),this.layoutTags(t.zone))}updateTags(t){t.sortProp&&(this.sortTags(t),t.tags.forEach(s=>t.element.appendChild(s.element)))}layoutTags(t){t.tags.forEach(t=>this.layout(t))}setWordsCounter(){this.zones.forEach((t,s)=>{if("zone-2"!==t.id){const i=this.getMaxWords(s)||0,h=this.readonly?i:t.tags.length;t.parent.firstElementChild.querySelector(".words-counter").textContent=` ${h}/${i}`}})}getUserAnswers(){return this.zones.filter((t,s)=>1!==s).map(t=>t.tags).map(t=>t.map(t=>t.value))}isDropZoneFull(t){return"zone-2"!==t.id&&r(t.tags.length,t.answers.length)}getMaxWords(t){if(this.checkArray(this.answer))return 2===t?this.answer[1].length:this.answer[0].length}sortTags(t){t.tags.sort((s,i)=>{let h=s[t.sortProp],e=i[t.sortProp];if(h!==e){if(h>e||void 0===h)return 1;if(h<e||void 0===e)return-1}return s.index-i.index})}getOffset(t){let s=this.getPosition(t.clone),i=this.getPosition(t.zone.element);return{x:s.x-i.x-t.element.offsetLeft,y:s.y-i.y-t.element.offsetTop}}hitTest(t,s,i){return a.hitTest(s,t.parent,i||t.threshold)}layout(t){if(t&&t.isGrid)try{let s=t.element._gsTransform,i=t.x,h=t.y;t.x=t.element.offsetLeft,t.y=t.element.offsetTop,o.fromTo(t.element,.5,{x:s.x+i-t.x,y:s.y+h-t.y},{x:0,y:0,ease:this.ease})}catch(t){}}getPosition(t){const s=t.getBoundingClientRect(),i=window.scrollX||this.outerContainer.scrollLeft||0,h=window.scrollY||this.outerContainer.scrollTop||0;return{x:s.left+i-(this.outerContainer.clientLeft||0),y:s.top+h-(this.outerContainer.clientTop||0)}}updatePosition(t){t.x=t.element.offsetLeft,t.y=t.element.offsetTop,t.isGrid=t.zone.grid}getCategory(t){if(this.checkArray(this.categories))return this.categories[t]}checkArray(t){return t&&t.length&&Array.isArray(t)}renderTagsContainer(){if(!this.readonly)return i("div",{class:"tags-container"},i("div",{class:"description-container"},i("span",null,this.description),i("span",null,c("DRAGRIGHTWORDS"))),i("div",{class:"scroll-container"},i("div",{id:"zone-2",class:"drop-zone"})))}renderDropContainers(t){const s=1===t?0:1;return i("div",{class:{"drop-container":!0,[1===t?"top":"bottom"]:!0}},i("div",{class:"drop-title"},i("span",{class:"title"},this.getCategory(s)),i("span",{class:"words-counter"})),i("div",{id:`zone-${t}`,class:"drop-zone"},this.readonly&&this.checkArray(this.value)&&this.checkArray(this.answer)&&this.value[s].map(t=>i("yoo-button",{class:{tag:!0,success:this.answer[s].includes(t),danger:!this.answer[s].includes(t)},text:t}))))}renderBase(){return[1,2,3].map(t=>2!==t?this.renderDropContainers(t):this.renderTagsContainer())}render(){return i(h,{class:Object.assign({},d(),{readonly:this.readonly})},i("div",{class:"outer-container",ref:t=>this.outerContainer=t},this.renderBase()))}get host(){return e(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host .outer-container{display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;margin:1rem 0}:host .outer-container .tags-container{margin:.5rem 0}:host .outer-container .tags-container .description-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;margin:.5rem;line-height:1.75}:host .outer-container .tags-container .description-container span:first-child{font-weight:var(--font-weight-03,700)}:host .outer-container .tags-container .description-container span:last-child{color:var(--stable,#adadad)}:host .outer-container .drop-container{height:7.75rem;max-height:9rem;border-radius:var(--video-border,8px);-webkit-box-shadow:var(--card-shadow,0 2px 4px 0 rgba(40,47,54,.08));box-shadow:var(--card-shadow,0 2px 4px 0 rgba(40,47,54,.08))}:host .outer-container .drop-container.top{background-color:var(--light-orange,#fcae49)}:host .outer-container .drop-container.bottom{background-color:var(--danger-light,#f46885)}:host .outer-container .drop-container .drop-title{padding:.5rem 1rem;color:var(--light,#fff)}:host .outer-container .drop-container .drop-title .words-counter{padding-left:.25rem;opacity:.5}:host .outer-container .scroll-container{height:7rem;margin:.5rem 0;white-space:nowrap;overflow-x:auto}:host .outer-container .drop-zone{display:-ms-inline-flexbox;display:inline-flex;position:relative;-ms-flex-flow:row wrap;flex-flow:row wrap;height:100%;overflow:auto}:host .outer-container .drop-zone#zone-1,:host .outer-container .drop-zone#zone-3{max-height:5rem;padding:0 .5rem}:host .outer-container yoo-button{--transition:unset;display:block;position:relative;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;margin:.25rem}:host .outer-container yoo-button.clone{position:absolute;top:0;left:0}:host(.readonly) .outer-container .drop-container{background-color:var(--light,#fff)}:host(.readonly) .outer-container .drop-container .words-counter{opacity:1}:host(.readonly) .outer-container .drop-container.top .drop-title{color:var(--light-orange,#fcae49)}:host(.readonly) .outer-container .drop-container.bottom .drop-title{color:var(--danger-light,#f46885)}"}};export{u as yoo_form_categorize_words};