import{r as s,c as t,h as i,H as e,g as h}from"./p-0d847530.js";import{z as a,ap as r,cZ as n,cH as o,i as c,o as l,ak as d}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import"./p-0d62bf9d.js";import{a7 as m,a6 as u,dd as p,aO as g,a8 as f,j as y}from"./p-d70b188c.js";import"./p-815d6c40.js";const v=class{constructor(i){s(this,i),this.hideEmptyCheckbox=!1,this.isTouchEnded=!0,this.pressHoldOffset=1e3,this.pressholdEmitted=!1,this.clicked=t(this,"clicked",7),this.conferenceMessageClicked=t(this,"conferenceMessageClicked",7),this.presshold=t(this,"presshold",7),this.messageClick=t(this,"messageClick",7)}get isConferenceMessage(){return this.message&&"conference"===this.message.type}componentDidLoad(){if(this.messageDivRef&&!this.messageDivRef.classList.contains("audio")){let s=c()?"touchstart":"mousedown",t=c()?"touchend":"mouseup";this.messageDivRef.addEventListener(s,s=>this.onTouchStart(s),{passive:!0}),this.messageDivRef.addEventListener(t,s=>this.onTouchEnd(s),{passive:!0})}}onTouchStart(s){s&&(this.isTouchEnded=!1,setTimeout(()=>{this.isTouchEnded||(this.presshold.emit({message:this.message}),this.pressholdEmitted=!0),clearTimeout()},this.pressHoldOffset))}onTouchEnd(s){this.isTouchEnded=!0,s&&this.pressholdEmitted&&(s.stopPropagation(),s.preventDefault(),this.pressholdEmitted=!1)}onHasMentions(){return this.message&&this.message.mentions&&this.message.mentions.length>0}onClickMessage(s){this.message&&(!this.message.readonly&&this.message.author&&this.message.author._id===a().userId&&(this.message.selected=!this.message.selected,this.clicked.emit(this.message.selected)),this.isConferenceMessage&&this.message.content&&this.conferenceMessageClicked.emit(this.message.content),this.messageClick.emit(this.message.content))}onClickMessageContent(){if(this.message.readonly&&this.message.img)if(m(this.message.img))this.videoplayerRef&&this.videoplayerRef.togglePlay();else if(u(this.message.img)){let s=this.message.img;u(s)&&r(s)&&(s=n(s)),o(s,null,!0)}}renderConferenceMessage(){return i("div",{class:"conference-message-container"},i("yoo-icon",{class:"yo-play"}," "),this.message&&this.message.content)}renderUser(){return i("div",{class:"user-container"},this.message.author&&(this.isLast&&this.isFirst||this.isLast&&!this.isFirst)&&i("yoo-avatar",{class:"m",avatarIconSize:"m",user:this.message.author}))}renderTimeStamp(){return this.message.time&&this.isFirst&&i("div",{class:"info-container center"},i("span",null,p.timeAgo.transform(this.message.time)))}renderUserName(){return this.message.author&&this.message.author.firstName&&this.message.author.lastName?[i("div",{class:{username:!0}},`${this.message.author.firstName} ${this.message.author.lastName}`)]:null}renderVideoOnChat(){return i("div",{class:"image-container"},i("yoo-videoplayer-core",Object.assign({ref:s=>this.videoplayerRef=s},{class:"round",blockControlAndAutoPlayOnTap:!0,videoPlayerCoreParameters:{source:this.message.img,controls:!1}})))}renderImageOnChat(){return i("div",{class:"image-container"},i("yoo-img",{type:"image",class:"image radius",allowOrientation:!0,src:n(this.message.img)}))}renderInnerMessage(){return this.onHasMentions()?i("yoo-mention-tag",{class:{underline:!0,light:this.message&&this.message.isAlternate},allowTruncate:!1,mentionedList:this.message.mentions,description:this.message.content}):i("span",{innerHTML:g(this.message.content)})}renderAudioOnChat(s){return i("yoo-audio-player",{playerCommand:this.currentActivePlayerId,onHoldClickPressed:s=>{s&&this.presshold.emit({message:this.message})},blockEventOnPlay:!0,_downloadURL:s})}renderMedia(s){return m(s)||!c()&&s&&s.startsWith&&s.startsWith("blob:")?this.renderVideoOnChat():f(s)?this.renderAudioOnChat(s):this.renderImageOnChat()}renderText(){return i("span",{class:{text:!0,mention:this.onHasMentions()}},this.isConferenceMessage&&!c()?this.renderConferenceMessage():this.renderInnerMessage())}renderMessageContent(){return i("div",{ref:s=>this.messageDivRef=s,class:{"message-content":!0,first:this.isFirst,last:this.isLast,img:!l(this.message.img),"next-img":this.isNextImage,[y(this.message.img)]:!0},onClick:()=>this.onClickMessageContent()},this.message.options&&this.message.options.isLoading&&!this.message.options.hideLoading?i("yoo-loader",{class:"absolute transparent"}):this.renderText(),this.message.img&&this.renderMedia(this.message.img))}render(){return i(e,{class:d()},i("div",{class:"message "+(this.message.isAlternate?"user-message":"other-message"),onClick:s=>this.onClickMessage(s)},this.renderTimeStamp(),this.message.readonly?null:this.message.author&&this.message.author._id===a().userId?i("yoo-form-checkbox",{class:"btn-form-choice",value:this.message.selected}):this.hideEmptyCheckbox?null:i("div",{class:"empty-checkbox"}),this.isGroup&&this.message.author&&this.message.author._id!==a().userId?[this.isFirst&&this.renderUserName(),i("div",{class:"group-message-container"},this.renderUser(),this.renderMessageContent())]:this.renderMessageContent()))}get host(){return h(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host(.operations){--background-message-content:var(--success,#04cc99)}:host(.boost){--background-message-content:var(--danger-light,#f46885)}:host{--icon-total-width:54px;--message-container-padding-left:15%;--video-height:230px}:host .message{display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;max-width:100%;margin:.0625rem .2rem}\@-webkit-keyframes slide-left{0%{-webkit-transform:translateX(-.625rem);transform:translateX(-.625rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}\@keyframes slide-left{0%{-webkit-transform:translateX(-.625rem);transform:translateX(-.625rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}:host .message .empty-checkbox{width:var(--padding-15,.9375rem);height:var(--padding-15,.9375rem);margin:var(--padding-5,.3125rem)}:host .message .empty-checkbox,:host .message yoo-form-checkbox{-webkit-animation:slide-left .4s ease;animation:slide-left .4s ease}:host .message yoo-form-checkbox{--yo-circle-color:var(--stable,#adadad)!important}:host .message yoo-context-menu{width:100%}:host .message .message-content{display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;-ms-flex-item-align:end;align-self:flex-end;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:75%;padding:.5rem 1rem;border-radius:1.25rem;white-space:pre-wrap;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;word-wrap:break-word}:host .message .message-content.img{padding:0!important;background-color:transparent!important}:host .message .message-content.audio{width:300px!important}:host .message .message-content .image-container{width:232px;max-width:100%;height:100%;pointer-events:none}:host .message .message-content .image-container yoo-videoplayer-core{height:var(--video-height)}:host .message .message-content .image-container .image{width:100%;min-width:150px;height:100%;min-height:100px;border-radius:10px;background:var(--light,#fff)}:host .message .message-content .text{pointer-events:none}:host .message .message-content .text.mention,:host .message .message-content .text a{pointer-events:auto}:host .message .message-content .text a{color:var(--light,#fff)}:host .message .info-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:100%;margin:.2rem;color:var(--text-color,#807f83);font-size:var(--font-size-02,.875rem);white-space:nowrap}:host .message .info-container yoo-avatar{margin-right:.3rem}:host .message .info-container.center{-ms-flex-pack:center;justify-content:center}:host .message.user-message .message-content{max-width:75%;margin-left:auto;border-top-right-radius:5px;border-bottom-right-radius:5px;background:var(--background-message-content);color:var(--light,#fff);word-wrap:break-word}:host .message.user-message .message-content.last{border-bottom-right-radius:1.25rem}:host .message.user-message .message-content.first{border-top-right-radius:1.25rem}:host .message.user-message .info-container{margin-left:auto}:host .message.other-message .message-content{-ms-flex-item-align:start;align-self:flex-start;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-right:auto;border-top-left-radius:5px;border-bottom-left-radius:5px;background:var(--stable-light,#f1f1f1)}:host .message.other-message .message-content.last{border-bottom-left-radius:1.25rem}:host .message.other-message .message-content.first{border-top-left-radius:1.25rem}:host .message .username{display:-ms-flexbox;display:flex;width:100%;padding-bottom:3px;padding-left:var(--icon-total-width);color:var(--text-color,#807f83);font-size:var(--font-size-02,.875rem);text-align:left}:host .message .group-message-container{display:-ms-flexbox;display:flex;-ms-flex-align:end;align-items:flex-end;margin-bottom:var(--padding-15,.9375rem);padding-right:var(--message-container-padding-left)}:host .message .group-message-container .user-container{min-width:3.375rem}:host .message .group-message-container .message-content.next-img{border-radius:1.25rem}:host(.choice) .message.user-message{max-width:77%;float:right}:host(.choice) .message.user-message .empty-checkbox{position:absolute}:host(.choice) .message.user-message .message-content{-ms-flex-item-align:end;align-self:flex-end;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:100%;border:var(--border-width,1px) solid var(--danger-light,#f46885);border-radius:1.25rem;background:var(--light,#fff);color:var(--dark,#2b3648)}:host(.choice.selected) .message.user-message .message-content{background:var(--background-message-content);color:var(--light,#fff)}:host(.boost) .message .message-content{border-radius:1.25rem}"}};export{v as yoo_chat_message};