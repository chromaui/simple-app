import{c as n}from"./p-8cff990b.js";var e=n(function(n){var e={version:"2.1.1",options:{debug:!1,localCacheFolder:"imgcache",useDataURI:!1,chromeQuota:10485760,usePersistentCache:!0,cacheClearSize:0,headers:{},withCredentials:!1,skipURIencoding:!1,cordovaFilesystemRoot:null,timeout:0},overridables:{hash:function(n){function e(n,e,t){for(;0<t--;)n.push(e)}function t(n,e){return n<<e|n>>>32-e}function o(n,e,t){return n^e^t}function i(n,e){var t=(65535&e)+(65535&n);return(65535&(e>>>16)+(n>>>16)+(t>>>16))<<16|65535&t}var r="0123456789abcdef";return function(n){for(var e,t=[],o=4*n.length,i=0;i<o;i++)t.push(r.charAt((e=n[i>>2]>>8*(3-i%4))>>4&15)+r.charAt(15&e));return t.join("")}(function(n,r){var c,a,u,f,d,l=n.length,s=1732584193,v=4023233417,w=2562383102,m=271733878,h=3285377520,g=[];e(g,1518500249,20),e(g,1859775393,20),e(g,2400959708,20),e(g,3395469782,20),n[r>>5]|=128<<24-r%32,n[15+(r+65>>9<<4)]=r;for(var p=0;p<l;p+=16){c=s,a=v,u=w,f=m,d=h;for(var b=0,y=[];b<80;b++){y[b]=b<16?n[b+p]:t(y[b-3]^y[b-8]^y[b-14]^y[b-16],1);var F=function(n,e,t,o,i){var r=(65535&i)+(65535&n)+(65535&e)+(65535&t)+(65535&o);return(65535&(i>>>16)+(n>>>16)+(e>>>16)+(t>>>16)+(o>>>16)+(r>>>16))<<16|65535&r}(b<20?a&u^~a&f:b<40?o(a,u,f):b<60?a&u^a&f^u&f:o(a,u,f),d,g[b],y[b],t(c,5));d=f,f=u,u=t(a,30),a=c,c=F}s=i(s,c),v=i(v,a),w=i(w,u),m=i(m,f),h=i(h,d)}return[s,v,w,m,h]}(function(n){for(var e=[],t=8*n.length,o=0;o<t;o+=8)e[o>>5]|=(255&n.charCodeAt(o/8))<<24-o%32;return e}(n).slice(),8*n.length))},log:function(n,r){e.options.debug&&(r===t&&(n="INFO: "+n),r===o&&(n="WARN: "+n),r===i&&(n="ERROR: "+n),console.log(n))}},ready:!1,attributes:{}},t=1,o=2,i=3;!function(r){var c={sanitizeURI:function(n){return e.options.skipURIencoding?n:(n.length>=2&&'"'===n[0]&&'"'===n[n.length-1]&&(n=n.substr(1,n.length-2)),encodeURI(n))},URI:function(n){n||(n="");var e=n.match(/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/);this.scheme=e[1]||null,this.authority=e[2]||null,this.path=e[3]||null,this.query=e[4]||null,this.fragment=e[5]||null},URIGetFileName:function(n){if(n){var e=n.lastIndexOf("/");if(e)return n.substr(e+1).toLowerCase()}},URIGetPath:function(n){if(n)return c.URI(n).path.toLowerCase()},fileGetExtension:function(n){if(!n)return"";var e=(n=n.split("?")[0]).split(".").pop();return!e||e.length>4?"":e},appendPaths:function(n,e){return e||(e=""),n&&""!==n?n+("/"==n[n.length-1]||e.length>0&&"/"==e[0]?"":"/")+e:(e.length>0&&"/"==e[0]?"":"/")+e},hasJqueryOrJqueryLite:function(){return e.jQuery||e.jQueryLite},isCordova:function(){return("undefined"!=typeof cordova||"undefined"!=typeof phonegap)&&"browser"!==(cordova||phonegap).platformId},isCordovaAndroid:function(){return c.isCordova()&&device&&device.platform&&device.platform.toLowerCase().indexOf("android")>=0},isCordovaWindowsPhone:function(){return c.isCordova()&&device&&device.platform&&(device.platform.toLowerCase().indexOf("win32nt")>=0||device.platform.toLowerCase().indexOf("windows")>=0)},isCordovaIOS:function(){return c.isCordova()&&device&&device.platform&&"ios"===device.platform.toLowerCase()},isCordovaAndroidOlderThan3_3:function(){return c.isCordovaAndroid()&&device.version&&(0===device.version.indexOf("2.")||0===device.version.indexOf("3.0")||0===device.version.indexOf("3.1")||0===device.version.indexOf("3.2"))},isCordovaAndroidOlderThan4:function(){return c.isCordovaAndroid()&&device.version&&(0===device.version.indexOf("2.")||0===device.version.indexOf("3."))},EntryToURL:function(n){return c.isCordovaAndroidOlderThan4()&&"function"==typeof n.toNativeURL?n.toNativeURL():"function"==typeof n.toInternalURL?n.toInternalURL():n.toURL()},EntryGetURL:function(n){return"function"==typeof n.toURL?c.EntryToURL(n):n.toURI()},EntryGetPath:function(n){return c.isCordova()?c.isCordovaIOS()?c.isCordovaAndroidOlderThan3_3()?n.fullPath:n.nativeURL:"function"==typeof n.toURL?c.EntryToURL(n):n.fullPath:n.fullPath},getCordovaStorageType:function(n){if("undefined"!=typeof LocalFileSystem){if(n&&LocalFileSystem.hasOwnProperty("PERSISTENT"))return LocalFileSystem.PERSISTENT;if(!n&&LocalFileSystem.hasOwnProperty("TEMPORARY"))return LocalFileSystem.TEMPORARY}return n?window.PERSISTENT:window.TEMPORARY}},a={trigger:function(n,t){e.jQuery?r(n).trigger(t):(!c.isCordovaWindowsPhone()&&window.CustomEvent||(window.CustomEvent=function(n,e){var t;e=e||{bubbles:!1,cancelable:!1,detail:void 0};try{(t=document.createEvent("CustomEvent")).initCustomEvent(n,e.bubbles,e.cancelable,e.detail)}catch(o){(t=document.createEvent("Event")).initEvent(n,e.bubbles,e.cancelable),t.detail=e.detail}return t}),n.dispatchEvent(new CustomEvent(t)))},removeAttribute:function(n,e){c.hasJqueryOrJqueryLite()?n.removeAttr(e):n.removeAttribute(e)},setAttribute:function(n,e,t){c.hasJqueryOrJqueryLite()?n.attr(e,t):n.setAttribute(e,t)},getAttribute:function(n,e){return c.hasJqueryOrJqueryLite()?n.attr(e):n.getAttribute(e)},getBackgroundImage:function(n){if(c.hasJqueryOrJqueryLite())return n.attr("data-old-background")?"url("+n.attr("data-old-background")+")":n.css("background-image");var e=window.getComputedStyle(n,null);return e?n.getAttribute("data-old-background")?"url("+n.getAttribute("data-old-background")+")":e.backgroundImage:void 0},setBackgroundImage:function(n,e){c.hasJqueryOrJqueryLite()?n.css("background-image",e):n.style.backgroundImage=e}},u={attributes:{},isImgCacheLoaded:function(){return!(!e.attributes.filesystem||!e.attributes.dirEntry)||(e.overridables.log("ImgCache not loaded yet! - Have you called ImgCache.init() first?",o),!1)}};u.attributes.hasLocalStorage=!1,u.hasLocalStorage=function(){if(u.attributes.hasLocalStorage)return u.attributes.hasLocalStorage;try{var n=e.overridables.hash("imgcache_test");return localStorage.setItem(n,n),localStorage.removeItem(n),u.attributes.hasLocalStorage=!0,!0}catch(n){return e.overridables.log("Could not write to local storage: "+n.message,t),!1}},u.setCurrentSize=function(n){e.overridables.log("current size: "+n,t),u.hasLocalStorage()&&localStorage.setItem("imgcache:"+e.options.localCacheFolder,n)},u.getCachedFilePath=function(n){return c.appendPaths(e.options.localCacheFolder,u.getCachedFileName(n))},u.getCachedFileFullPath=function(n){var t=c.EntryGetPath(e.attributes.dirEntry);return c.appendPaths(t,u.getCachedFileName(n))},u.getCachedFileName=function(n){if(n){var t=e.overridables.hash(n),i=c.fileGetExtension(c.URIGetFileName(n));return t+(i?"."+i:"")}e.overridables.log("No source given to getCachedFileName",o)},u.setNewImgPath=function(n,e,t){a.setAttribute(n,"src",e),a.setAttribute(n,f,t)},u.createCacheDir=function(n,r){if(!e.attributes.filesystem)return e.overridables.log("Filesystem instance was not initialised",i),void(r&&r());var u=function(n){e.overridables.log("Failed to get/create local cache directory: "+n.code,i),r&&r()};e.attributes.filesystem.root.getDirectory(e.options.localCacheFolder,{create:!0,exclusive:!1},function(i){e.attributes.dirEntry=i,e.overridables.log("Local cache folder opened: "+c.EntryGetPath(i),t),c.isCordovaAndroid()?i.getFile(".nomedia",{create:!0,exclusive:!1},function(){e.overridables.log(".nomedia file created.",t),n&&n()},u):c.isCordovaWindowsPhone()?n&&n():(c.isCordovaIOS()&&i.setMetadata&&i.setMetadata(function(){e.overridables.log("com.apple.MobileBackup metadata set",t)},function(){e.overridables.log("com.apple.MobileBackup metadata could not be set",o)},{"com.apple.MobileBackup":1}),n&&n()),e.ready=!0,a.trigger(document,l)},u)},u.FileTransferWrapper=function(n){c.isCordova()&&(this.fileTransfer=new FileTransfer),this.filesystem=n},u.FileTransferWrapper.prototype.download=function(n,t,o,i,r){var c=e.options.headers||{},a="function"==typeof r;if(this.fileTransfer)return a&&(this.fileTransfer.onprogress=r),this.fileTransfer.download(n,t,o,i,!1,{headers:c});var u=this.filesystem,f=function(o,i,r){e.overridables.log(o,i),r&&r({code:0,source:n,target:t})},d=new XMLHttpRequest;for(var l in d.open("GET",n,!0),a&&(d.onprogress=r),e.options.withCredentials&&(d.withCredentials=!0),d.timeout=e.options.timeout,d.responseType="blob",c)d.setRequestHeader(l,c[l]);d.onload=function(){!d.response||200!==d.status&&0!==d.status?f("Image "+n+" could not be downloaded - status: "+d.status,3,i):u.root.getFile(t,{create:!0},function(n){n.createWriter(function(e){e.onerror=i,e.onwriteend=function(){o(n)},e.write(d.response,i)},i)},i)},d.onerror=function(){f("XHR error - Image "+n+" could not be downloaded - status: "+d.status,3,i)},d.ontimeout=function(){f("XHR error - Image "+n+" timed out - status: "+d.status,3,i)},d.send()},u.getBackgroundImageURL=function(n){var e=a.getBackgroundImage(n);if(e)return/url\s?\((.+)\)/.exec(e)[1].replace(/(['"])/g,"")},u.getBase64DataFromEntry=function(n,r,c,a){n.file(function(n){var i=new FileReader;i.onloadend=function(n){var i=n.target.result;i?(e.overridables.log("File "+r+" loaded from cache",t),c&&c(i)):(e.overridables.log("File in cache "+r+" is empty",o),a&&a(r))},i.readAsDataURL(n)},function(n){e.overridables.log("Failed to read file "+n.code,i),a&&a(r)})},u.loadCachedFile=function(n,o,r,a,f){if(u.isImgCacheLoaded())if(n){var d=c.URIGetFileName(o);e.attributes.filesystem.root.getFile(u.getCachedFilePath(o),{create:!1},function(i){if(e.options.useDataURI)u.getBase64DataFromEntry(i,d,function(e){r(n,e,o),a&&a(n)},function(){f&&f(n)});else{var l=c.EntryGetURL(i);r(n,l,o),e.overridables.log("File "+d+" loaded from cache",t),a&&a(n)}},function(){e.overridables.log("File "+d+" not in cache",t),f&&f(n)})}else e.overridables.log("First parameter of loadCachedFile is empty, should be a DOM element",i)},u.setBackgroundImagePath=function(n,e,t){a.setBackgroundImage(n,'url("'+e+'")'),a.setAttribute(n,d,t)};var f="data-old-src",d="data-old-background",l="ImgCacheReady";e.init=function(n,r){e.jQuery=!(!window.jQuery&&!window.Zepto),e.jQueryLite=!(void 0===window.angular||!window.angular.element),e.attributes.init_callback=n,e.overridables.log("ImgCache initialising",t);var a=function(n){e.overridables.log("LocalFileSystem opened",t),e.attributes.filesystem=n,u.createCacheDir(function(){var n;n=e.attributes.init_callback,e.options.cacheClearSize>0&&e.getCurrentSize()>1024*e.options.cacheClearSize*1024?e.clearCache(n,n):n&&n()},r)},f=function(n){e.overridables.log("Failed to initialise LocalFileSystem "+n.code,i),r&&r()};if(c.isCordova()&&window.requestFileSystem)if(e.options.cordovaFilesystemRoot)try{window.resolveLocalFileSystemURL(e.options.cordovaFilesystemRoot,function(n){a({root:n})},f)}catch(n){f({code:n.message})}else window.requestFileSystem(c.getCordovaStorageType(e.options.usePersistentCache),0,a,f);else{var d=window.requestFileSystem||window.webkitRequestFileSystem;if(window.storageInfo=window.storageInfo||(e.options.usePersistentCache?navigator.webkitPersistentStorage:navigator.webkitTemporaryStorage),!window.storageInfo)return e.overridables.log("Your browser does not support the html5 File API",o),void(r&&r());var l=e.options.chromeQuota;window.storageInfo.requestQuota(l,function(){var n=e.options.usePersistentCache?window.PERSISTENT:window.TEMPORARY;d(n,l,a,f)},function(n){e.overridables.log("Failed to request quota: "+n.message,i),r&&r()})}},e.getCurrentSize=function(){if(u.hasLocalStorage()){var n=localStorage.getItem("imgcache:"+e.options.localCacheFolder);return null===n?0:parseInt(n,10)}return 0},e.cacheFile=function(n,r,a,f){if(u.isImgCacheLoaded()&&n){n=c.sanitizeURI(n);var d=u.getCachedFileFullPath(n);new u.FileTransferWrapper(e.attributes.filesystem).download(n,d,function(n){n.getMetadata(function(n){n&&"size"in n?(e.overridables.log("Cached file size: "+n.size,t),u.setCurrentSize(e.getCurrentSize()+parseInt(n.size,10))):e.overridables.log("No metadata size property available",t)}),e.overridables.log("Download complete: "+c.EntryGetPath(n),t),n.setMetadata&&n.setMetadata(function(){e.overridables.log("com.apple.MobileBackup metadata set",t)},function(){e.overridables.log("com.apple.MobileBackup metadata could not be set",o)},{"com.apple.MobileBackup":1}),r&&r(n.toURL())},function(n){n.source&&e.overridables.log("Download error source: "+n.source,i),n.target&&e.overridables.log("Download error target: "+n.target,i),e.overridables.log("Download error code: "+n.code,i),a&&a()},f)}},e.getCachedFile=function(n,t){if(u.isImgCacheLoaded()&&t){var o=n;n=c.sanitizeURI(n);var i=u.getCachedFilePath(n);c.isCordovaAndroid()&&0===i.indexOf("file://")&&(i=i.substr(7)),e.attributes.filesystem.root.getFile(i,{create:!1},function(e){t(n,e)},function(){t(o,null)})}},e.getCachedFileURL=function(n,t,o){e.getCachedFile(n,function(n,e){e?t(n,c.EntryGetURL(e)):o&&o(n)})},e.getCachedFileBase64Data=function(n,t,o){e.getCachedFile(n,function(n,e){e?u.getBase64DataFromEntry(e,n,function(e){t(n,e)},o):o&&o(n)})},e.isCached=function(n,t){e.getCachedFile(n,function(n,e){t(n,null!==e)})},e.useOnlineFile=function(n){if(u.isImgCacheLoaded()&&n){var e=a.getAttribute(n,f);e&&a.setAttribute(n,"src",e),a.removeAttribute(n,f)}},e.useCachedFile=function(n,e,t){if(u.isImgCacheLoaded()){var o=c.sanitizeURI(a.getAttribute(n,"src"));u.loadCachedFile(n,o,u.setNewImgPath,e,t)}},e.useCachedFileWithSource=function(n,e,t,o){if(u.isImgCacheLoaded()){var i=c.sanitizeURI(e);u.loadCachedFile(n,i,u.setNewImgPath,t,o)}},e.clearCache=function(n,o){u.isImgCacheLoaded()&&e.attributes.dirEntry.removeRecursively(function(){e.overridables.log("Local cache cleared",t),u.setCurrentSize(0),u.createCacheDir(n,o)},function(n){e.overridables.log("Failed to remove directory or its contents: "+n.code,i),o&&o()})},e.removeFile=function(n,t,o){n=c.sanitizeURI(n);var r=u.getCachedFilePath(n),a=function(n){e.overridables.log("Failed to remove file due to "+n.code,i),o&&o()};e.attributes.filesystem.root.getFile(r,{create:!1},function(n){n.remove(function(){t&&t()},a)},a)},e.isBackgroundCached=function(n,t){var o=u.getBackgroundImageURL(n);e.getCachedFile(o,function(n,e){t(n,null!==e)})},e.cacheBackground=function(n,i,r,c){if(u.isImgCacheLoaded()){var a=u.getBackgroundImageURL(n);if(!a)return e.overridables.log("No background to cache",o),void(r&&r());e.overridables.log("Background image URL: "+a,t),e.cacheFile(a,i,r,c)}},e.useCachedBackground=function(n,t,i){if(u.isImgCacheLoaded()){var r=u.getBackgroundImageURL(n);if(!r)return e.overridables.log("No background to cache",o),void(i&&i());u.loadCachedFile(n,r,u.setBackgroundImagePath,t,i)}},e.useCachedBackgroundWithSource=function(n,e,t,o){u.isImgCacheLoaded()&&u.loadCachedFile(n,e,u.setBackgroundImagePath,t,o)},e.useBackgroundOnlineFile=function(n){if(n){var e=a.getAttribute(n,d);e&&a.setBackgroundImage(n,'url("'+e+'")'),a.removeAttribute(n,d)}},e.getCacheFolderURI=function(){if(u.isImgCacheLoaded())return c.EntryGetURL(e.attributes.dirEntry)},e.helpers=c,e.domHelpers=a,e.private=u,n.exports?n.exports=e:window.ImgCache=e}(window.jQuery||window.Zepto||function(){throw"jQuery is not available"})});export default e;export{e as __moduleExports};