import{r as t,c as i,h as s,H as e,g as a}from"./p-0d847530.js";import{dj as o,b9 as r,b8 as n,t as h,ak as c}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import"./p-0d62bf9d.js";import"./p-d70b188c.js";import"./p-815d6c40.js";const l=class{constructor(s){t(this,s),this.listItems=[],this.validityChanged=i(this,"validityChanged",7),this.inputChanged=i(this,"inputChanged",7)}windowClick(){this.closeRemovings()}componentDidLoad(){this.listItems=Array.from(this.outerContainerEl.querySelectorAll(".list-item")),this.prepareItems(),this.setOuterContainerHeight()}changeOutput(){this.value={active:{title:this.definition.active.title,values:this.sortables.filter(t=>"active"===t.value.group&&!t.value.isHeader).map(t=>t.value)},available:{title:this.definition.available.title,values:this.sortables.filter(t=>"available"===t.value.group&&!t.value.isHeader).map(t=>t.value)}},o(this.value,this)}validate(){return!0}prepareItems(){this.sortables=this.listItems.map((t,i)=>{let s=t.querySelector(".value").getAttribute("data-value");return this.sortable(JSON.parse(s),t,i)})}getValueList(){return[{isHeader:!0,group:"active",name:this.definition.active.title},...this.definition.active.values.map(t=>Object.assign({},t,{group:"active"})),{isHeader:!0,group:"available",name:this.definition.available.title},...this.definition.available.values.map(t=>Object.assign({},t,{group:"available"}))]}getListItemPosition(t){return this.listItems.slice(0,t).reduce((t,i)=>t+=i.clientHeight,0)}getListItemIndex(t){let i=0,s=0;for(;i<t&&s<this.listItems.length;)i+=this.listItems[s].clientHeight,s++;return s}sortable(t,i,s){const e=i.querySelector(".item-content"),a=this.listItems.length;let o,h=!1;const c={value:t,dragger:null,element:i,index:s,setIndex:null},l=r.to(e,.3,{boxShadow:"rgba(40, 47, 54, 0.07) 0px 8px 16px 0px",force3D:!0,scale:1.05,paused:!0}),u=t=>{this.closeRemovings(),o=this.listItems.findIndex(i=>i===t.target),l.play(),t.update()},v=()=>{r.to(i,.3,{y:this.getListItemPosition(c.index)})},m=()=>{h&&this.changeIndex(c,o),l.reverse(),v(),this.checkItemClasses(),c.dragger.disable(),this.changeOutput()},p=t=>{const i=this.clamp(this.getListItemIndex(t.y),0,a-1);if(i!==c.index){let t=this.changeIndex(c,i);h=!t}},d=new n(i,{onDragStart(){u(this)},onRelease(){m()},onDrag(){p(this)},cursor:"inherit",type:"y",autoScroll:1});return d.disable(),c.dragger=d,c.setIndex=t=>{c.index=t,d.isDragging||v()},this.setRowPosition(i,s),c}setRowPosition(t,i){r.set(t,{y:this.getListItemPosition(i)})}changeGroup(t,i){i||(i="active"===t.value.group?"available":"active"),t.value.group=i,"active"===i?t.dragger.enable():t.dragger.disable();const s=this.listItems[t.index];s&&(s.classList.remove("active"===i?"available":"active"),s.classList.add(i))}checkItemClasses(){let t;this.sortables.forEach((i,s)=>{i.value.isHeader?t=i.value.group:this.listItems[s].classList.contains(t)||this.changeGroup(i,t)})}moveToActive(t){if(t.locked)return;const i=this.sortables.filter(t=>"active"===t.value.group).length,s=this.sortables.find(i=>i.value.name===t.name);s&&(this.changeIndex(s,i),this.changeGroup(s,"active"),this.changeOutput())}moveToAvailable(t){if(t.locked)return;const i=this.sortables.findIndex(t=>"available"===t.value.group),s=this.sortables.find(i=>i.value.name===t.name);s&&(this.changeIndex(s,i),this.changeGroup(s,"available"),this.changeOutput())}isDroppableTo(t,i){if(t<1)return!1;const s=this.sortables.filter(t=>"active"===t.value.group).length-1;return!(i.value.locked&&t>s)}changeIndex(t,i){return!!this.isDroppableTo(i,t)&&(this.arrayMove(this.sortables,t.index,i),this.arrayMove(this.listItems,t.index,i),this.sortables.forEach((t,i)=>t.setIndex(i)),!0)}arrayMove(t,i,s){t.splice(s,0,t.splice(i,1)[0])}clamp(t,i,s){return t<i?i:t>s?s:t}renderItem(t){const i={"list-item":!0,header:t.isHeader,"always-active":t.locked};return i[t.group]=!0,s("div",{class:i},s("div",{class:"item-content"},!t.isHeader&&!t.locked&&s("yoo-icon",{class:"action-icon yo-circle-plus success",onClick:()=>this.moveToActive(t)}),!t.isHeader&&!t.locked&&s("yoo-icon",{class:"action-icon yo-circle-minor danger",onClick:()=>this.openRemoving(t)}),!t.isHeader&&t.locked&&s("yoo-icon",{class:"lock-icon stable yo-lock"}),!t.isHeader&&t.icon&&s("yoo-icon",{class:"item-icon "+t.icon}),s("span",{class:"value","data-value":JSON.stringify(t)},h(t.name)),!t.isHeader&&s("span",{class:"grip",onMouseOver:()=>this.unlockItem(t),onTouchStart:()=>this.unlockItem(t)},s("yoo-icon",{class:"yo-ranking-toggle"}))),!t.isHeader&&s("div",{class:"remove",onClick:()=>this.onRemove(t)},h("REMOVE")))}unlockItem(t){this.sortables.find(i=>i.value.name===t.name).dragger.enable()}onRemove(t){setTimeout(()=>this.moveToAvailable(t),300)}getListItemByValue(t){const i=this.sortables.findIndex(i=>i.value.name===t.name);return this.listItems[i]}openRemoving(t){const i=this.getListItemByValue(t);i&&setTimeout(()=>i.querySelector(".item-content").classList.add("removing"),10)}closeRemovings(){this.listItems.forEach(t=>t.querySelector(".item-content").classList.remove("removing"))}renderItems(t){return t.map(t=>this.renderItem(t))}setOuterContainerHeight(){if(this.outerContainerEl){let t=this.listItems.reduce((t,i)=>t+=i.clientHeight,0);this.outerContainerEl.style.height=t+"px"}}render(){return s(e,{class:c()},s("div",{class:"outer-container",ref:t=>this.outerContainerEl=t},this.renderItems(this.getValueList())))}get host(){return a(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host .outer-container{width:100%;direction:ltr}:host .list-item{position:absolute;top:0;left:0;width:100%;min-height:45px}:host .list-item .remove{display:-ms-flexbox;display:flex;position:absolute;top:0;right:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:80px;height:100%;background-color:var(--danger,#ff625f);color:var(--light,#fff);text-align:center;z-index:1}:host .list-item.header .item-content .action-icon,:host .list-item.header .item-content .badge,:host .list-item.header .item-content .grip{display:none}:host .list-item.header .item-content .value{padding-top:1em;padding-left:0;font-size:var(--font-size-03,1rem);font-weight:var(--font-weight-02,400)}:host .list-item.active .action-icon.success,:host .list-item.available .action-icon.danger,:host .list-item.available .grip{display:none}:host .item-content{position:relative;height:100%;padding:0 0 0 1rem;-webkit-transition:-webkit-transform .3s;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s;border-bottom:1px solid var(--stable-40,hsla(0,0%,67.8%,.4));background-color:var(--light,#fff);z-index:2}:host .item-content.removing{-webkit-transform:translateX(-80px)!important;transform:translateX(-80px)!important}:host .item-content.removing .value{-webkit-transform:translateX(2rem);transform:translateX(2rem);-webkit-transition:-webkit-transform .3s;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}:host .item-content .action-icon,:host .item-content .item-icon,:host .item-content span{font-size:var(--font-size-04,1.125rem)}:host .item-content span{display:inline-block;max-width:calc(100vw - 120px);margin:.6rem 0}:host .item-content .badge{display:none}:host .item-content span.grip{display:block;margin:0;padding:.6rem 1rem;float:right;color:var(--stable,#adadad)}:host .item-content .item-icon,:host .item-content .value{padding-left:.6rem}:host .item-content .lock-icon{padding-right:2px;padding-left:1px}:host .item-content .badge.active{display:block;width:1.25rem;height:1.25rem;margin-top:.75rem;margin-right:var(--padding-10,.625rem);float:left;border-radius:50%;background:var(--success,#04cc99);color:var(--light,#fff);font-size:var(--font-size-01,.75rem);line-height:1.25rem;text-align:center}:host(.boost) .item-content{display:-ms-flexbox;display:flex}:host(.boost) .item-content .grip{margin-left:auto}:host(.boost) .item-content .badge.active{min-width:1.25rem;background:var(--danger-light,#f46885)}"}};export{l as yoo_form_reorder};