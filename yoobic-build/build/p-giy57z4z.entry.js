import{r as t,c as e,h as s,H as i,g as a}from"./p-0d847530.js";import{u as r,C as n,p as l,ab as o,ak as h}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import{S as c}from"./p-0d62bf9d.js";import"./p-d70b188c.js";import"./p-815d6c40.js";const f=[{prefix:"left",pointsTransform:"translate(#tslX, 35)",rank:2},{prefix:"center",pointsTransform:"translate(#tslX, 33)",rank:1},{prefix:"right",pointsTransform:"translate(#tslX, 44) scale(-1, 1) translate(-16, -44) translate(11, 35)",rank:3}],p=class{constructor(s){t(this,s),this.selected=e(this,"selected",7)}onUsersRankedChanged(t){if(t){let t=this.getSVGElement();t&&(this.onBeforeInjectSVG(t),this.onAfterInjectSVG(t))}}componentDidUpdate(){let t=this.getSVGElement();t&&this.onAfterInjectSVG(t)}getSVGElement(){return this.host.getElementsByTagName("svg")[0]}displayElement(t,e){t&&t.setAttribute("style",e?"display: block":"display: none")}setUsername(t,e,s){let i=e.querySelector(`#${t}_image_text`);if(i&&s){this.displayElement(i,!0);let t=i.querySelector("tspan");t.style.fill="var(--black)",s.length>=14&&(s=`${s.substring(0,14)}...`),t&&(t.textContent=s||"")}else this.displayElement(i,!1)}centerUsername(t,e){if(e){let s,i=e.querySelector(`#${t}_image_text`),a=e.querySelector(`#${t}_avatar_image`),r=e.querySelector(`#${t}_avatar_no_image`);if(s=(t=>"none"===t.style.display)(a)?r.getBoundingClientRect().width:a.getBoundingClientRect().width,i&&(a||r)){let e=i.getBoundingClientRect().width;i.setAttribute("transform",`translate(${(s-e)/2}, ${"right"===t?89:0})`)}}}centerPoints(t,e,s,i){let a=e.querySelector(`#${t}_points_container`),n=e.querySelector(`#${t}_points`);if(a&&r(i)){this.displayElement(a,!0);let e=a.getBoundingClientRect().width||0;if(n&&r(i)){let a=n.getBoundingClientRect().width||0,r=e-a;n.setAttribute("transform",s.replace("#tslX",`${(t=>{let s=i.toString().length||1;switch(t){case"left":return s<3?r:8;case"center":return r/2;case"right":return s<3?i.toString().length>1?e/2:r/3:15}})(t)}`))}}else this.displayElement(a,!1)}setAvatar(t,e,s){let i=e.querySelector(`#${t}_image`),a=e.querySelector(`#${t}_avatar_image`),r=e.querySelector(`#${t}_avatar_no_image`);if(s){let t=s.user;if(t){let e=t.imageData;if(e)e=new n(e).crop("crop").aspectRatio(1,1).getUrl(),r&&this.displayElement(r,!1),a&&(this.displayElement(a,!0),i.setAttribute("xlink:href",e)),l()&&a.addEventListener("click",()=>{this.onAvatarClicked(s)});else{a&&this.displayElement(a,!1);let e=t=>(t||"  ").length>1&&(t||"  ").substring(0,1).toUpperCase(),i=o(t,"firstName",!1)&&o(t,"lastName",!1)?`${e(t.firstName)}${e(t.lastName)}`:e(t.username);r&&(this.displayElement(r,!0),r.querySelector("tspan").textContent=i,l()&&r.addEventListener("click",()=>{this.onAvatarClicked(s)}))}}}else this.displayElement(r,!1),this.displayElement(a,!1)}setPoint(t,e,s){if(e){let i=e.querySelector(`#${t}_points`);if(i&&r(s)){this.displayElement(i,!0);let t=s.toString()||"0",e=i.querySelector("tspan");e&&(e.textContent=t)}else this.displayElement(i,!1)}}getUserOnPosition(t){return this.usersRanked&&this.usersRanked.length?this.usersRanked.find(e=>e.rank===t):null}onAvatarClicked(t){t&&this.selected.emit(t)}onBeforeInjectSVG(t){if(t)return t.querySelector("#main-svg")&&(t.setAttribute("viewBox",`0 0 300 ${this.host.getBoundingClientRect().height}`),f.forEach(e=>{if(e){let s=e.prefix,i=this.getUserOnPosition(e.rank),a=i?i.user:null,r=i?i.points:null,n=a?o(a,"firstName",a.username):null;this.setUsername(s,t,n),this.setAvatar(s,t,i),this.setPoint(s,t,r)}})),t}onAfterInjectSVG(t){return t&&f.forEach(e=>{if(e){let s=e.prefix,i=this.getUserOnPosition(e.rank);if(i){let a=i.points;this.centerUsername(s,t),this.centerPoints(s,t,e.pointsTransform,a)}}}),t}render(){return s(i,{class:h()},s("div",{class:"podium-container"},this.svgPath&&s("img",{src:this.svgPath,onLoad:t=>c(t.target,{useCache:!0,makeIdsUnique:!1,beforeInject:(t,e)=>this.onBeforeInjectSVG(e),afterInject:(t,e)=>this.onAfterInjectSVG(e)})})))}get host(){return a(this)}static get watchers(){return{usersRanked:["onUsersRankedChanged"]}}static get style(){return".iframe-root.sc-yoo-podium{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root.sc-yoo-podium yoo-app.sc-yoo-podium .wrapper.sc-yoo-podium{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root.sc-yoo-podium yoo-app.sc-yoo-podium .wrapper.center-center.sc-yoo-podium{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root.sc-yoo-podium::-webkit-scrollbar{display:none}.sc-yoo-podium-h .podium-container.sc-yoo-podium{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.sc-yoo-podium-h .podium-container.sc-yoo-podium svg.sc-yoo-podium{height:95%}"}};export{p as yoo_podium};