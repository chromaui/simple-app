import{r as t,c as s,h as i,g as e}from"./p-0d847530.js";import{d5 as r,f_ as h,aq as o,b8 as d,dj as a,t as n,b9 as l}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import"./p-0d62bf9d.js";import"./p-d70b188c.js";import"./p-815d6c40.js";const p=class{constructor(i){t(this,i),this.value=null,this.validators=[],this.placeholder="SELECTRIGHTWORDS",this.validityChanged=s(this,"validityChanged",7),this.inputBlurred=s(this,"inputBlurred",7),this.inputFocused=s(this,"inputFocused",7),this.inputChanged=s(this,"inputChanged",7)}async isValid(){return this.validity}componentWillLoad(){r(this),this.sentence&&(this.values=this.values?h(this.values):[],this.answer=this.answer||[],this.words=this.getFormatedSentence().map(t=>({value:t,dynamic:t.includes("[[")})),this.valueAsSentence=this.value&&this.answer?this.getFormatedSentence().map(t=>({value:t.includes("[[")?this.value[this.getAnswerIndex(t)]:t,valid:this.value[this.getAnswerIndex(t)]===this.answer[this.getAnswerIndex(t)],dynamic:t.includes("[[")})):[]),this.isRendered=!1}componentDidLoad(){this.isRendered=!0,this.setDropZones(),this.initGSAPDraggable(),this.setMissingWordsWidth()}componentDidUpdate(){this.setDropZones(),this.initGSAPDraggable()}validate(){let t=!0,s=!0;return this.answer&&this.answer.length&&(s=this.value.length===this.answer.length),this.required&&!s&&(t=!1),this.validity&&this.validity===t||(this.validityChanged.emit(t),this.validity=t),this.validity}getFormatedSentence(){let t=this.sentence;return t.includes("[[0]]")||(t=this.answer.reduce((t,s,i)=>t.replace(s," [["+i+"]] "),this.sentence)),t.split(" ")}getAnswerIndex(t){return Number(["[[","]]"].reduce((t,s)=>t.replace(s,""),t))}setMissingWordsWidth(){let t=this.values?this.values.reduce((t,s)=>t.length>s.length?t:s):null;t&&(this.missingWordWidth=this.getMissingOrDroppedWordWidth(t))}getMissingOrDroppedWordWidth(t,s=!1){let i=8*t.length+20;if(this.sentenceEl)return i>=this.sentenceEl.offsetWidth?this.sentenceEl.offsetWidth-4:i+(s?20:0)}setDropZones(){this.sentenceDropZoneElements=Array.from(this.host.querySelectorAll(".word.droppable")),this.suggestionsDropZoneEl=this.host.querySelector(".suggestions"),this.yooIonSlideEl=o(this.host,"yoo-ion-slides")}initGSAPDraggable(){if(!(this.sentenceDropZoneElements&&this.sentenceDropZoneElements.length||this.suggestionsDropZoneEl))return;let t=this.host.querySelectorAll(`yoo-badge.item-${this.slideIndex}`),s=this.sentenceDropZoneElements,i=this.suggestionsDropZoneEl,e="";const r=t=>{t.target&&t.target.classList&&t.target.classList.add("drag-target"),this.yooIonSlideEl.classList.add("prevent-scroll-side-on-drag")},h=t=>{t.target&&t.target.classList&&(t.target.classList.remove("drag-target"),t.hitTest(i,"80%")?this.onClickOrDropWord(t.target.text):this.onDropWord(t,e),s.forEach(t=>{t.classList.remove("drop-target")}));try{l.to(t.target,0,{x:0,y:0})}catch(t){}this.yooIonSlideEl.classList.remove("prevent-scroll-side-on-drag")},o=t=>{t.target&&t.target.classList&&t.target.text&&(t.target.classList.contains("suggested")?this.onClickSuggestionsWord(t.target.text):t.target.classList.contains("dropped")&&this.onClickOrDropWord(t.target.text))};d.create(t,{edgeResistance:1,autoScroll:1,type:"x,y",throwProps:!0,onDragStart(){r(this)},onDrag(){(t=>{e="";for(let i=0;i<s.length;i++)t.hitTest(s[i],"80%")?(s[i].classList.add("drop-target"),e=s[i].title):s[i].classList.remove("drop-target");t.hitTest(i,"80%")?i.classList.add("drop-target"):i.classList.remove("drop-target")})(this)},onDragEnd(){h(this)},onClick(){o(this)}})}findDroppedWord(t){return this.words.find(s=>s.displayedValue===t)}isDropped(t){return void 0!==this.findDroppedWord(t)}updateAnswer(){let t=[];this.words.forEach(s=>{s.dynamic&&void 0!==s.displayedValue&&t.push(s.displayedValue)}),this.value=t,a(this.value,this)}onDropWord(t,s){if(t.target&&s){let i=s,e=t.target.text;this.onClickOrDropWord(e);let r=this.words.find(t=>t.value===i);r&&(r.displayedValue=e),this.updateAnswer(),t.target.classList.remove("drop-target")}}onClickOrDropWord(t){let s=this.findDroppedWord(t);s&&(s.displayedValue=void 0,this.updateAnswer())}onClickSuggestionsWord(t){if(!this.isDropped(t)){let s=this.words.find(t=>!0===t.dynamic&&!t.displayedValue);s&&(s.displayedValue=t,this.updateAnswer())}}renderReadonly(){return i("div",{class:"readonly"},i("div",{class:"sentence-answers"},this.valueAsSentence.map(t=>i("span",{class:"word "+(t.dynamic?t.valid?"success":"danger":"")}," ",t.value," "))))}renderEditable(){return i("div",{class:"outer-container"},i("div",{class:"sentence",ref:t=>this.sentenceEl=t},this.isRendered&&this.words?this.words.map(t=>[t.dynamic?t.displayedValue?i("yoo-badge",{style:{width:`${this.getMissingOrDroppedWordWidth(t.displayedValue,!0)}px`},class:`larget tag missing-word round danger-light dropped item-${this.slideIndex}`,text:t.displayedValue}):i("span",{style:{width:`${this.missingWordWidth}px`},class:"word droppable hidden",title:t.value},"*"):i("span",{title:t.value,class:"word"},t.value)]):null),i("div",{class:"placeholder"},n(this.placeholder)),i("div",{class:"suggestions"},this.values&&this.values.map(t=>{if(!this.isDropped(t))return i("yoo-badge",{class:`large tag missing-word round danger-light suggested item-${this.slideIndex}`,text:t})})))}render(){return this.readonly?this.renderReadonly():this.renderEditable()}get host(){return e(this)}static get style(){return".iframe-root.sc-yoo-form-missing-word{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root.sc-yoo-form-missing-word yoo-app.sc-yoo-form-missing-word .wrapper.sc-yoo-form-missing-word{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root.sc-yoo-form-missing-word yoo-app.sc-yoo-form-missing-word .wrapper.center-center.sc-yoo-form-missing-word{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root.sc-yoo-form-missing-word::-webkit-scrollbar{display:none}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word{font-size:var(--font-size-03,1rem);line-height:var(--font-size-09,2.25rem);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word yoo-badge.sc-yoo-form-missing-word{--font-size-inner-container:var(--font-size-03,1rem);--inner-container-default-padding:0.375rem 0.625rem;margin:.3125rem .125rem 1px .125rem;text-align:center}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word yoo-badge.drag-target.sc-yoo-form-missing-word{position:relative;z-index:1}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.sc-yoo-form-missing-word{display:inline-block;margin:0 2px;padding-top:var(--padding-5,.3125rem);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.hidden.sc-yoo-form-missing-word{border-bottom:1px solid var(--danger-light,#f46885);color:transparent}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.droppable.sc-yoo-form-missing-word{min-width:85px;text-align:center}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.dynamic.sc-yoo-form-missing-word{color:var(--danger,#ff625f)}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.dynamic.drop-target.sc-yoo-form-missing-word{background:var(--danger,#ff625f);color:var(--light,#fff)}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .sentence.sc-yoo-form-missing-word .word.drop-target.sc-yoo-form-missing-word{background:var(--stable-alt-to-dark,#d0d0d0);color:var(--light,#fff)}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .placeholder.sc-yoo-form-missing-word{margin:1.25rem auto;color:var(--stable,#adadad);font-size:var(--font-size-03,1rem);letter-spacing:normal}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .suggestions.sc-yoo-form-missing-word{padding:.3125rem;background:var(--light,#fff);font-size:var(--font-size-04,1.125rem)}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .suggestions.sc-yoo-form-missing-word yoo-badge.sc-yoo-form-missing-word{--font-size-inner-container:var(--font-size-03,1rem);--inner-container-default-padding:0.375rem 0.625rem;margin:0 .3125rem .3125rem .3125rem;cursor:pointer;-ms-touch-action:none;touch-action:none}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .suggestions.sc-yoo-form-missing-word yoo-badge.transparent.sc-yoo-form-missing-word{--color-inner-text:var(--stable-alt,#d0d0d0)}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .suggestions.sc-yoo-form-missing-word yoo-badge.drag-target.sc-yoo-form-missing-word{position:relative;z-index:1}.sc-yoo-form-missing-word-h .outer-container.sc-yoo-form-missing-word .suggestions.drop-target.sc-yoo-form-missing-word{padding:.25rem;border:1px dashed var(--stable-alt-to-dark,#d0d0d0)}.sc-yoo-form-missing-word-h .readonly.sc-yoo-form-missing-word{padding:.5rem;padding-left:0;padding-bottom:0}.sc-yoo-form-missing-word-h .readonly.sc-yoo-form-missing-word .sentence-answers.sc-yoo-form-missing-word .word.success.sc-yoo-form-missing-word{color:var(--success,#04cc99)}.sc-yoo-form-missing-word-h .readonly.sc-yoo-form-missing-word .sentence-answers.sc-yoo-form-missing-word .word.danger.sc-yoo-form-missing-word{color:var(--danger,#ff625f)}"}};export{p as yoo_form_missing_word};