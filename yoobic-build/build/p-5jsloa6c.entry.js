import{r as t,c as s,h as i,H as e,g as h}from"./p-0d847530.js";import{dj as r,b9 as a,b8 as n,ak as o}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import"./p-8cff990b.js";import"./p-0d62bf9d.js";import"./p-d70b188c.js";import"./p-815d6c40.js";const c=class{constructor(i){t(this,i),this.listItems=[],this.validityChanged=s(this,"validityChanged",7),this.inputChanged=s(this,"inputChanged",7)}componentDidLoad(){this.outerContainerEl&&(this.listItems=Array.from(this.outerContainerEl.querySelectorAll(".list-item"))),this.prepareItems(),this.setOuterContainerHeight()}prepareItems(){this.calcAndShowBadges(this.listItems,this.readonly?"active":"semiactive"),this.readonly?this.listItems.forEach((t,s)=>this.setRowPosition(t,s)):this.sortables=this.listItems.map((t,s)=>{let i=t.querySelector(".value").getAttribute("data-value");return this.sortable(i,t,s)})}getListItemPosition(t){return this.listItems.slice(0,t).reduce((t,s)=>t+=s.clientHeight,0)}getListItemIndex(t){let s=0,i=0;for(;s<t&&i<this.listItems.length;)s+=this.listItems[i].clientHeight,i++;return i}validate(){let t=!0,s=!0;return this.answers&&this.answers.length&&(s=this.value.length===this.answers.length),this.required&&!s&&(t=!1),this.validity&&this.validity===t||(this.validityChanged.emit(t),this.validity=t),this.validity}updateAnswer(){this.value=this.sortables.sort((t,s)=>t.index-s.index).map(t=>t.value),r(this.value,this)}calcAndShowBadges(t,s="active"){t.forEach((t,i)=>{this.setBadgeValue(t.querySelector(".badge"),i,s)})}setBadgeValue(t,s,i="active"){t.textContent=(s+1).toString(),t.className="badge",t.classList.add(i)}sortable(t,s,i){const e=s.querySelector(".item-content"),h=s.querySelector(".badge"),r=this.listItems.length,o={value:t,dragger:null,element:s,index:i,setIndex:null},c=a.to(e,.3,{boxShadow:"rgba(40, 47, 54, 0.07) 0px 16px 32px 0px",force3D:!0,scale:1.1,paused:!0}),l=()=>{a.to(s,.3,{y:this.getListItemPosition(o.index)})},d=()=>{c.reverse(),l(),this.updateAnswer(),o.dragger.disable()},p=()=>{this.changeIndex(o,0),this.updateAnswer()},u=t=>{const s=this.clamp(this.getListItemIndex(t.y),0,r-1);s!==o.index&&this.changeIndex(o,s)},g=new n(s,{onDragStart(){c.play(),this.update()},onRelease(){d()},onDrag(){u(this)},onClick(){p()},cursor:"inherit",type:"y"});return g.disable(),o.dragger=g,o.setIndex=t=>{o.index=t,this.setBadgeValue(h,t),g.isDragging||l()},this.setRowPosition(s,i),o}setRowPosition(t,s){a.set(t,{y:this.getListItemPosition(s)})}changeIndex(t,s){this.arrayMove(this.sortables,t.index,s),this.arrayMove(this.listItems,t.index,s),this.sortables.forEach((t,s)=>t.setIndex(s))}arrayMove(t,s,i){t.splice(i,0,t.splice(s,1)[0])}clamp(t,s,i){return t<s?s:t>i?i:t}renderToggleIcon(t){if(!this.readonly)return i("span",{class:"grip",onMouseOver:()=>this.unlockItem(t),onTouchStart:()=>this.unlockItem(t)},i("yoo-icon",{class:"yo-ranking-toggle"}))}unlockItem(t){this.sortables.find(s=>s.value===t).dragger.enable()}renderItem(t,s){return i("div",{class:"list-item"},i("div",{class:"item-content"},i("span",{class:"badge"},this.readonly&&s+1),i("span",{class:"value","data-value":t},t),this.renderToggleIcon(t)))}renderItems(t){return t&&t.length>0&&t.map((t,s)=>this.renderItem(t,s))}setOuterContainerHeight(){if(this.outerContainerEl){let t=this.listItems.reduce((t,s)=>t+=s.clientHeight,0);this.outerContainerEl.style.height=t+"px"}}render(){return i(e,{class:o()},i("div",{class:"outer-container",ref:t=>this.outerContainerEl=t},this.renderItems(this.readonly?this.value:this.values)))}get host(){return h(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host .outer-container{width:100%}:host .list-item{position:absolute;top:0;left:0;width:100%;min-height:45px}:host .list-item.header .item-content .badge,:host .list-item.header .item-content .icon{display:none}:host .list-item.header .item-content .value{padding-top:1em;font-weight:var(--font-weight-03,700)}:host .item-content{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;height:100%;padding:0 0 0 1rem;border-bottom:1px solid var(--stable-40,hsla(0,0%,67.8%,.4));background-color:var(--light,#fff)}:host .item-content span{display:inline-block;max-width:calc(100vw - 120px);margin:.6rem 0;font-size:var(--font-size-04,1.125rem)}:host .item-content .icon,:host .item-content span.grip{display:block;float:right;color:var(--stable,#adadad)}:host .item-content span.grip{margin:0;padding:.6rem 1rem}:host .item-content .value{-ms-flex:1;flex:1}:host .item-content .badge.active,:host .item-content .badge.semiactive{width:1.25rem;height:1.25rem;margin-top:.75rem;margin-right:var(--padding-10,.625rem);float:left;border-radius:50%;background:var(--success,#04cc99);color:var(--light,#fff);font-size:var(--font-size-01,.75rem);line-height:1.25rem;text-align:center;opacity:1}:host .item-content .badge.semiactive{opacity:.5}:host(.boost) .item-content{display:-ms-flexbox;display:flex}:host(.boost) .item-content .icon{margin-left:auto}:host(.boost) .item-content .badge.active,:host(.boost) .item-content .badge.semiactive{min-width:1.25rem;background:var(--danger-light,#f46885)}"}};export{c as yoo_form_ranking};