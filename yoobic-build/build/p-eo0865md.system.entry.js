System.register(["./p-d99b9c19.system.js","./p-76deb591.system.js","./p-40fcf55a.system.js","./p-fd4afab3.system.js","./p-e3fa184f.system.js","./p-90888482.system.js","./p-350cb6c0.system.js"],function(e){"use strict";var t,r,n,i,o,s,a,c,u,d,l,f;return{setters:[function(e){t=e.r;r=e.c;n=e.h;i=e.g},function(e){o=e.d5;s=e.W;a=e.dj;c=e.al;u=e.fX;d=e.t;l=e.Y;f=e.cE},function(){},function(){},function(){},function(){},function(){}],execute:function(){var p=e("yoo_form_pricecheck",function(){function e(e){t(this,e);this.validators=[];this.isHistory=false;this.validityChanged=r(this,"validityChanged",7);this.inputBlurred=r(this,"inputBlurred",7);this.inputFocused=r(this,"inputFocused",7);this.inputChanged=r(this,"inputChanged",7)}e.prototype.requiredWatch=function(){this.validate()};e.prototype.componentWillLoad=function(){o(this)};e.prototype.validate=function(){var e=true;if(this.required&&!this.value){e=false}if(!this.validity||this.validity!==e){this.validityChanged.emit(e);this.validity=e}return this.validity};e.prototype.addProduct=function(e,t){var r=this.value||{};if(!s(this.value)){this.value={}}r[e._id]=t;a(r,this)};e.prototype.clearProduct=function(e){var t=this.value||{};delete t[e._id];this.setValue(t)};e.prototype.setValue=function(e){e=e||{};a(e,this)};e.prototype.getDelta=function(e,t){var r=0;if(e>0&&t>0){r=Math.round((t-e)/e*100)}return r};e.prototype.onOpenScanner=function(){var e=this;var t=document.createElement("yoo-form-barcode-dialog");t.mainMode="default";t.priceCheckMode=true;t.heading="SCANABARCODE";var r;var n=function(n){if(t.mainMode==="default"){r=e.products.find(function(e){return e.reference===n.detail});if(r){t.restartScannerByMode("ocr");t.product=r;t.heading="SCANAPRICE"}else{t.restartScannerByMode("default");t.scannerHeading='<h2 class="danger">'+d("INVALIDPRODUCTSCANNED")+"</h2>"}}else{var i=document.createElement("yoo-form-dynamic-dialog");var o=n.detail-0;var s=e.getDelta(r.price,o);i.data={product:r,price:o,delta:s,deltaDisplay:'<div class="'+(s>0?"success":"danger")+'" >'+s+" %</div>"};i.header=r.title;i.slides=[{title:"GENERAL",items:[{name:"product",readonly:true,type:l.catalog,check:true},{name:"price",readonly:true,type:l.number,title:d("PRICE2")},{name:"deltaDisplay",readonly:true,visible:s!==0,title:"Delta",type:l.text}]}];i.showTabs=false;i.showRecap=false;i.hideSaveButton=true;i.footerButtons=[{text:function(){return d("NEXTPRODUCT")},cssClass:function(){return"light"},handler:function(r,n){e.addProduct(r.product,r.price);t.restartScannerByMode("default");t.product=null;t.heading="SCANABARCODE";if(n&&n.onCancel){n.onCancel(true)}}},{text:function(){return d("SAVE")},cssClass:function(){return"success"},handler:function(t,r){e.addProduct(t.product,t.price);if(r&&r.onCancel){r.onCancel()}}}];c(i).then(function(e){if(!e.data){setTimeout(function(){return f(true)},300)}})}};t.addEventListener("scannedSuccess",n);c(t).then(function(){if(t){t.removeEventListener("scannedSuccess",n);t=null}})};e.prototype.getProductRefs=function(){return u(this.value||{})};e.prototype.renderInnerProducts=function(e){var t=this;if(this.products&&this.products.length>0){var r=this.getProductRefs();return r.map(function(r){var i=t.value[r];var o=t.products.find(function(e){return e._id===r});if(o){var s=t.getDelta(o.price,i);return[n("div",{class:"entity"},n("yoo-entity",{class:"catalog-display simple",displayType:"card-list",entityType:"products",item:o}),e?null:n("div",{class:"remove",onClick:function(e){return t.clearProduct(o)}}," ",n("yoo-icon",{class:"yo-cross"})," ")),n("div",{class:{toolbar:true,history:t.isHistory}},n("div",{class:"price"},i.toLocaleString()," "),n("div",{class:"delta "+(s>0?"success":"danger")},s.toLocaleString()+" %"," "))]}})}};e.prototype.renderReadonly=function(){return n("div",{class:"readonly"},n("div",{class:"products"}," ",this.renderInnerProducts(true)))};e.prototype.renderEditable=function(){var e=this;return n("div",{class:"outer-container"},n("div",{class:"barcode-container",onClick:function(t){return e.onOpenScanner()}},n("yoo-icon",{class:"center yo-barcode success"})),n("div",{class:"products"},this.renderInnerProducts(false)))};e.prototype.render=function(){return this.readonly?this.renderReadonly():this.renderEditable()};Object.defineProperty(e.prototype,"host",{get:function(){return i(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{required:["requiredWatch"]}},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host .outer-container .barcode-container,:host .readonly .barcode-container{display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:98px;height:98px;border:1px solid var(--input-container-border-color,hsla(0,0%,67.8%,.4));border-radius:.5rem;cursor:pointer}:host .outer-container .barcode-container .required,:host .readonly .barcode-container .required{top:auto;right:auto;bottom:auto;left:.625rem;position:absolute;color:var(--success,#04cc99);font-size:var(--font-size-03,1rem)}:host .outer-container .barcode-container yoo-icon,:host .readonly .barcode-container yoo-icon{font-size:var(--font-size-09,2.25rem)}:host .outer-container .products>.title,:host .readonly .products>.title{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;margin-top:.5rem;color:var(--black,#000);font-size:var(--font-size-03,1rem);font-weight:var(--font-weight-01,300);line-height:1.5;text-align:left;text-transform:uppercase}:host .outer-container .products .subtitle,:host .readonly .products .subtitle{margin-top:.125rem;color:var(--text-color,#807f83);font-size:var(--font-size-01,.75rem)}:host .outer-container .products .remove,:host .readonly .products .remove{display:-ms-flexbox;display:flex;-ms-flex-line-pack:center;align-content:center;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;min-width:40px;text-align:center}:host .outer-container .products .entity,:host .readonly .products .entity{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}:host .outer-container .products .toolbar,:host .readonly .products .toolbar{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;margin-top:-2.1rem;padding:.5rem;border-bottom:1px solid var(--stable-light,#f1f1f1);font-size:var(--font-size-02,.875rem);z-index:2}:host .outer-container .products .toolbar.history,:host .readonly .products .toolbar.history{font-size:var(--font-size-02,.875rem)}:host .outer-container .products .toolbar .price,:host .readonly .products .toolbar .price{-ms-flex:1;flex:1;padding-left:.5rem;padding-left:4.2rem;color:var(--black,#000);white-space:nowrap}:host .outer-container .products .toolbar .delta,:host .readonly .products .toolbar .delta{margin-left:1rem}:host .outer-container .products .toolbar .delta.success,:host .readonly .products .toolbar .delta.success{color:var(--success,#04cc99)}:host .outer-container .products .toolbar .delta.danger,:host .readonly .products .toolbar .delta.danger{color:var(--danger,#ff625f)}:host .outer-container .products .toolbar .icon,:host .readonly .products .toolbar .icon{width:22px;min-width:22px;height:22px;min-height:22px;border-radius:50%;background:var(--stable-light,#f1f1f1);text-align:center}:host .outer-container .products .footer,:host .readonly .products .footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:.5rem;padding-top:1rem;padding-bottom:.5rem;color:var(--black,#000)}:host .outer-container .products .footer .title,:host .readonly .products .footer .title{-ms-flex:1;flex:1;text-transform:uppercase}:host .outer-container .products .footer .price,:host .readonly .products .footer .price{text-align:right}:host .readonly{padding:.5rem;padding-left:0;padding-bottom:0}:host(.history){margin:0!important;border:0!important}:host(.history),:host(.history) .readonly{padding:0!important}"},enumerable:true,configurable:true});return e}())}}});