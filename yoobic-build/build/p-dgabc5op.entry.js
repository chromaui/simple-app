import{r as t,c as i,h as s,H as e,g as n}from"./p-0d847530.js";import{i as o,d as h,z as r,n as a,bp as l,bo as c,b as u,cE as d,al as v,t as f,ak as p,V as y,dj as m,s as g,fX as w,a0 as b,u as E,d5 as C,o as O,cU as k,ao as A,g4 as T,g5 as I,bq as M,bn as _,cF as S,bt as R,bu as D,Q as P,Z as L,m as x,r as j,cO as N,N as G,q as F,cZ as H,S as U,y as W,fY as V,H as B,cR as Y,p as K,cN as q,T as z}from"./p-384bfcf6.js";import"./p-0f3d65ca.js";import{c as X,a as $,u as J}from"./p-8cff990b.js";import"./p-0d62bf9d.js";import{y as Z,G as Q,ao as tt,v as it,a6 as st,a7 as et,a8 as nt,di as ot,ap as ht,ar as rt,at,dl as lt,u as ct,r as ut,k as dt,av as vt,dd as ft,dk as pt,dj as yt,an as mt,a1 as gt,a2 as wt,a3 as bt}from"./p-d70b188c.js";import"./p-815d6c40.js";import{C as Et}from"./p-e308dba0.js";const Ct=class{constructor(s){t(this,s),this.regularMode=!1,this.showLoader=!1,this.listviewItems=[],this.flashMode="auto",this.isProcessing=!1,this.showCapturedImage=!1,this.dataPrefix="data:image/jpeg;base64,",this.FLASH_MODE=["on","off","auto"],this.isCancel=!1,this.isTapped=!1,this.cameraStop=i(this,"cameraStop",7)}componentWillLoad(){this.values&&!this.regularMode&&(this.listviewItems=this.values.slice())}componentDidLoad(){window.document.body.classList.add("camera-preview"),this.captures=[],this.photos=[],o()&&(this.cameraStarted&&!h()||this.regularMode&&r().cameraStarted?Et.show().then(()=>{},()=>{this.onStartCamera().then(()=>{},()=>{Et.show()})}):(a()&&Et.setFocusMode("continuous-picture"),this.onStartCamera().then(()=>{},()=>{Et.show().then(()=>{},()=>{this.onStartCamera()})})))}componentDidUnload(){this.regularMode&&(this.isTapped=!1)}onStartCamera(){return Et.startCamera({x:0,y:0,width:window.innerWidth,height:window.innerHeight,toBack:!0,tapPhoto:!1,tapToFocus:!0,previewDrag:!1,camera:Et.CAMERA_DIRECTION.BACK,disableExifHeaderStripping:!0,storeToFile:!0})}onModalTimeout(){this.helperModalDiv&&this.helperModalDiv.classList&&this.helperModalDiv.classList.add("active"),setTimeout(()=>{this.onDismissHelperModal()},this.photos&&this.photos.length>0?2e3:5e3)}getCameraPreview(){return h()?new Promise(t=>{window.CameraPreview.getCameraPreview(i=>{let s=this.dataPrefix+i.image,e=-90;h()&&(e=0),Z(s,e,!0).then(i=>t(i))})}):Et.takePicture({quality:this.quality,height:2*window.innerHeight,width:2*window.innerWidth}).then(t=>this.transformCameraPicture(t))}transformCameraPicture(t){let i,s,e=this.dataPrefix;return s=t&&y(t)&&t[0]?t[0]:t,h()?(e="",s&&s.image&&(s=s.image),s&&s.indexOf("file://")<0&&(s="file://"+s),l()||c()?Q(s,!0):Q(s,!0,"_rotate_image")):Promise.resolve(i=e+s)}onCapture(){if(o()&&!this.isTapped)return this.regularMode?Et.takePicture({quality:this.quality,width:tt(this.isImageRecognition,this.maxWidth),height:tt(this.isImageRecognition,this.maxWidth)}).then(t=>(this.isTapped=!0,this.transformCameraPicture(t))).then(t=>it(t)).then(t=>{this.capturedPath=t,this.stopCamera()}):this.getCameraPreview().then(t=>{this.captures.push(t),this.onDismissHelperModal(),this.listviewItems.push(t),this.listviewItems=[...this.listviewItems]}).then(()=>Et.takePicture({quality:this.quality,width:4*window.innerWidth,height:4*window.innerHeight})).then(t=>this.transformCameraPicture(t)).then(t=>{this.photos.push(t),this.max>0&&this.listviewItems.length===this.max?this.onSave():(this.listviewItems.length<this.max-1&&this.onModalTimeout(),this.host.forceUpdate()),this.isTapped=!1})}stopCamera(){h()?Et.stopCamera().then(()=>{window.document.body.classList.remove("camera-preview"),this.closeModalByType()}):u()&&(window.document.body.classList.remove("camera-preview"),Et.hide(),this.closeModalByType())}closeModalByType(){d(this.isCancel?null:this.regularMode?this.capturedPath:this.photos)}onCancel(){this.isCancel=!0,this.stopCamera()}onSave(){this.isCancel=!1,this.stopCamera()}onDismissHelperModal(){this.helperModalDiv&&this.helperModalDiv.classList&&this.helperModalDiv.classList.contains("active")&&this.helperModalDiv.classList.remove("active")}onToggleListView(){this.listviewDiv.classList.contains("active")?this.listviewDiv.classList.remove("active"):this.listviewDiv.classList.add("active")}onImageClick(t){let i=document.createElement("yoo-photo-editors");i.index=t,i.isReadonly=!0,i.items=this.listviewItems.map(t=>({value:t})),v(i,null,"camera-preview-visible").then(()=>{i&&(i=null)})}onCaptureInnerTouchStart(){this.innerButtonDiv.classList.add("tapped")}onCaptureInnerTouchEnd(){this.innerButtonDiv.classList.remove("tapped")}onToggleFrontCamera(){Et&&Et.switchCamera&&Et.switchCamera()}onToggleFlashLight(){Et&&Et.setFlashMode&&Et.getFlashMode&&Et.getFlashMode().then(t=>{let i=this.FLASH_MODE.indexOf(t)+1;i===this.FLASH_MODE.length&&(i=0),this.flashMode=this.FLASH_MODE[i],Et.setFlashMode(this.flashMode)})}onDeleteCaptured(t){t.stopPropagation(),t.preventDefault(),this.listviewItems.pop(),this.captures.pop(),this.photos.pop(),0===this.captures.length&&this.onToggleListView(),this.listviewItems=[...this.listviewItems]}onHeaderTouchStart(t){const i=this.getTouches(t)[0];this.yDown=i.clientY,this.headerTouchStartY=t.touches[0].clientY,this.headerTouchStartTime=t.timeStamp}onHeaderTouchMove(t){if(!this.yDown&&t.timeStamp-this.headerTouchStartTime<100)return;let i=this.headerTouchStartY-t.touches[0].clientY;Math.abs(i)>70?i>0&&this.listviewDiv.classList.remove("active"):i<0&&this.listviewDiv.classList.add("active")}onResizePreview(){this.previewImageDiv&&(this.previewImageDiv.classList.contains("active")?this.previewImageDiv.classList.remove("active"):this.previewImageDiv.classList.add("active"))}getTouches(t){return t.touches||t.originalEvent.touches}renderHeader(){return s("div",{class:"header-container",ref:t=>this.listviewDiv=t},s("div",{class:"item-container"},s("yoo-ion-button",{class:"close button-clear",onClick:()=>this.onCancel()},s("yoo-icon",{slot:"icon-only",class:"yo-close"})),s("yoo-ion-button",{class:"close button-clear",onClick:()=>this.onToggleFrontCamera()},s("yoo-icon",{slot:"icon-only",class:"yo-rotate-camera"})),s("yoo-ion-button",{class:"close button-clear",onClick:()=>this.onToggleFlashLight()},s("yoo-icon",{slot:"icon-only",class:{"yo-flash-on success":"on"===this.flashMode,"yo-flash-off success":"off"===this.flashMode,"yo-auto-flash success":"auto"===this.flashMode}})),!this.regularMode&&[s("yoo-ion-button",{class:"close button-clear",onClick:()=>this.onResizePreview()},s("yoo-icon",{slot:"icon-only",class:"yo-circle"})),s("yoo-ion-button",{class:"close button-clear",onClick:()=>this.onToggleListView()},s("yoo-icon",{slot:"icon-only",class:"yo-frame"})),s("div",{onClick:()=>{this.onSave()},class:"save-button"},f("SAVE"))]),s("div",{class:"hidden-items-container"},s("yoo-ion-scroll",{class:"relative",horizontalMode:!0},this.listviewItems.map((t,i)=>s("yoo-img",{type:"back",class:"item",src:t,onClick:()=>{this.onImageClick(i)}},i===this.listviewItems.length-1?s("yoo-icon",{onClick:t=>{this.onDeleteCaptured(t)},class:"yo-cross"}):null)))),s("div",{class:"header-bottom-handler",onTouchStart:t=>{this.onHeaderTouchStart(t)},onTouchMove:t=>{this.onHeaderTouchMove(t)},onClick:()=>{this.onToggleListView()}}))}renderBody(){let t=null;return t=this.captures&&this.captures.length>0?this.captures[this.captures.length-1]:this.imageData,[s("yoo-ion-content",{class:"content",scrollEnabled:!1},!this.regularMode&&s("div",{class:"camera-preview-container"},s("div",{class:"helper-modal",ref:t=>this.helperModalDiv=t,onClick:()=>this.onDismissHelperModal()},s("div",{class:"modal-text"},f("MOVERIGHTTOTAKEPICTURE")),s("div",{class:"modal-icon"},s("yoo-icon",{class:"yo-next-photo"}))),s("yoo-img",{type:"back",class:"overlay",src:"./assets/overlay/camera.png"}))),s("div",{class:"footer",onClick:()=>{this.onCapture()}},s("div",{class:"outer-circle"}," "),s("div",{onTouchStart:()=>{this.onCaptureInnerTouchStart()},onTouchEnd:()=>{this.onCaptureInnerTouchEnd()},ref:t=>this.innerButtonDiv=t,class:"inner-circle"})),t?s("yoo-img",{type:"back",class:"image-bg",onTouchMove:t=>this.previewOnTouchMove(t),ref:t=>this.previewImageDiv=t,src:t}):null]}previewOnTouchMove(t){if(this.previewImageDiv){let i=t.touches[0].clientY+"px";void 0!==this.previewImageDiv.style.webkitClipPath&&(this.previewImageDiv.style.webkitClipPath=`circle(calc((100vw - (0.75 * 100vw)) /2 ) at calc(100% - (calc((100vw - (0.75 * 100vw)) /2 ))) ${i})`),this.previewImageDiv.style.clipPath=`circle(calc((100vw - (0.75 * 100vw)) /2 ) at calc(100% - (calc((100vw - (0.75 * 100vw)) /2 ))) ${i})`}}render(){return s(e,{class:p()},this.renderHeader(),this.renderBody())}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{position:relative}:host yoo-header{position:absolute;top:0;background:transparent!important}:host yoo-header yoo-ion-toolbar{--ion-color-base:rgba(0,0,0,0.6)}:host yoo-header yoo-ion-toolbar yoo-ion-button.button-clear{--ion-color-base:var(--always-light,#fff)}:host .header-container{position:absolute;top:0;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background-color:var(--black-40,rgba(0,0,0,.4));font-size:var(--font-size-04,1.125rem);overflow:hidden;z-index:999}:host .header-container,:host .header-container.active .hidden-items-container{display:-ms-flexbox;display:flex;width:100%;-webkit-transition:all .3s ease;transition:all .3s ease;-webkit-box-sizing:border-box;box-sizing:border-box}:host .header-container.active .hidden-items-container{max-height:150px;padding-top:25px;padding-right:var(--padding-15,.9375rem);padding-bottom:var(--padding-15,.9375rem);padding-left:var(--padding-15,.9375rem);opacity:1;z-index:3}:host .header-container.active .header-bottom-handler{display:block}:host .header-container .item-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;padding-right:var(--padding-15,.9375rem);padding-bottom:var(--padding-10,.625rem);color:var(--always-light,#fff)}:host .header-container .item-container yoo-ion-button yoo-icon{color:var(--always-light,#fff);font-size:var(--font-size-05,1.25rem)}:host .header-container .item-container yoo-ion-button yoo-icon.yo-rotate-camera{font-size:var(--font-size-08,2rem)}:host .header-container .hidden-items-container{top:0;width:100%;max-height:0;-webkit-transition:all .3s ease;transition:all .3s ease;opacity:0;z-index:-1}:host .header-container .hidden-items-container .item{display:inline-block;position:relative;width:60px;height:90px;margin-top:13px;margin-right:30px;border:solid 1px var(--always-light,#fff);background-color:var(--always-light,#fff)}:host .header-container .hidden-items-container .item yoo-icon{position:absolute;top:-13px;right:-15px;color:var(--always-light,#fff);font-size:var(--font-size-05,1.25rem)}:host .header-container .header-bottom-handler{display:none;width:30px;height:5px;margin-top:var(--padding-15,.9375rem);margin-bottom:var(--padding-15,.9375rem);border-radius:100px;background-color:var(--always-light,#fff)}:host .camera-preview-container{display:-ms-flexbox;display:flex;position:relative;width:100%;height:100%;background:transparent}:host .camera-preview-container .helper-modal{display:-ms-flexbox;display:flex;position:absolute;top:50%;left:50%;-ms-flex-direction:column;flex-direction:column;-ms-flex-line-pack:center;align-content:center;-ms-flex-pack:center;justify-content:center;width:100%;width:220px;height:100%;height:150px;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);border-radius:12px;background-color:var(--black-40,rgba(0,0,0,.4));color:var(--always-light,#fff);font-size:var(--font-size-04,1.125rem);text-align:center;opacity:0;z-index:0;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}:host .camera-preview-container .helper-modal.active{opacity:1;z-index:3}:host .camera-preview-container .helper-modal .modal-text{padding:15px 15px 0 15px}:host .camera-preview-container .helper-modal .modal-icon{padding:15px 0 15px 0}:host .camera-preview-container .helper-modal .modal-icon yoo-icon{font-size:var(--font-size-10,2.625rem)}:host .camera-preview-container .overlay{position:absolute;top:50%;left:50%;width:100%;height:100%;margin-top:20px;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background-size:contain!important}:host .image{width:auto;max-width:none}:host .image,:host .image-bg{position:absolute;height:100%;opacity:.8}:host .image-bg{width:100%;-webkit-transform:translateX(-70%);transform:translateX(-70%);-webkit-clip-path:circle(calc((100vw - (.75 * 100vw)) /2) at calc(100% - (calc((100vw - (.75 * 100vw)) /2))) calc(50% - 20px));clip-path:circle(calc((100vw - (.75 * 100vw)) /2) at calc(100% - (calc((100vw - (.75 * 100vw)) /2))) calc(50% - 20px))}:host .image-bg.active{-webkit-clip-path:none;clip-path:none}:host .footer{display:-ms-flexbox;display:flex;position:absolute;right:0;bottom:0;left:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:120px;background:rgba(0,0,0,.6)}:host .footer .outer-circle{position:absolute;width:88px;height:88px;border-radius:50%;background-color:var(--always-light,#fff);opacity:.3;z-index:1}:host .footer .inner-circle{position:absolute;width:68px;height:68px;border-radius:50%;background-color:var(--light,#fff);z-index:2}:host .footer .inner-circle.tapped{background-color:var(--always-light,#fff);opacity:.6}:host .content{background:transparent}:host(.iphone-x) .header-container{padding-top:54px}:host(.iphone-x) .footer{height:140px;padding-top:20px;padding-bottom:34px}"}},Ot=class{constructor(s){t(this,s),this.extraData={},this.validators=[],this.isHistory=!1,this.min=1,this.max=1,this.isUploadingPhoto=!0,this.isSelectorMode=!1,this.selectedIndex=[],this.overflowOffset=4,this.cameraStarted=!1,this.progressBarRef=[],this.imageRecoCancelled=!1,this.progressTime=6e5,this.emitOnUpdated=!1,this.validityChanged=i(this,"validityChanged",7),this.inputBlurred=i(this,"inputBlurred",7),this.inputFocused=i(this,"inputFocused",7),this.inputChanged=i(this,"inputChanged",7),this.imageRecognition=i(this,"imageRecognition",7),this.getGeoloc=i(this,"getGeoloc",7),this.getMediaurl=i(this,"getMediaurl",7),this.galleryOpened=i(this,"galleryOpened",7),this.actionSheetOpened=i(this,"actionSheetOpened",7),this.extraDataChanged=i(this,"extraDataChanged",7),this.fetchData=i(this,"fetchData",7)}onProgressFinished(t){t&&"main"===t.detail&&(this.currentUploadingStatus=null,this.stopImageRecognitionProcess(),this.onDisplayImageRecoEndToast())}async updateAutocompleteValues(t){this.autocomplete&&t&&this.autocomplete.updateValues(t)}async updateData(t,i){m(t,this),this.updateExtraData(i)}async setFieldValue(t,i){if(void 0===t)m(i,this);else{let s=this.value?[...this.value]:[];s[t]=i,m(s,this)}}async stopImageRecognitionProcess(t=!1){this.imageRecoCancelled=t,this.isProcessing=!1,this.emitOnUpdated=!1}async onPhotoUploadComplete(){this.isUploadingPhoto=!1,this.currentUploadingStatus=f("RECOGNIZINGIMAGES"),this.progressBarRef&&this.progressBarRef.length>0&&this.progressBarRef.forEach(t=>{t&&(t.onUpdateProgress(100),t.setProgressAnimationDuration(100))})}async onPhotoUploadProgressUpdate(t,i){if(this.progressBarRef&&this.progressBarRef[i]){const s=this.progressBarRef[i];s&&(s.onUpdateProgress(t),s.setProgressAnimationDuration(100))}}async onImageRecognitionFailed(){g({message:f("IMAGERECONOTDONE"),duration:2e3,icon:"yo-rejected",cssClass:"danger header",closable:!0})}async processImageRecognitionResults(t){if(!this.imageRecoCancelled){this.progressBarMainRef&&this.progressBarMainRef.setProgressAnimationDuration(1e3),this.extraData=this.extraData||{},this.multiple?[].concat(t.markup_image).forEach((t,i)=>{this.extraData[i]=this.extraData[i]?this.extraData[i]:{},this.extraData[i].edit=t,this.extraData[i].stitch=t,this.extraData[i].stitchMode=this.isStitch()}):this.extraData=Object.assign(this.extraData,{edit:t.markup_image}),this.imageRecognitionResults=[],t&&(t=w(t).reduce((i,s)=>(s&&s.toLowerCase&&(i[s.toLowerCase()]=t[s]),i),{}));let i=[];if(this.imageRecognitionKpiKeys){let s=b(this.imageRecognitionKpiKeys.map(t=>t.name),w(t)),e=this.imageRecognitionKpiKeys.filter(t=>t.hideMobile).map(t=>t.name);s.forEach(s=>{let n=t[s];E(n)&&(n=Math.round(100*n)/100),i.push({key:s,value:n});let o="dark";!0===n&&(o="success",n=f("true")),!1===n&&(o="danger",n=f("false"));let h=t.hiddenFields&&t.hiddenFields.indexOf(s)>=0||e&&e.indexOf(s)>=0;this.imageRecognitionResults.push({title:f(s.toUpperCase()),color:o,value:n,rawValue:t[s],hidden:h,key:s})})}this.extraData.imageRecognitionResults=this.imageRecognitionResults,this.extraDataChanged.emit(i),this.extraDataChanged.emit(this.extraData),this.validators=this.validators.map(t=>{let i=t;return"required"!==i.name&&(i.options.extraData=this.extraData),i}),C(this,null,!0)}}async processGeoloc(t,i){this.extraData=this.extraData||{},this.multiple&&void 0!==i?(this.extraData._geoloc=this.extraData&&this.extraData._geoloc?this.extraData._geoloc:[],this.extraData._geoloc[i]=t):this.extraData._geoloc=t,this.extraDataChanged.emit(this.extraData)}componentWillLoad(){C(this),this.initExtraData(),this.initMultiObjects()}componentDidLoad(){this.fixSessionIdPath(),this.getFileInputs(),this.type=this.type||"photo"}componentWillUpdate(){C(this),this.initMultiObjects()}componentDidUpdate(){this.getFileInputs(),this.emitOnUpdated&&(this.imageRecognition.emit(this.value),this.emitOnUpdated=!1)}componentDidUnload(){this.cameraStarted&&o()&&u()&&Et.stopCamera()}initExtraData(){this.extraData&&(O(this.value)&&this.extraData.edit&&(this.value=this.extraData.edit),this.extraData.imageRecognitionResults&&(this.imageRecognitionResults=this.extraData.imageRecognitionResults)),this.initTags()}initMultiObjects(){this.multiple&&O(this.value)&&(this.value=[])}initTags(){if(this.multiple)for(let t=0;t<this.max;t++)this.extraData[t]=this.extraData[t]||{},this.extraData[t].tags=this.extraData[t].tags||[];else this.extraData=this.extraData||{},this.extraData.tags=this.extraData.tags||[]}getFileInputs(){this.fileInputs=this.multiple?k(this.host,".camera-input"):A(this.host,".camera-input")}removeAllCapture(){this.value=[],m(this.value,this)}getAddFileInput(){return A(this.host,".add-input")}updateExtraData(t){this.extraData=this.shouldTagImage()?T(this.extraData||{},t,(t,i)=>Object.assign({},t,i)):I(this.extraData||{},t),this.extraDataChanged.emit(this.extraData)}getFieldValue(t){return this.multiple?this.value[t]:this.value}isMedia(t){return st(t)||et(t)||nt(t)}capture(t,i){if(o()){let t=i;i<0&&(t=this.value&&this.value.length?this.value.length:0),"photo"===this.type?this.capturePhoto(!1,i):"audio"===this.type?this.captureAudio(t):"video"===this.type&&this.captureVideo(t)}else"photo"===this.type&&this.captureFromWebcam(t,i)}processMediaData(t,i,s=!1){let e;return t?(t&&t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),t&&t.startsWith&&t.startsWith("data:image")?e=Promise.resolve(t):(t.indexOf("file://")<0&&(t="file://"+t),e=h()&&t.indexOf("tmp")<0&&t.indexOf("cache")<0?Promise.resolve(t):Q(t,!!r().user&&r().user.disablePhotoOrientationAutoFix)),e.then(t=>{if(s)return Promise.resolve(t);this.shouldTagImage()?this.showPhotoTagDialog(t).then(s=>{O(s.data)||(this.updateTagData(s,i),this.setFieldValue(i,t),"photo"===this.type&&(this.clearPhotoEdit(i),this.saveGeoloc&&this.captureGeoloc(i)))}):(this.setFieldValue(i,t),"photo"===this.type&&(this.clearPhotoEdit(i),this.saveGeoloc&&this.captureGeoloc(i)))})):Promise.resolve(t)}showPhotoTagDialog(t,i){let s=document.createElement("yoo-form-capture-tag-dialog");return s.tags=this.tags,s.imageSrc=t,s.value=i,s.addEventListener("fetchData",t=>{this.onFetchGridData(t)}),v(s,null,"","slideYEnterAnimation","slideYLeaveAnimation")}updateTagData(t,i){this.initTags(),this.multiple?this.extraData[i]&&this.extraData[i].tags?this.extraData[i].tags=t.data:this.extraData[0].tags=t.data:this.extraData.tags=t.data,this.extraDataChanged.emit(this.extraData)}showCameraPreviewDialog({src:t,quality:i,isImageRecognition:s,maxWidth:e,max:n,extraClass:h,regularMode:r}){let a=document.createElement("yoo-camera-preview-dialog");return a.imageData=t,a.values=this.value,a.quality=i,a.isImageRecognition=s,a.maxWidth=e,a.max=n,a.cameraStarted=this.cameraStarted,a.regularMode=r,o()&&(u()&&!M()?ot.hide():ot.styleLightContent()),v(a,null,h,"slideYEnterAnimation","slideYLeaveAnimation").then(t=>(this.cameraStarted=!0,o()&&(u()&&!M()?ot.show():ot.styleDefault()),a=null,t&&t.data?t.data:null))}capturePhoto(t,i){let s,e=this.isImageRecognition?100:70,n=t?pt.PHOTOLIBRARY:pt.CAMERA,o="video"===this.type?yt.VIDEO:yt.PICTURE,h=i;if(-1===i&&(h=this.value&&this.value.length-1>-1?this.value.length-1:-1),this.algorithm&&this.algorithm.stitch&&!t?(this.showImageLoader=!0,s=this.showCameraPreviewDialog({src:this.value&&h>-1&&this.value[h]?this.value[h]:null,quality:e,isImageRecognition:this.isImageRecognition,maxWidth:this.maxWidth,max:this.max,extraClass:"camera-preview-visible"})):s=t&&this.multiple?ht(this.max-this.value.length,o="video"===this.type?mt.VIDEO:mt.IMAGE):rt(e,n,o,!1,this.maxWidth,this.isImageRecognition,this.max),s)return s.then(t=>{!t&&this.showImageLoader&&(this.showImageLoader=!1);let s=i;if(i<0&&(s=this.value&&this.value.length?this.value.length:0),y(t)){let i=[],e=[],n=1!==t.length;return e=t.map(n?(t,s)=>this.processMediaData(t,null,n).then(t=>{i[s]=t}):(t,i)=>this.processMediaData(t,i+s)),Promise.all(e).then(()=>{n&&(this.value=[...[].concat(this.value),...i],m(this.value,this)),this.showImageLoader=!1})}return this.processMediaData(t&&t.data?t.data:t,s)}).catch(()=>{})}captureVideo(t){return at({limit:1,duration:this.duration||60,saveToPhotoAlbum:!0}).then(i=>{this.processMediaData(this.fixPathAndGetValue(i),t)})}captureAudio(t){if(!_())return lt.captureAudio({limit:1,duration:this.duration||60}).then(i=>{this.processMediaData(this.fixPathAndGetValue(i),t)}).catch(t=>{3!==t.code&&this.noAudio()});this.noAudio()}noAudio(){S(f("AUDIO"),[f("OK")],null,f("NOAUDIO"))}fixSessionIdPath(){if(u()&&o()&&this.value&&void 0!==this.value)if(Array.isArray(this.value)){let t=[],i=this.value.map((i,s)=>ct(i).then(i=>{t[s]=i}));Promise.all(i).then(()=>{m(t,this)})}else ct(this.value).then(t=>{t&&this.value!==t&&m(t,this)})}fixPathAndGetValue(t){if(t&&t.length>0){let i=t[0].fullPath;return u()&&(i="file://"+i),i}return""}captureFromWebcam(t,i){let s,e=i;i<0&&(e=this.value&&this.value.length?this.value.length:0);let n=document.createElement("yoo-form-capture-webcam-dialog");n.device=t,(s=v(n)).then(t=>{t&&t.data&&(this.shouldTagImage()?this.showPhotoTagDialog(t.data).then(i=>{O(i.data)||(this.updateTagData(i,e),this.setFieldValue(e,t.data),this.clearPhotoEdit(),this.saveGeoloc&&this.captureGeoloc())}):(this.setFieldValue(e,t.data),this.clearPhotoEdit(),this.saveGeoloc&&this.captureGeoloc())),n=null})}captureFromDisk(t){let i=t&&t<0?this.getAddFileInput():this.getTargetElement(t);if(i){let t;R()||D()?(t=document.createEvent("MouseEvent")).initMouseEvent("click",!1,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null):t=new MouseEvent("click",{bubbles:!1}),i.dispatchEvent(t)}}isReplacingPhoto(t){return t>=0}importExternal(t,i){P({type:t,params:{multiple:this.multiple&&!this.isReplacingPhoto(i)}}).then(s=>{if(s&&s.data)if(this.multiple&&s.data.length>0){let i=this.max-this.value.length,e=Array.from(s.data).slice(0,i);this.value=[...[].concat(this.value),...e.map(i=>"gif"===t?i.embed_url:i.value)],m(this.value,this)}else{let e=i;-1===i&&(e=this.value&&this.value.length>0?this.value.length:0),"gif"===t&&s.data&&s.data.embed_url?this.setFieldValue(e,s.data.embed_url):s.data&&s.data.value&&this.setFieldValue(e,s.data.value)}})}captureGeoloc(t){let i=t;this.saveGeoloc&&(O(i)&&this.multiple&&this.value&&this.value.length-1>-1&&(i=this.value.length-1),this.getGeoloc.emit(i))}getIcon(){const t={video:"yo-videocamera",audio:"yo-microphone",default:"yo-camera"};let i=t[this.type];return i||(i=t.default),i}upload(t){o()?this.capturePhoto(!0,t):this.captureFromDisk(t)}onFetchGridData(t){t.stopPropagation(),this.fetchData.emit(t.detail)}getTargetElement(t){return void 0!==t?Array.from(this.fileInputs).find((i,s)=>s===t):this.fileInputs}onFileSelect(t,i){let s=this.getTargetElement(i),e=s.files[0];st(e)?ut(e,"blob").then(t=>{this.shouldTagImage()?this.showPhotoTagDialog(t).then(s=>{O(s.data)||(this.updateTagData(s,i),this.setFieldValue(i,t),this.clearPhotoEdit(i))}):(this.setFieldValue(i,t),this.clearPhotoEdit(i))}):(this.setFieldValue(i,e),this.clearPhotoEdit(i)),s.value=null}clearPhotoEdit(t){if(t||0===t){if(this.extraData&&this.extraData[t]&&(this.extraData[t].edit||this.extraData[t].texts&&this.extraData[t].texts.length>0)){let i={};delete this.extraData[t],Object.keys(this.extraData).forEach((t,s)=>{i[s]=this.extraData[t]}),this.extraDataChanged.emit(i)}}else this.extraData&&(this.extraData.edit||this.extraData.texts&&this.extraData.texts.length>0)&&(this.extraData={edit:null,texts:[],stitch:null},this.extraDataChanged.emit(this.extraData))}clearPhotoTag(t){if(this.onHasTag(t)){let i={};this.multiple?(delete this.extraData[t],Object.keys(this.extraData).forEach((t,s)=>{i[s]=this.extraData[t]}),this.extraDataChanged.emit(i)):(this.extraData.tags=[],i=this.extraData),this.extraDataChanged.emit(i)}}openPhotoEditorPreview(t,i=!1){let s=document.createElement("yoo-photo-editor");s.readonly=i||!this.allowAnnotate,s.isModal=!0,s.src=this.getFieldValue(t),void 0===t?this.extraData&&(this.isStitch()&&(s.isStitch=L(this.extraData.stitch)),s.annotatedImgSrc=this.extraData.edit,s.texts=this.extraData.texts,s.svgData=this.extraData.svgData):this.extraData&&this.extraData[t]&&(this.isStitch()?(s.src=this.extraData[t].stitch||s.src,s.isStitch=L(this.extraData[t].stitch),s.annotatedImgSrc=this.extraData[t].edit===this.extraData[t].stitch?null:this.extraData[t].edit):s.annotatedImgSrc=this.extraData[t].edit,s.texts=this.extraData[t].texts,s.svgData=this.extraData[t].svgData),v(s).then(i=>this.onAfterAnnotate(t,i))}openPreview(t,i=!1){if("photo"===this.type)!this.multiple||this.imageRecognitionResults&&0!==this.imageRecognitionResults.length&&this.isStitch()?this.openPhotoEditorPreview(t,i):this.renderMultiplePreview(t);else{let i,s=this.value;if(t>=0&&this.value&&this.value[t]&&(s=this.value[t]),x(s))i=s;else{let t=s.toString();i={_filename:t,_downloadURL:t,mimeType:dt(t)}}let e=document.createElement("yoo-form-document-dialog");e.document=i,e.modalTitle=f(this.type),e.modalMode=et(s),v(e).then(()=>{})}}openGallery(t){this.galleryOpened.emit(t)}onAnnotate(t){let i=document.createElement("yoo-photo-editor");i.readonly=!1,i.src=this.getFieldValue(t),void 0===t?this.extraData&&(i.annotatedImgSrc=this.extraData.edit,i.texts=this.extraData.texts,i.svgData=this.extraData.svgData):this.extraData&&this.extraData[t]&&(i.annotatedImgSrc=this.extraData[t].edit,i.texts=this.extraData[t].texts,i.svgData=this.extraData[t].svgData,i.src=this.extraData[t].stitch||i.src),v(i).then(i=>this.onAfterAnnotate(t,i))}onAfterAnnotate(t,i){if(i&&i.data){let s={edit:i.data.canvasData,texts:i.data.texts,svgData:i.data.svgData};if(void 0===t)this.extraData=Object.assign({},s);else{let i=j(this.extraData);i[t]=I(i[t]||{},s),this.extraData=i}this.extraDataChanged.emit(this.extraData)}}deleteCapture(t){this.multiple&&y(this.value)?(this.value.splice(t,1),this.value=this.value.slice()):this.value=null,"photo"===this.type&&(this.clearPhotoEdit(-1===t?void 0:t),this.clearImageRecognition()),m(this.value,this),this.clearPhotoTag(t)}clearImageRecognition(){if(this.imageRecognitionKpiKeys&&this.imageRecognitionKpiKeys.length>0){let t=[];this.imageRecognitionKpiKeys.forEach(i=>{t.push({key:i,value:null})}),this.extraDataChanged.emit(t)}this.extraData&&this.extraData.imageRecognitionResults&&(this.extraData.imageRecognitionResults=null),this.imageRecognitionResults=null,this.extraDataChanged.emit(this.extraData)}isRequired(t){return t?this.required&&t<this.min:this.required}async addCaptureButtons(t,i){o()?t.push({icon:"photo"===this.type?"yo-camera":"video"===this.type?"yo-videocamera":"yo-microphone",text:f("TAKEANEW"+this.type.toUpperCase()),handler:()=>this.capture(null,i)}):o()||"photo"!==this.type||(this.devices=await vt(),this.devices&&this.devices.length>0&&this.devices.forEach((s,e)=>{t.push({icon:"yo-webcam",text:f("TAKEANEW"+this.type.toUpperCase())+":<br/> "+(s.label||"WEBCAM "+e),handler:()=>this.capture(s,i)})}))}isValueValid(){return this.multiple?y(this.value)&&this.value.length>0:null!=this.value}onImageRecognition(t){N()?S("",[f("OK")],null,f("IMAGERECOOFFLINE")):(this.imageRecoCancelled=!1,this.isUploadingPhoto=!0,this.isValueValid()&&this.algorithm&&!this.isProcessing&&(this.currentUploadingStatus=f("UPLOADINGPHOTOS"),this.isProcessing=!0,this.emitOnUpdated=!0))}isStitch(){return this.algorithm&&this.algorithm.stitch}onShowImageRecoKpis(t){let i=document.createElement("yoo-form-capture-view-dialog");i.label=G("KPIS"),i.imageRecognitionResults=this.imageRecognitionResults,i.imageRecognitionDisplay=this.algorithmDisplay,i.isStitch=this.isStitch(),v(i).then(()=>{})}onShowMaximumCaptureReached(){let t=f("MAXIMUMCAPTUREREACHED");S("",[f("OK")],null,t)}async onShowActionSheet(t,i){if(i&&i<0&&this.max&&this.value&&this.value.length===this.max)this.onShowMaximumCaptureReached();else if(!this.isProcessing){this.actionSheetOpened.emit(i);let s=[];if(t){const t=!0;s.push({icon:"yo-eye",text:f("photo"===this.type?"VIEWPHOTO":"VIEW"),handler:()=>this.openPreview(i,t)}),!0===this.allowLibrary&&s.push({icon:"yo-photo-library",text:f("IMPORTFROMLIBRARY"),handler:()=>this.upload(i)}),"photo"===this.type&&this.allowAnnotate&&s.push({icon:"yo-pen",text:f("ANNOTATE"),handler:()=>this.onAnnotate(i)}),await this.addCaptureButtons(s,i),s.push({icon:"yo-delete",text:f("photo"===this.type?"DELETEPHOTO":"DELETE"),handler:()=>this.deleteCapture(i)})}else await this.addCaptureButtons(s,i),!0!==this.allowLibrary&&(o()||"video"!==this.type&&"audio"!==this.type)||s.push({icon:"yo-photo-library",text:f("IMPORTFROMLIBRARY"),handler:()=>this.upload(i)});"photo"===this.type&&this.allowGif&&s.push({icon:"yo-gif",text:f("IMPORTGIF"),handler:()=>this.importExternal("gif",i)}),"photo"===this.type&&this.allowUnsplash&&s.push({icon:"yo-image",text:f("IMPORTUNSPLASH"),handler:()=>this.importExternal("unsplash",i)}),this.shouldTagImage()&&t&&s.push({icon:"yo-tag",text:this.onHasTag(i)?f("EDITTAG"):f("ADDNEWTAG"),handler:()=>{let s;this.multiple?this.extraData&&this.extraData[i]&&this.extraData[i].tags&&(s=this.extraData[i].tags):this.extraData&&this.extraData.tags&&(s=this.extraData.tags),this.showPhotoTagDialog(t,s).then(t=>{O(t.data)||this.updateTagData(t,i)})}}),1!==s.length||"photo"===this.type&&!o()?s.length>0&&F(s):s[0].handler()}}hasExtraData(t,i=!1){if(this.extraData){if(i&&this.extraData[t]&&this.extraData[t].edit)return!0;if(i&&this.extraData[t]&&this.extraData[t].texts);else if(!i)return!!this.extraData.edit||L(this.extraData.texts)}return!1}hasGeoData(t){if(this.extraData)if(this.multiple){if(this.extraData._geoloc&&this.extraData._geoloc[t]&&this.extraData._geoloc[t].length>0)return!0}else if(this.extraData&&this.extraData._geoloc&&this.extraData._geoloc.length>0)return!0;return!1}onAddFileSelect(){if(this.value){let t=this.getAddFileInput(),i=this.max-this.value.length,s=Array.from(t.files).slice(0,i),e=[],n=s.map((t,i)=>{if(st(t))return ut(t,"blob").then(t=>{e[i]=t});e[i]=t});Promise.all(n).then(()=>{if(1===e.length){let t=this.value.length-1;this.shouldTagImage()&&this.showPhotoTagDialog(e[0]).then(i=>{O(i.data)||(this.updateTagData(i,t),this.clearPhotoEdit(t),this.saveGeoloc&&this.captureGeoloc(t))})}this.value=[...[].concat(this.value),...e],m(this.value,this),t.value=null})}}isAllItemSelected(){return this.selectedIndex.length===this.value.length}isItemSelected(t){let i=this.selectedIndex.indexOf(t);return void 0!==i&&i>-1}unselectAll(){this.selectedIndex=[]}selectAll(){if(y(this.value)){let t=Array.from(this.value.keys());this.selectedIndex=[...t]}}onItemSelect(t){this.isItemSelected(t)?(this.selectedIndex.splice(this.selectedIndex.indexOf(t),1),this.selectedIndex=[...this.selectedIndex]):this.selectedIndex=[...this.selectedIndex,t]}onDeleteSelect(){let t=[...[].concat(this.value)];this.selectedIndex.sort().reverse().forEach(i=>{t.splice(i,1),this.clearPhotoEdit(i)}),this.value=[...t],m(this.value,this),this.clearImageRecognition(),this.toggleSelectorMode()}toggleSelectorMode(){this.isSelectorMode=!this.isSelectorMode,this.selectedIndex=[]}getAcceptExtension(){let t;switch(this.type){case"video":t=gt;break;case"audio":t=wt;break;case"photo":default:t=bt}return t&&t.length>0?t.map(t=>"."+t).join(","):null}renderEditIcon(){return s("div",{class:"edit-icon-container"},s("span",{class:"edit-icon"},s("yoo-icon",{class:"yo-brush"})))}renderAudio(){return s("yoo-card-file",{class:"document",type:this.type,_downloadURL:this.value})}renderPreviewPlayIcon(){return"video"===this.type&&this.readonly?s("div",{class:"control-container"},s("yoo-icon",{class:"yo-play"})):null}renderPreview(){return s("yoo-img",{type:"back",class:"preview",onClick:t=>this.handleImageClick(null,t),src:H(this.value,500,500)},"video"===this.type?s("div",{class:"overlay"}):null,this.renderPreviewPlayIcon())}handleImageClick(t,i){this.preventVideoPlay||(this.readonly&&this.useGallery?this.openGallery(t):this.multiple&&t>-1?this.renderMultiplePreview(t):this.openPreview()),i&&i.stopPropagation()}renderMultiplePreview(t){if(this.readonly&&this.useGallery)this.openGallery(t);else if(this.value&&y(this.value)&&this.value.length>0){let i=document.createElement("yoo-photo-editors");i.index=t,i.isReadonly=!0,i.items=this.value.map((t,i)=>{let s={value:t};return this.extraData[i]&&(s={value:t,edit:this.extraData[i].edit,texts:this.extraData[i].texts,svgData:this.extraData[i].svgData}),s}),v(i)}else this.allowAnnotate&&this.onAnnotate(t)}shouldRotateImage(t){return!(!t||!t.includes)&&t.includes("rotate_image")}onShowDistanceDialog(t){let i=document.createElement("yoo-form-capture-map-dialog"),s=[];this.multiple&&t>-1?this.extraData&&this.extraData._geoloc&&this.extraData._geoloc[t]&&2===this.extraData._geoloc[t].length&&(s=[{latitude:this.extraData._geoloc[t][1],longitude:this.extraData._geoloc[t][0],selected:!0}]):this.extraData&&this.extraData._geoloc&&this.extraData._geoloc&&2===this.extraData._geoloc.length&&(s=[{latitude:this.extraData._geoloc[1],longitude:this.extraData._geoloc[0],selected:!0}]),i.markers=s,v(i,null,"","slideYEnterAnimation","slideYLeaveAnimation")}renderDistance(t){return[s("div",{class:"distance"},s("div",{class:"inner-container",onClick:()=>{this.onShowDistanceDialog(t)}},s("yoo-icon",{class:"yo-pin"}),s("span",null,ft.distance.transform(this.multiple?this.extraData.distance[t]:this.extraData.distance))))]}renderSingle(){return this.readonly?s("div",{class:"readonly-container"},"audio"===this.type?this.renderAudio():this.renderPreview(),this.extraData&&this.extraData.distance&&this.renderDistance(),this.hasExtraData()&&!this.isHistory&&this.renderEditIcon()):s("div",{class:"single"},this.renderCameraContainer(this.value,this.extraData),this.isImageRecognition&&!this.isBackgroundProcess&&this.renderButtonContainer())}renderCaptureStatus(){let t=this.value||[];return t&&s("div",{class:"capture-status"},this.required&&s("div",{class:"status"},f("PHOTOTAKEN",t.length>this.min?{captured_number:`${this.min}/${this.min}`}:{captured_number:`${t.length}/${this.min}`})),this.max&&this.max>0&&s("div",{class:{status:!0,"max-reached":t.length===this.max}},f("MAXIMUMCAPTURE",{captured_number:`${t.length}/${this.max}`})),t.length>0&&s("div",{class:"action",onClick:()=>{this.toggleSelectorMode()}},f("SELECT2")))}renderMultiple(){let t=this.value||[];return this.readonly?t.map&&t.map((t,i)=>t?s("div",{class:"readonly-container multiple"},s("yoo-img",{type:"back",class:"preview",onClick:()=>this.handleImageClick(i),src:H(t,500,500)}),this.hasExtraData(i,this.multiple)&&!this.isHistory?this.renderEditIcon():null,this.extraData&&this.extraData.distance&&this.extraData.distance[i]&&this.renderDistance(i)):null):this.isSelectorMode?this.renderMultipleInSelectMode():this.renderMultipleInNormalMode()}checkImageOverflow(){return!!(this.value&&y(this.value)&&this.value.length)&&this.value.length>this.overflowOffset}renderBottomAction(){return s("div",{class:{"bottom-action-container":!0,active:this.selectedIndex.length>0},onClick:()=>{this.onDeleteSelect()}}," ",f("DELETE"))}renderTopAction(){return s("div",{class:"top-action-container"},s("div",{class:"left-action"},this.isAllItemSelected()?s("div",{onClick:()=>{this.unselectAll()}},f("UNSELECTALL")):s("div",{onClick:()=>{this.selectAll()}},f("SELECTALL"))),s("div",{class:"right-action",onClick:()=>{this.toggleSelectorMode()}},"Cancel"))}renderSelectorOverlay(){return s("div",{class:"media-overlay"},s("yoo-icon",{class:"video"===this.type?"yo-videocamera":"yo-microphone"}))}renderCameraContainerInSelectMode(t,i){return s("div",{class:{"camera-selector-container":!0,rotate:this.shouldRotateImage(t)},onClick:()=>{this.onItemSelect(i)}},t&&"photo"===this.type?s("yoo-img",{type:"back",class:"preview",src:H(t,500,500)}):this.renderSelectorOverlay(),s("yoo-icon",{class:"yo-circle"}),t&&(!this.multiple||"photo"!==this.type)&&s("div",{class:"overlay"}),this.isItemSelected(i)?s("yoo-icon",{class:"yo-check "+U()}):null)}renderMultipleInSelectMode(){let t=this.value||[];return s("div",{class:"multiple selector-mode"},this.renderTopAction(),y(t)&&t.length>0?t.map((t,i)=>this.renderCameraContainerInSelectMode(t,i)):null,this.renderBottomAction())}renderMultipleInNormalMode(){let t=this.value||[];return s("div",{class:"multiple"},this.showImageLoader?s("yoo-loader",{class:"absolute lg backdrop"}):null,this.renderCaptureStatus(),this.renderAddCameraContainer(),y(t)&&t.length>0?t.map((t,i)=>this.renderCameraContainer(t,this.extraData[i],i)):null,this.isImageRecognition&&!this.isBackgroundProcess?this.renderButtonContainer():null)}renderAddCameraContainer(t=-1){return s("div",{class:"camera-container",onClick:()=>this.onShowActionSheet(null,t)},s("input",{multiple:!0,class:"add-input",type:"file",onChange:()=>this.onAddFileSelect(),accept:this.getAcceptExtension()}),s("yoo-icon",{class:this.getIcon()+" "+U()}))}renderProgressBar(t,i=!1){this.multiple||(t=0);let e={hideProgressValue:!0,listenToFinishedProgress:!0,progressIndicator:i?"main":`${t+1}`,stopProgressAtValue:20,lineAnimation:"linear"};return s("div",{class:"progressbar-wrapper"},i?[this.currentUploadingStatus&&(W(t)||!this.multiple)&&s("div",{class:"text "+U()},this.currentUploadingStatus),!this.isUploadingPhoto&&s("div",{class:"main-wrapper"},s("yoo-progress-bar-core",{shape:"line",progressValue:100,ref:t=>this.progressBarMainRef=t,progressParameters:e,progressAnimationDuration:this.progressTime,percentProgressColorScheme:!1}))]:[s("yoo-progress-bar-core",{shape:"line",progressValue:0,ref:i=>{this.progressBarRef[t]=i},progressAnimationDuration:6e4,progressParameters:e,percentProgressColorScheme:!1})])}renderCameraContainer(t,i,e){return s("div",{class:{"camera-container":!0,rotate:this.shouldRotateImage(t)},onClick:()=>this.onShowActionSheet(t,e)},s("input",{class:"camera-input",type:"file",onChange:t=>this.onFileSelect(t,e),accept:this.getAcceptExtension()}),t?s("yoo-img",{type:"back",class:"preview",src:"photo"===this.type?H(t,500,500):null}):null,i&&i.edit?s("yoo-img",{type:"back",class:"edit",src:H(i.edit,340,250)}):null,t&&(!this.multiple||"photo"!==this.type)&&s("div",{class:"overlay"}),this.multiple&&"photo"===this.type?null:s("yoo-icon",{class:this.getIcon()+(t?" always-light":" "+U())}),this.onHasTag(e)&&s("div",{class:"tag-icon-container"},s("yoo-icon",{class:"yo-tag"})),this.isProcessing&&this.renderProgressBar(e))}renderButtonContainer(){return[s("div",{class:{"button-containers":!0,kpi:this.algorithmDisplay&&this.imageRecognitionResults&&this.imageRecognitionResults.length>0}},!this.isProcessing&&s("div",{class:"button-container"}," ",s("yoo-button",{class:"x-medium full-width "+U(),onClick:t=>this.onImageRecognition(t),disabled:!this.isValueValid(),text:f("STARTIMAGERECO")})),!this.isProcessing&&this.imageRecognitionResults&&this.imageRecognitionResults.length>0&&this.algorithmDisplay&&s("div",{class:"button-container"},s("yoo-button",{class:"x-medium dark show-kpi full-width",onClick:t=>this.onShowImageRecoKpis(t),text:f("SHOWIMAGERECOKPIS")})))]}renderReadonly(){if(!this.value)return null;let t=this.isHistory&&this.checkImageOverflow();return[s("div",{class:{readonly:!0,truncate:t},ref:t=>this.readonlyDiv=t},this.multiple?this.renderMultiple():this.renderSingle()),this.imageRecognitionResults&&this.imageRecognitionResults.length>0&&this.algorithmDisplay?s("div",{class:"button-containers"},s("yoo-button",{class:"x-medium dark full-width",onClick:t=>this.onShowImageRecoKpis(t),text:f("SHOWIMAGERECOKPIS")})):null,t?s("div",{class:"more-button",ref:t=>this.moreButtonDiv=t,onClick:()=>this.onToggleMore()},f("MORE2")):null]}onToggleMore(){this.readonlyDiv&&this.readonlyDiv.classList.contains("truncate")?(this.readonlyDiv.classList.remove("truncate"),this.moreButtonDiv.innerHTML=f("VIEWLESS")):(this.readonlyDiv.classList.add("truncate"),this.moreButtonDiv.innerHTML=f("MORE2"))}onHasTag(t){return t>-1?this.extraData&&this.extraData[t]&&this.extraData[t].tags&&this.extraData[t].tags.length>0:this.extraData&&this.extraData.tags&&this.extraData.tags.length>0}shouldTagImage(){return this.tags&&this.tags.length>0}onCancelImageReco(){S("",[f("NO"),f("YES")],null,f("STOPIMAGERECO")).then(t=>{t&&this.stopImageRecognitionProcess(!0)})}onDisplayImageRecoEndToast(){g({message:f("IMAGERECODONE"),duration:2e3,icon:"yo-check",cssClass:"header "+U(),closable:!0})}renderEditable(){return s("div",{class:{"outer-container":!0,uploading:this.isProcessing}},this.isProcessing?s("div",{class:"upload-overlay"}):null,this.isProcessing?this.renderProgressBar(void 0,!0):null,this.multiple?this.renderMultiple():this.renderSingle())}render(){return s(e,{class:Object.assign({},p(),{audio:this.type&&"audio"===this.type&&this.isHistory})},this.readonly?this.renderReadonly():this.renderEditable(),this.isProcessing&&s("yoo-button",{class:"x-medium danger canel full-width",onClick:()=>this.onCancelImageReco(),text:f("CANCELIMAGERECO")}))}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{--width-readonly-preview:100%;--height-readonly-preview:250px;--play-icon-size:var(--font-size-12,3.375rem);--selector-icon-size:var(--font-size-03,1rem);--camera-selector-container-size:98px;--camera-container-height:98px}:host .outer-container{display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start}:host .outer-container.uploading{padding-bottom:var(--padding-15,.9375rem);opacity:.6}:host .outer-container .upload-overlay{position:absolute;width:100%;height:100%;background:transparent;z-index:999}:host .outer-container .progressbar-wrapper{width:100%;margin-top:-.5rem;padding:.5rem 0}:host .outer-container .progressbar-wrapper .main-wrapper{margin-top:var(--padding-10,.625rem)}:host .outer-container .progressbar-wrapper yoo-progress-bar-core{--initial-progress-line-height:2px}:host .outer-container .camera-container{position:relative;width:var(--camera-container-height,98px);height:var(--camera-container-height,98px);border:1px solid var(--input-container-border-color,hsla(0,0%,67.8%,.4));border-radius:.5rem;cursor:pointer;min-width:var(--camera-container-height,98px)}:host .outer-container .camera-container .required{top:auto;right:auto;bottom:auto;left:.625rem;position:absolute;color:var(--success,#04cc99);font-size:var(--font-size-02,.875rem)}:host .outer-container .camera-container yoo-icon{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:var(--camera-container-size,30px)}:host .outer-container .camera-container yoo-icon.light{color:var(--light,#fff)}:host .outer-container .camera-container yoo-icon.success{color:var(--success,#04cc99)}:host .outer-container .camera-container .edit,:host .outer-container .camera-container .overlay,:host .outer-container .camera-container .preview{top:0;right:auto;bottom:auto;left:auto;position:absolute;width:var(--camera-container-height,98px);height:var(--camera-container-height,98px);border-radius:.5rem}:host .outer-container .camera-container .edit.edit,:host .outer-container .camera-container .overlay.edit,:host .outer-container .camera-container .preview.edit{top:0;right:auto;bottom:auto;left:0;position:absolute;z-index:0}:host .outer-container .camera-container .overlay{background:var(--black-60,rgba(0,0,0,.6));opacity:.5}:host .outer-container .camera-container input[type=file]{top:0;right:auto;bottom:auto;left:50%;position:absolute;display:block;width:var(--camera-container-height,98px);min-width:var(--camera-container-height,98px);height:var(--camera-container-height,98px);margin-left:-50px;border-radius:50%;outline:none;background:var(--light,#fff);text-align:right;cursor:inherit;opacity:0;filter:alpha(opacity=0);pointer-events:none}:host .outer-container .camera-container.rotate{-webkit-transform:rotate(90deg);transform:rotate(90deg)}:host .outer-container .camera-container.rotate .progressbar-wrapper{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}:host .outer-container .camera-container .tag-icon-container{display:-ms-flexbox;display:flex;position:absolute;right:5px;bottom:5px;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:20px;height:20px;border-radius:50%;background-color:var(--black-60,rgba(0,0,0,.6))}:host .outer-container .camera-container .tag-icon-container yoo-icon.yo-tag{color:var(--light,#fff);font-size:var(--font-size-02,.875rem)}:host .outer-container .camera-container .progressbar-wrapper{position:absolute;width:100%;height:100%;margin:0;padding:0}:host .outer-container .camera-container .progressbar-wrapper yoo-progress-bar-core{position:absolute;bottom:-10px}:host .outer-container .multiple{position:relative;width:100%;margin-bottom:-.75rem}:host .outer-container .multiple.selector-mode{margin-bottom:0}:host .outer-container .multiple .capture-status{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding-bottom:10px;font-size:var(--font-size-02,.875rem)}:host .outer-container .multiple .capture-status .action{padding-left:var(--padding-15,.9375rem);color:var(--success,#04cc99);text-align:right}:host .outer-container .multiple .capture-status .status{width:100%;padding-right:var(--padding-15,.9375rem);color:var(--stable,#adadad);text-align:left;white-space:nowrap}:host .outer-container .multiple .capture-status .status.max-reached{color:var(--black,#000)}:host .outer-container .multiple .camera-container{display:inline-block;margin-right:var(--padding-15,.9375rem);margin-bottom:var(--padding-15,.9375rem)}:host .outer-container .multiple .camera-container .yo-plus{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:25px;height:25px;border-radius:20px;background:var(--success,#04cc99);font-size:var(--font-size-04,1.125rem)}:host .outer-container .multiple .camera-container .yo-plus:before{color:var(--light,#fff)}:host .outer-container .multiple .camera-selector-container{display:inline-block;position:relative;width:var(--camera-selector-container-size);min-width:var(--camera-selector-container-size);height:var(--camera-selector-container-size);margin-right:var(--padding-15,.9375rem)}:host .outer-container .multiple .camera-selector-container .preview{width:100%;height:100%;border-radius:var(--border-radius-input,5px)}:host .outer-container .multiple .camera-selector-container yoo-icon{position:absolute;top:5px;right:5px;width:var(--selector-icon-size);height:var(--selector-icon-size);color:var(--light,#fff);font-size:var(--selector-icon-size)}:host .outer-container .multiple .camera-selector-container yoo-icon.yo-circle{z-index:2}:host .outer-container .multiple .camera-selector-container yoo-icon.yo-check{color:var(--success,#04cc99);z-index:3}:host .outer-container .multiple .camera-selector-container .media-overlay{position:absolute;width:100%;height:100%;border-radius:var(--border-radius-input,5px);background-color:var(--black-20,rgba(0,0,0,.2))}:host .outer-container .multiple .camera-selector-container .media-overlay yoo-icon{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:var(--camera-container-size,30px);height:var(--camera-container-size,30px);color:var(--light,#fff);font-size:var(--camera-container-size,30px)}:host .outer-container .multiple .camera-selector-container.rotate{-webkit-transform:rotate(90deg);transform:rotate(90deg)}:host .outer-container .multiple .camera-selector-container.rotate yoo-icon{right:0;left:5px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}:host .outer-container .multiple .bottom-action-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:45px;margin-top:var(--padding-15,.9375rem);background:var(--stable-ultralight,#fafafa);color:var(--stable-light,#f1f1f1)}:host .outer-container .multiple .bottom-action-container.active{color:var(--danger,#ff625f)}:host .outer-container .multiple .top-action-container{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;padding-bottom:var(--padding-15,.9375rem)}:host .outer-container .multiple .top-action-container .left-action,:host .outer-container .multiple .top-action-container .right-action{width:100%;color:var(--success,#04cc99)}:host .outer-container .multiple .top-action-container .left-action{text-align:left}:host .outer-container .multiple .top-action-container .right-action{text-align:right}:host .outer-container .single{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;width:100%}:host .outer-container .single .button-containers{-ms-flex-align:center;align-items:center;margin-bottom:0;margin-left:1rem}:host .outer-container .single .button-containers.kpi{display:grid;padding-left:var(--padding-15,.9375rem);grid-template-columns:99%}:host .outer-container .button-containers{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:distribute;justify-content:space-around;width:100%;margin-bottom:1rem}:host .outer-container .button-containers.kpi{display:grid;grid-template-columns:49% 49%;grid-gap:var(--padding-15,.9375rem)}:host .outer-container .button-containers .button-container{display:block;width:100%}:host .outer-container .button-containers .button-container yoo-button{display:block}:host .outer-container .tags{width:100%;margin-top:.5rem}:host .readonly{padding:.5rem 0}:host .readonly .readonly-container{position:relative}:host .readonly .readonly-container .preview{display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:var(--width-readonly-preview);height:var(--height-readonly-preview);margin-right:auto;margin-bottom:1rem;margin-left:auto;border-radius:var(--border-radius-input,5px)}:host .readonly .readonly-container .preview .overlay{position:absolute;width:100%;height:100%;background-color:var(--black-40,rgba(0,0,0,.4))}:host .readonly .readonly-container .preview .control-container{display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;background:transparent;font-size:var(--play-icon-size);z-index:1}:host .readonly .readonly-container .preview .control-container yoo-icon{position:absolute;width:var(--play-icon-size);height:var(--play-icon-size);color:var(--light,#fff)}:host .readonly .readonly-container .edit-icon-container{display:-ms-flexbox;display:flex;position:absolute;bottom:var(--padding-15,.9375rem);left:var(--padding-15,.9375rem);-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:1.875rem;height:1.875rem;border-radius:.9375rem;background:var(--light,#fff);color:var(--black,#000);font-size:var(--font-size-03,1rem)}:host .readonly .readonly-container .distance{display:-ms-flexbox;display:flex;width:100%;margin-top:.8rem;padding-bottom:var(--padding-10,.625rem)}:host .readonly .readonly-container .distance .inner-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:auto;margin-left:auto}:host .readonly .readonly-container .distance .inner-container span{padding-left:var(--padding-5,.3125rem)}:host .readonly .button-container{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:row;flex-direction:row;-ms-flex-line-pack:center;align-content:center;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;margin-bottom:.5rem}:host .readonly .button-container yoo-button{--padding-container:0 3rem;--width-container:230px}:host(.audio) .readonly .readonly-container{width:100%}:host(.no-padding) .readonly,:host(.no-padding) .readonly .readonly-container,:host(.no-padding) .readonly .readonly-container .preview{height:100%;margin:0;padding:0}:host(.history){padding:0!important}:host(.history) .readonly{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0!important}:host(.history) .readonly .readonly-container .preview{margin:0!important;border-radius:2px!important}:host(.history) .readonly .readonly-container.multiple{width:auto;min-width:0;padding-right:5px;padding-bottom:5px}:host(.history) .readonly .preview .overlay{background-color:unset}:host(.history) .readonly.truncate{max-height:30px;overflow:hidden}:host(.history) .more-button{display:-ms-flexbox;display:flex;margin-left:auto;float:right;color:var(--stable,#adadad)}:host(.truncate) .readonly{max-height:70px;overflow:hidden}:host(.boost) .outer-container .multiple .capture-status .action{color:var(--danger-light,#f46885)}:host(.boost) yoo-icon.success{color:var(--danger-light,#f46885)!important}:host(.no-radius) .readonly .readonly-container .preview{border-radius:0}\@media only screen and (max-width:360px){:host{--camera-selector-container-size:93px!important;--camera-container-height:93px!important}:host .outer-container .camera-container{position:relative;width:var(--camera-container-height-medium-screen,93px);height:var(--camera-container-height-medium-screen,93px);border:1px solid var(--input-container-border-color,hsla(0,0%,67.8%,.4));border-radius:.5rem;cursor:pointer}:host .outer-container .camera-container .required{top:auto;right:auto;bottom:auto;left:.625rem;position:absolute;color:var(--success,#04cc99);font-size:var(--font-size-02,.875rem)}:host .outer-container .camera-container yoo-icon{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:var(--camera-container-size,30px)}:host .outer-container .camera-container yoo-icon.light{color:var(--light,#fff)}:host .outer-container .camera-container yoo-icon.success{color:var(--success,#04cc99)}:host .outer-container .camera-container .edit,:host .outer-container .camera-container .overlay,:host .outer-container .camera-container .preview{top:0;right:auto;bottom:auto;left:auto;position:absolute;width:var(--camera-container-height-medium-screen,93px);height:var(--camera-container-height-medium-screen,93px);border-radius:.5rem}:host .outer-container .camera-container .edit.edit,:host .outer-container .camera-container .overlay.edit,:host .outer-container .camera-container .preview.edit{top:0;right:auto;bottom:auto;left:0;position:absolute;z-index:0}:host .outer-container .camera-container .overlay{background:var(--black-60,rgba(0,0,0,.6));opacity:.5}}\@media only screen and (max-width:320px){:host{--camera-selector-container-size:60px!important;--camera-container-height:70px!important}:host .outer-container .camera-container{position:relative;width:var(--camera-container-height-small-screen,70px);height:var(--camera-container-height-small-screen,70px);border:1px solid var(--input-container-border-color,hsla(0,0%,67.8%,.4));border-radius:.5rem;cursor:pointer}:host .outer-container .camera-container .required{top:auto;right:auto;bottom:auto;left:.625rem;position:absolute;color:var(--success,#04cc99);font-size:var(--font-size-02,.875rem)}:host .outer-container .camera-container yoo-icon{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:var(--camera-container-size,30px)}:host .outer-container .camera-container yoo-icon.light{color:var(--light,#fff)}:host .outer-container .camera-container yoo-icon.success{color:var(--success,#04cc99)}:host .outer-container .camera-container .edit,:host .outer-container .camera-container .overlay,:host .outer-container .camera-container .preview{top:0;right:auto;bottom:auto;left:auto;position:absolute;width:var(--camera-container-height-small-screen,70px);height:var(--camera-container-height-small-screen,70px);border-radius:.5rem}:host .outer-container .camera-container .edit.edit,:host .outer-container .camera-container .overlay.edit,:host .outer-container .camera-container .preview.edit{top:0;right:auto;bottom:auto;left:0;position:absolute;z-index:0}:host .outer-container .camera-container .overlay{background:var(--black-60,rgba(0,0,0,.6));opacity:.5}:host .outer-container .single .button-containers.kpi{width:190px}}"}},kt=class{constructor(i){t(this,i)}onClose(){d(null)}renderHeader(){return s("yoo-header",{class:"shadow"},s("yoo-ion-toolbar",{color:"light"},s("yoo-ion-buttons",{slot:"start"},s("yoo-ion-button",{color:"text-color",class:"close button-clear",onClick:()=>this.onClose()},s("yoo-icon",{slot:"icon-only",class:"yo-close"}))),s("yoo-title",null,f("MAP"))))}renderContent(){return[s("yoo-ion-content",{scrollEnabled:!1,class:"bg-light"},s("yoo-map",{markers:this.markers}))]}render(){return[this.renderHeader(),this.renderContent()]}get host(){return n(this)}static get style(){return""}},At=class{constructor(s){t(this,s),this.newValue=[],this.fetchData=i(this,"fetchData",7)}componentWillLoad(){this.newValue=this.value?this.value:[]}onSave(){d(this.newValue)}onCancel(){d(null)}onFetchGridData(t){t.stopPropagation(),this.fetchData.emit(t.detail)}onTagChanged(t){t.stopPropagation(),t.detail&&(this.newValue=t.detail)}renderTags(){return[s("div",{class:"tag-header"},f("TAGS"),s("span",{class:"optional"},`(${f("OPTIONAL")})`)),s("yoo-form-autocomplete",{class:"tags",iconPrefix:"yo-tag",displayType:"card-list",value:this.value,values:this.tags,multiple:!0,onValidityChanged:t=>t.stopPropagation(),onInputChanged:t=>this.onTagChanged(t),onFetchData:t=>this.onFetchGridData(t),placeholder:f("SELECTTAG")})]}renderHeader(){return[s("div",{class:"title-container"},s("yoo-ion-button",{color:"text-color",class:"close",onClick:()=>this.onCancel()},s("yoo-icon",{slot:"icon-only",class:"yo-close"})),s("yoo-title",null,f("PREVIEW")))]}renderBody(){return[s("div",{class:"outer-container"},s("div",{class:"image-container"},s("yoo-img",{type:"back",loadStrategy:"instant",src:H(this.imageSrc,window&&window.innerWidth?window.innerWidth:375,this.imageHeight?this.imageHeight:375)})),s("div",{class:"tags-container"},this.renderTags()),s("div",{class:"button-container"},s("yoo-button",{class:"large full-width success mobile operations",text:f("SAVE"),onClick:()=>this.onSave()})))]}render(){return s(e,{class:p()},this.renderHeader(),this.renderBody())}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{background:var(--light,#fff)}:host .outer-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}:host .outer-container .image-container{display:-ms-flexbox;display:flex;width:375px;width:100%;height:375px}:host .outer-container .image-container yoo-img{width:100%;height:100%}:host .outer-container .tags-container{padding:var(--padding-15,.9375rem)}:host .outer-container .tags-container .tag-header{padding-bottom:var(--padding-5,.3125rem)}:host .outer-container .tags-container .tag-header .optional{padding-left:var(--padding-5,.3125rem);color:var(--text-color,#807f83)}:host .outer-container .button-container{margin-top:auto;padding:var(--padding-15,.9375rem)}:host .title-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:64px}:host .title-container yoo-ion-button{position:absolute;left:0;color:var(--text-color,#807f83);z-index:1}:host .title-container yoo-ion-button.list{position:relative;right:0}:host .title-container yoo-ion-button.list yoo-icon.yo-list-view yoo-badge{position:absolute;top:2px;right:5px;border-radius:50%}:host(.iphone-x) .title-container{padding-top:50px}:host(.iphone-x) .bottom-container{padding-bottom:35px}"}},Tt=class{constructor(i){t(this,i)}componentWillLoad(){this.imageRecognitionResults&&this.imageRecognitionResults.length>0&&this.imageRecognitionDisplay&&this.imageRecognitionDisplay.length>0&&(this.properties=[],this.imageRecognitionDisplay.forEach(t=>{switch(t.type){case"list":case"grid":let i=V(this.imageRecognitionResults);t.filter&&(i=i.filter(i=>i.key.toUpperCase().indexOf(t.filter.toUpperCase())>=0)),t.filters&&(i=i.filter(i=>t.filters.map(t=>t.toUpperCase()).indexOf(i.key.toUpperCase())>=0)),null!=t.value&&(i=i.filter(i=>i.rawValue===t.value.toString())),t.factor&&i.forEach(i=>i.value*t.factor),t.sort&&(i=B(i,i=>i.value*("desc"===t.sort?-1:1))),t.limit&&(i=i.slice(0,t.limit));let s=i.map(i=>({values:[i.title,i.value+(t.unit?t.unit:"")],color:i.color}));t.rows&&(s=[],t.rows.forEach(t=>{let i=[];t.forEach((t,s)=>{if(0===s)i.push(t);else if(t){let s=this.imageRecognitionResults.find(i=>i.key&&t&&i.key.toLowerCase()===t.toLowerCase());i.push(s?s.value:null)}else i.push(null)}),s.push({values:i,color:null})})),this.properties.push({title:t.title,type:"grid",headers:t.headers||["KPI","Value"],values:s})}}))}componentDidLoad(){this.edit||this.preview||Y(this.ionSlides,!0)}onCancel(){d(null)}getResultColor(t){return t?"balanced"===t?"success":"assertive"===t?"danger":t:"black"}renderWebBody(){return s("yoo-ion-content",{scrollEnabled:!1,class:"bg-light"},s("div",{class:"images"},this.edit&&this.isStitch?null:s("yoo-img",{class:"preview",src:this.preview}),this.edit?s("yoo-img",{class:"preview edit",src:this.edit}):null,this.imageRecognitionResults&&this.imageRecognitionResults.length>0?s("div",{class:"image-recos"},this.imageRecognitionResults.map(t=>t.hidden?null:s("div",{class:"image-reco"},s("div",{class:"title"},t.title,":"),s("div",{class:"image-reco-value "+this.getResultColor(t.color)},t.value)))):null))}renderMobileBody(){return s("yoo-ion-content",{scrollEnabled:!1,class:"bg-light"},s("yoo-ion-slides",{ref:t=>this.ionSlides=t,pager:this.imageRecognitionResults&&this.imageRecognitionResults.length>0&&(this.edit||this.preview)},this.preview||this.edit?s("yoo-ion-slide",null,s("div",{class:"images"},this.edit&&this.isStitch?null:s("yoo-img",{class:"preview",src:this.preview}),this.edit?s("yoo-img",{class:"preview edit",src:this.edit}):null)):null,this.imageRecognitionResults&&this.imageRecognitionResults.length>0?s("yoo-ion-slide",null,s("yoo-ion-scroll",null,this.properties&&this.properties.length>0?[s("yoo-property-card",{class:"kpi swiper-no-swiping",properties:this.properties}),u()&&o()&&s("div",{class:"scroll-spacer"})]:s("div",{class:"image-recos swiper-no-swiping"},this.imageRecognitionResults.map((t,i)=>t.hidden?null:s("div",{class:"image-reco"+(i%2==0?" contrasted":"")},s("div",{class:"title"},t.title,":"),s("div",{class:"image-reco-value "+this.getResultColor(t.color)},t.value)))))):null))}render(){return[s("yoo-header",{class:"shadow"},s("yoo-ion-toolbar",{color:"light"},s("yoo-ion-buttons",{slot:"start"},s("yoo-ion-button",{color:"text-color",class:"close button-clear",onClick:()=>this.onCancel()},s("yoo-icon",{slot:"icon-only",class:"yo-close"}))),s("yoo-title",null,this.label))),K()?this.renderWebBody():this.renderMobileBody()]}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{--list-padding:1.25rem 0.625rem 1.25rem 0.625rem;--list-row-height:38px}:host yoo-ion-content{display:block;height:auto}:host yoo-ion-slides{height:100%}:host .scroll-spacer{width:100%;height:100px}:host .swiper-pagination-bullet-active{background-color:var(--black,#000)!important}:host .preview{position:absolute;top:50%;left:0;width:100%!important;height:auto;-webkit-transform:translateY(-50%);transform:translateY(-50%)}:host .preview.edit{z-index:1}:host .preview.web{right:0;left:0;width:auto;max-width:100%;max-height:600px}:host .image-recos{padding:var(--list-padding);background-color:var(--light,#fff);z-index:10}:host .image-recos .image-reco{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around;height:var(--list-row-height);padding:.25rem 1rem}:host .image-recos .image-reco.contrasted{background-color:var(--stable-light,#f1f1f1)!important}:host .image-recos .image-reco .image-reco-value,:host .image-recos .image-reco .title{font-size:var(--font-size-03,1rem)}:host .image-recos .image-reco .title{width:90%;text-align:left;overflow-wrap:break-word}:host .image-recos .image-reco .image-reco-value{width:10%;text-align:right;overflow-wrap:break-word}:host .image-recos .image-reco:nth-of-type(2n){background:var(--light,#fff)}:host .image-recos .image-reco:nth-of-type(odd){background:var(--kpi-list-item-background)}"}},It=J(X(function(t){var i;"undefined"!=typeof self&&self,i=function(){return function(t){var i={};function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=i,s.d=function(t,i,e){s.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=3)}([function(t){t.exports=function(t,i){i=Object.assign({},i);var s=function(t){var s=function(i){return"string"==typeof i?t===i:i.test(t)};return i.include?i.include.some(s):!i.exclude||!i.exclude.some(s)},e=!0,n=!1,o=void 0;try{for(var h,r=Object.getOwnPropertyNames(t.constructor.prototype)[Symbol.iterator]();!(e=(h=r.next()).done);e=!0){var a=h.value,l=t[a];"constructor"!==a&&"function"==typeof l&&s(a)&&(t[a]=l.bind(t))}}catch(t){n=!0,o=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw o}}return t};var i=["componentWillMount","render","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","componentDidCatch","setState","forceUpdate"];t.exports.react=function(s,e){return(e=Object.assign({},e)).exclude=(e.exclude||[]).concat(i),t.exports(s,e)}},function(t,i,s){Object.defineProperty(i,"__esModule",{value:!0}),i.addPrefixedStyle=i.isCanvasSupported=void 0;var e,n=function(){function t(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,s,e){return s&&t(i.prototype,s),e&&t(i,e),i}}(),o=(e=s(5))&&e.__esModule?e:{default:e},h=i.isCanvasSupported=function(){return!!document.createElement("canvas").getContext},r=(i.addPrefixedStyle=function(t,i,s){var e=t,n=i.charAt(0).toUpperCase()+i.slice(1);return e.style[i]=s,e.style["Webkit"+n]=s,e.style["Moz"+n]=s,e.style["ms"+n]=s,e.style["O"+n]=s,e},function(){function t(i,s){!function(i){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.defaultOptions={shutterOggUrl:null,shutterMp3Url:null,swfUrl:null,onDebug:function(t){return console&&console.log?console.log("JpegCamera: "+t):null},resolution:3840,quality:.9,shutter:!0,mirror:!1,previewMirror:!0,scale:1,accessMessage:"Please allow camera access when prompted by the browser.<br><br>Look for camera icon around your address bar."},this.isReady=!1,this.errorOccured=!1,this.statsCaptureScale=.2,this.snapshots={},this.displayedSnapshot=null,this.overlay=null,this.viewWidth=null,this.viewHeight=null;var e=i;if("string"==typeof e&&(e=document.getElementById(e.replace("#",""))),!e||!e.offsetWidth)throw new Error("JpegCamera: invalid container");e.innerHTML="",this.viewWidth=parseInt(e.offsetWidth,10),this.viewHeight=parseInt(e.offsetHeight,10),this.container=document.createElement("div"),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",e.appendChild(this.container),this.options=Object.assign({},this.defaultOptions,s)}return n(t,[{key:"canvasSupported",value:function(){return h()}}]),n(t,[{key:"resize",value:function(t,i){return this.viewWidth=parseInt(t,10),this.viewHeight=parseInt(i,10),this.resizePreview(),this}},{key:"ready",value:function(t){return this.options.onReady=t,this.options.onReady&&this.isReady&&this.options.onReady.call(this,{videoWidth:this.videoWidth,videoHeight:this.videoHeight}),this}},{key:"getStats",value:function(t){var i=new o.default(this,{});this.engineCapture(i,!1,.1,this.statsCaptureScale);var s=this;return i.getStats(function(i){return t.call(s,i)})}},{key:"capture",value:function(t){var i=Object.assign({},this.options);t&&(i=Object.assign({},i,t));var s=new o.default(this,i);this.snapshots[s.id]=s,i.shutter&&this.enginePlayShutterSound();var e=Math.min(1,i.scale);return e=Math.max(.01,e),this.engineCapture(s,i.mirror,i.quality,e),s}},{key:"showStream",value:function(){return this.engineShowStream(),this.displayedSnapshot=null,this}},{key:"discardAll",value:function(){var t=this;return this.displayedSnapshot&&this.showStream(),Object.keys(this.spanshots).map(function(i){var s=t.snapshots[i];return t.engineDiscard(s),s.discarded=!0,null}),this.snapshots={},this}},{key:"debug",value:function(t){return this.options.onDebug?this.options.onDebug.call(this,t):null}},{key:"display",value:function(t){return this.engineDisplay(t),this.displayedSnapshot=t,this.displayedSnapshot}},{key:"discard",value:function(t){return this.displayedSnapshot===t&&this.showStream(),this.engineDiscard(t),t.discarded=!0,delete this.snapshots[t.id]}},{key:"prepared",value:function(t,i){this.videoWidth=t,this.videoHeight=i;var s=this;return setTimeout(function(){return s.waitUntilStreamLooksOk(!0)},1)}},{key:"waitUntilStreamLooksOk",value:function(t){var i=this;return this.getStats(function(s){if(!(s.std>2)){t&&i.debug("Stream mean gray value = "+s.mean+" standard deviation = "+s.std);var e=i;return setTimeout(function(){return e.waitUntilStreamLooksOk(!1)},100)}return i.debug("Stream mean gray value = "+s.mean+" standard deviation = "+s.std),i.debug("Camera is ready"),i.isReady=!0,i.options.onReady?i.options.onReady.call(i,{videoWidth:i.videoWidth,videoHeight:i.videoHeight}):null})}},{key:"blockElementAccess",value:function(){return this.overlay=document.createElement("div"),this.overlay.style.width="100%",this.overlay.style.height="100%",this.overlay.style.position="absolute",this.overlay.style.top=0,this.overlay.style.left=0,this.overlay.style.zIndex=2,this.container.appendChild(this.overlay)}}]),t}());i.default=r},function(t,i){function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.WebcamError=function t(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s(this,t),this.error=i,this.details=e},i.WebcamErrors={INCORRECT_INITIALISATION:"INCORRECT_INITIALISATION",UNKNOWN_ERROR:"UNKNOWN_ERROR",GET_MEDIA_FAILED_INIT:"GET_MEDIA_FAILED_INIT",FLASH_FAILED_LOADING:"FLASH_FAILED_LOADING",FLASH_WINDOW_TOO_SMALL:"FLASH_WINDOW_TOO_SMALL",CAMERA_NOT_READY:"CAMERA_NOT_READY",GENERIC_ERROR:"GENERIC_ERROR",NO_GET_MEDIA_NOR_FLASH_AVAILABLE:"NO_GET_MEDIA_NOR_FLASH_AVAILABLE"}},function(t,i,s){Object.defineProperty(i,"__esModule",{value:!0});var e=h(s(4)),n=h(s(7)),o=s(2);function h(t){return t&&t.__esModule?t:{default:t}}navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),window.AudioContext||(window.AudioContext=window.webkitAudioContext),i.default=function(t,i){if(!i.onInit)throw new o.WebcamError(o.WebcamErrors.INCORRECT_INITIALISATION);e.default.engineCheck(function(){i.onInit(new e.default(t,i))},function(){n.default.engineCheck(function(){i.onInit(new n.default(t,i))},function(){i.onError&&i.onError(function(){throw new o.WebcamError(o.WebcamErrors.NO_GET_MEDIA_NOR_FLASH_AVAILABLE)}())})})}},function(t,i,s){Object.defineProperty(i,"__esModule",{value:!0});var e=function(){function t(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,s,e){return s&&t(i.prototype,s),e&&t(i,e),i}}(),n=a(s(0)),o=s(1),h=a(o),r=s(2);function a(t){return t&&t.__esModule?t:{default:t}}var l=function(t){var i=document.createElement("video");return!(!i.canPlayType||!i.canPlayType(t).replace(/no/,""))},c=function(){function t(i,s){!function(i){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var e=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,s));return e.waitForVideoReadyTimer=null,e.statusChecksCount=0,e.vorbisAudio="audio/ogg; codecs=vorbis",e.mpegAudio="audio/mpeg; ",e.message=null,e.videoContainer=null,e.stream=null,(0,n.default)(e),e.engineInit(),e}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(t,h.default),e(t,[{key:"destruct",value:function(){this.waitForVideoReadyTimer=null,this.video&&(this.video.pause(),this.video.src=""),this.stream&&(this.stream.getVideoTracks().forEach(function(t){t.stop()}),this.stream.getAudioTracks().forEach(function(t){t.stop()}))}},{key:"engineInit",value:function(){var t=this;this.debug("Using HTML5 engine."),this.message=document.createElement("div"),this.message.class="message",this.message.style.width="100%",this.message.style.height="100%",(0,o.addPrefixedStyle)(this.message,"boxSizing","border-box"),this.message.style.overflow="hidden",this.message.style.textAlign="center",this.message.style.position="absolute",this.message.style.zIndex=3,this.message.innerHTML=this.options.accessMessage,this.container.appendChild(this.message),this.videoContainer=document.createElement("div"),this.videoContainer.style.overflow="hidden",this.videoContainer.style.position="absolute",this.videoContainer.style.zIndex=1,this.container.appendChild(this.videoContainer),this.resizeVideoContainer(),this.video=document.createElement("video"),this.video.autoplay=!0,this.options.previewMirror&&(0,o.addPrefixedStyle)(this.video,"transform","scalex(-1.0)"),window.AudioContext&&(l(this.vorbisAudio)?this.loadShutterSound(this.options.shutterOggUrl):l(this.mpegAudio)&&this.loadShutterSound(this.options.shutterMp3Url)),navigator.mediaDevices.getUserMedia({video:{width:{min:640,ideal:this.options.resolution},deviceId:{exact:this.options.deviceId}},audio:!1}).then(function(i){if(!t.stream){var s=i.getVideoTracks()[0].getSettings();t.debug("Camera resolution "+s.width+"x"+s.height+"px"),function(i){if(t.removeMessage(),t.stream=i,window.URL)try{t.video.srcObject=i}catch(s){t.video.src=URL.createObjectURL(i)}else t.video.src=i;t.blockElementAccess(),t.waitForVideoReady()}(i)}}).catch(function(i){throw t.message.innerHTML="",new r.WebcamError(r.WebcamErrors.GET_MEDIA_FAILED_INIT,i)})}},{key:"resizePreview",value:function(){this.resizeVideoContainer(),this.resizeVideoBox()}},{key:"resizeVideoContainer",value:function(){var t=Math.floor(.2*this.viewHeight),i=Math.floor(.2*this.viewWidth);this.message.style.paddingTop=t+"px",this.message.style.paddingBottom=t+"px",this.message.style.paddingLeft=i+"px",this.message.style.paddingRight=i+"px",this.videoContainer.style.width=this.viewWidth+"px",this.videoContainer.style.height=this.viewHeight+"px"}},{key:"enginePlayShutterSound",value:function(){if(!this.shutterBuffer)return null;var t=this.audioContext.createBufferSource();return t.buffer=this.shutterBuffer,t.connect(this.audioContext.destination),t.start(0)}},{key:"engineCapture",value:function(t,i,s,e){var n=t,o=this.getCaptureCrop(),h=document.createElement("canvas");return h.width=Math.round(o.width*e),h.height=Math.round(o.height*e),h.getContext("2d").drawImage(this.video,o.xOffset,o.yOffset,o.width,o.height,0,0,Math.round(o.width*e),Math.round(o.height*e)),n.canvas=h,n.mirror=i,n.quality=s,n}},{key:"engineDisplay",value:function(t){return this.displayedcanvas&&this.container.removeChild(this.displayedcanvas),this.displayedcanvas=t.canvas,this.displayedcanvas.style.width=this.viewWidth+"px",this.displayedcanvas.style.height=this.viewHeight+"px",this.displayedcanvas.style.top=0,this.displayedcanvas.style.left=0,this.displayedcanvas.style.position="absolute",this.displayedcanvas.style.zIndex=2,this.options.previewMirror&&(0,o.addPrefixedStyle)(this.displayedcanvas,"transform","scalex(-1.0)"),this.container.appendChild(this.displayedcanvas)}},{key:"engineGetCanvas",value:function(t){var i=document.createElement("canvas");return i.width=t.canvas.width,i.height=t.canvas.height,i.getContext("2d").drawImage(t.canvas,0,0),i}},{key:"engineGetImageData",value:function(t){var i=t.canvas;return i.getContext("2d").getImageData(0,0,i.width,i.height)}},{key:"engineGetBlob",value:function(t,i,s,e,n){var o=void 0;if(s){(o=document.createElement("canvas")).width=t.canvas.width,o.height=t.canvas.height;var h=o.getContext("2d");h.setTransform(1,0,0,1,0,0),h.translate(o.width,0),h.scale(-1,1),h.drawImage(t.canvas,0,0)}else o=t.canvas;return o.toBlob(function(t){return n(t)},i,e)}},{key:"engineDiscard",value:function(t){return delete t.canvas}},{key:"engineShowStream",value:function(){return this.displayedcanvas&&(this.container.removeChild(this.displayedcanvas),this.displayedcanvas=null),this.videoContainer.style.display="block",null}},{key:"removeMessage",value:function(){return this.message.style.display="none",null}},{key:"loadShutterSound",value:function(t){if(this.audioContext||!t)return null;this.audioContext=new AudioContext;var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer";var s=this;return i.onload=function(){return s.audioContext.decodeAudioData(i.response,function(t){s.shutterBuffer=t})},i.send()}},{key:"waitForVideoReady",value:function(){var t=parseInt(this.video.videoWidth,10),i=parseInt(this.video.videoHeight,10);if(t>0&&i>0)return this.videoContainer.appendChild(this.video),this.videoWidth=t,this.videoHeight=i,this.video.style.position="relative",this.resizeVideoBox(),this.prepared(this.videoWidth,this.videoHeight);if(this.statusChecksCount>100)throw new r.WebcamError(r.WebcamError.CAMERA_NOT_READY);this.statusChecksCount++;var s=this;return this.waitForVideoReadyTimer=setTimeout(function(){return s.waitForVideoReady()},100),null}},{key:"resizeVideoBox",value:function(){var t=this.getVideoCrop();this.video.style.width=t.width+"px",this.video.style.height=t.height+"px",this.video.style.left=t.xOffset+"px",this.video.style.top=t.yOffset+"px"}},{key:"getVideoCrop",value:function(){var t=void 0;if(this.videoWidth/this.videoHeight>=this.viewWidth/this.viewHeight){this.debug("Filling height"),t=this.viewHeight/this.videoHeight;var i=Math.round(this.videoWidth*t);return{width:i,height:this.viewHeight,xOffset:-Math.floor((i-this.viewWidth)/2),yOffset:0}}this.debug("Filling width"),t=this.viewWidth/this.videoWidth;var s=Math.round(this.videoHeight*t);return{width:this.viewWidth,height:s,xOffset:0,yOffset:-Math.floor((s-this.viewHeight)/2)}}},{key:"getCaptureCrop",value:function(){var t=this.viewWidth/this.viewHeight;if(this.videoWidth/this.videoHeight>=t){var i=Math.round(this.videoHeight*t);return{width:i,height:this.videoHeight,xOffset:Math.floor((this.videoWidth-i)/2),yOffset:0}}var s=Math.round(this.videoWidth/t);return{width:this.videoWidth,height:s,xOffset:0,yOffset:Math.floor((this.videoHeight-s)/2)}}}]),t}();c.engineCheck=function(t,i){var s=document.createElement("canvas");s.getContext&&!s.toBlob&&i("JpegCamera: Canvas-to-Blob is not loaded");try{navigator.mediaDevices.enumerateDevices().then(function(s){s?t():i()}).catch(function(){i()})}catch(t){i()}},i.default=c},function(t,i,s){Object.defineProperty(i,"__esModule",{value:!0});var e=function(){function t(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,s,e){return s&&t(i.prototype,s),e&&t(i,e),i}}(),n=r(s(0)),o=r(s(6)),h=s(1);function r(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(i,s){!function(i){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.nextSnapshotId=1,this.discarded=!1,this.extraCanvas=null,this.blob=null,this.blobMime=null,this.imageData=null,this.stats=null,this.getCanvasTimeout=null,this.getBlobTimeout=null,this.getImageDataTimeout=null,(0,n.default)(this),this.camera=i,this.options=s,this.id=this.nextSnapshotId++}return e(t,[{key:"show",value:function(){if(this.discarded)throw new Error("discarded snapshot cannot be used");return this.camera.display(this),this}},{key:"hide",value:function(){return this.camera.displayedSnapshot()===this&&this.camera.showStream(),this}},{key:"getStats",value:function(t){var i=this;if(this.discarded)throw new Error("discarded snapshot cannot be used");return this.getImageData(function(s){return i.calculateStats(s,t)})}},{key:"getCanvas",value:function(t){if(this.discarded)throw new Error("discarded snapshot cannot be used");if(!(0,h.isCanvasSupported)())return!1;var i=this;return this.getCanvasTimeout=setTimeout(function(){return i.extraCanvas||(i.extraCanvas=i.camera.engineGetCanvas(i)),(0,h.addPrefixedStyle)(i.extraCanvas,"transform","scalex(-1.0)"),t.call(i,i.extraCanvas)},1),!0}},{key:"getBlob",value:function(t,i){var s=i;if(null==s&&(s="image/jpeg"),this.discarded)throw new Error("discarded snapshot cannot be used");if(!(0,h.isCanvasSupported)())return!1;var e=this;return this.getBlobTimeout=setTimeout(function(){return e.blobMime!==s&&(e.blob=null),e.blobMime=s,e.blob?t.call(e,e.blob):e.camera.engineGetBlob(e,s,e.options.mirror,e.options.quality,function(i){return e.blob=i,t.call(e,e.blob)})},1),!0}},{key:"getImageData",value:function(t){if(this.discarded)throw new Error("discarded snapshot cannot be used");var i=this;return this.getImageDataTimeout=setTimeout(function(){return i.imageData||(i.imageData=i.camera.engineGetImageData(i)),t.call(i,i.imageData)},1),null}},{key:"discard",value:function(){this.camera.discard(this),delete this.extraCanvas,delete this.imageData,delete this.blob}},{key:"options",value:function(){return Object.assign({},this.camera.options,this.options,this.uploadOptions)}},{key:"calculateStats",value:function(t,i){if(!this.stats){for(var s=void 0,e=t.width*t.height,n=0,h=new Array(e),r=0,a=e;r<a;r++){var l=4*r;s=.2126*t.data[l+0]+.7152*t.data[l+1]+.0722*t.data[l+2],n+=s=Math.round(s),h[r]=s}var c=Math.round(n/e),u=0;h.forEach(function(t){u+=Math.pow(t-c,2)}),this.stats=new o.default,this.stats.mean=c,this.stats.std=Math.round(Math.sqrt(u/e))}return i.call(this,this.stats)}}]),t}();i.default=a},function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function t(){!function(i){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.mean=null,this.std=null}},function(t,i,s){Object.defineProperty(i,"__esModule",{value:!0});var e=function(){function t(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,s,e){return s&&t(i.prototype,s),e&&t(i,e),i}}(),n=a(s(0)),o=s(1),h=a(o),r=s(2);function a(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(i,s){!function(i){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var e=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,s));return e.waitForVideoReadyTimer=null,e.instances={},e.nextId=1,(0,n.default)(e),e.engineInit(),e}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(t,h.default),e(t,[{key:"destruct",value:function(){this.waitForVideoReadyTimer=null}},{key:"sendMessage",value:function(t,i){var s,e=this.instances[parseInt(t,10)];if(!e)return null;for(var n=arguments.length,o=Array(n>2?n-2:0),h=2;h<n;h++)o[h-2]=arguments[h];return(s=this.prototype[i]).apply.apply(s,[e].concat(o))}},{key:"engineInit",value:function(){var t=this;this.debug("Using Flash engine"),this.id=this.nextId++,this.instances[this.id]=this;var i="flash_object_"+this.id,s={id:i,align:"middle"},e={id:this.id,width:this.viewWidth,height:this.viewHeight,shutter_url:this.options.shutterMp3Url?this.options.shutterMp3Url:""},n=this,h=document.createElement("div");h.id="jpeg_cameraflash_"+this.id,h.style.width="100%",h.style.height="100%",this.options.previewMirror&&(0,o.addPrefixedStyle)(h,"transform","scalex(-1.0)"),this.container.appendChild(h),swfobject.embedSWF(this.options.swfUrl,h.id,this.viewWidth,this.viewHeight,"0",null,e,{loop:"false",allowScriptAccess:"always",allowFullScreen:"false",quality:"best",wmode:"opaque",menu:"false"},s,function(s){if(!s.success)throw new r.WebcamError(r.WebcamErrors.FLASH_FAILED_LOADING,s);return n.debug("Flash loaded."),n.flash=document.getElementById(i),t.options.onReady&&t.waitForVideoReady(),null})}},{key:"waitForVideoReady",value:function(){try{if(this.flash._capture(1,!1,.1,1))return this.options.onReady.call(this,null)}catch(t){}var t=this;return this.waitForVideoReadyTimer=setTimeout(function(){return t.waitForVideoReady()},500),null}},{key:"resizePreview",value:function(){if(this.viewWidth<215||this.viewHeight<138)throw new r.WebcamError(r.WebcamErrors.FLASH_WINDOW_TOO_SMALL);return this.flash.parentNode.removeChild(this.flash),this.flash=null,this.engineInit(),this}},{key:"enginePlayShutterSound",value:function(){return this.flash._play_shutter()}},{key:"engineCapture",value:function(t,i,s,e){return this.flash._capture(t.id,i,s,e)}},{key:"engineDisplay",value:function(t){return this.flash._display(t.id)}},{key:"engineGetCanvas",value:function(t){t.imageData||(t.imageData=this.engineGetImageData(t));var i=document.createElement("canvas");return i.width=t.imageData.width,i.height=t.imageData.height,i.getContext("2d").putImageData(t.imageData,0,0),i}},{key:"engineGetImageData",value:function(t){var i=void 0,s=this.flash._get_image_data(t.id);if((0,o.isCanvasSupported)()){var e=document.createElement("canvas");e.width=s.width,e.height=s.height,i=e.getContext("2d").createImageData(s.width,s.height)}else i={data:[],width:s.width,height:s.height};for(var n=0;n<s.data.length;n++){var h=s.data[n],r=4*n,a=h>>8&255,l=255&h;i.data[r+0]=h>>16&255,i.data[r+1]=a,i.data[r+2]=l,i.data[r+3]=255}return i}},{key:"engineGetBlob",value:function(t,i,s,e,n){var o=void 0;if(t.extraCanvas||(t.extraCanvas=this.engineGetCanvas(t)),s){(o=document.createElement("canvas")).width=t.canvas.width,o.height=t.canvas.height;var h=o.getContext("2d");h.setTransform(1,0,0,1,0,0),h.translate(o.width,0),h.scale(-1,1),h.drawImage(t.extraCanvas,0,0)}else o=t.extraCanvas;return o.toBlob(function(t){return n(t)},i,e)}},{key:"engineDiscard",value:function(t){return this.flash._discard(t.id)}},{key:"engineShowStream",value:function(){return this.flash._show_stream()}},{key:"flashPrepared",value:function(t,i){return this.blockElementAccess(),document.body.tabIndex=0,document.body.focus(),this.prepared(t,i)}}]),t}();l.engineCheck=function(t,i){window.swfobject||i("JpegCamera: SWFObject is not loaded."),t()},i.default=l}])},t.exports=i()})),Mt=class{constructor(i){t(this,i),this.isReady=!1}componentDidLoad(){this.holderRef=A(this.host,"#webcamHolder"),setTimeout(()=>{this.initWebcam()},200)}componentDidUnload(){this.cleanUpCamera()}initWebcam(){this.webcamCamera&&this.webcamCamera.destruct();let t={shutterMp3Url:"assets/audio/shutter.mp3",shutterOggUrl:"assets/audio/shutter.ogg",onInit:t=>{this.webcamCamera=t,this.cleanUpCamera()},onReady:()=>{this.isReady=!0,this.host.forceUpdate()},onError:()=>{},onDebug:()=>{},shutter:!0,mirror:!0,previewMirror:!0};this.device&&(t.deviceId=this.device.deviceId,t.mirror=!1),this.holderRef&&It(this.holderRef,t)}cleanUpCamera(){if(this.webcamCamera){try{this.webcamCamera&&this.webcamCamera.audio_context&&"closed"!==this.webcamCamera.audio_context.state&&this.webcamCamera.audio_context.close()}catch(t){}try{this.webcamCamera.destruct()}catch(t){}}}onCancel(){this.cleanUpCamera(),d(null)}onSave(){if(this.webcamCamera&&this.isReady)try{this.webcamCamera.capture().getCanvas(t=>{let i=t.toDataURL("image/jpeg",.7);i&&i.length>10&&d(i)})}catch(t){}}render(){return q().isE2E&&(this.isReady=!0),[s("yoo-header",{class:"shadow"},s("yoo-ion-toolbar",{color:"light"},s("yoo-ion-buttons",{slot:"start"},s("yoo-ion-button",{color:"text-color",class:"close button-clear",onClick:()=>this.onCancel()},s("yoo-icon",{slot:"icon-only",class:"yo-close"}))),s("yoo-title",null,f("ADVANCED")),s("yoo-ion-buttons",{slot:"end"},s("yoo-ion-button",{color:"success",class:"button-clear",disabled:!this.isReady,onClick:()=>this.onSave()}," ",f("SAVE")," ")))),s("yoo-ion-content",{scrollEnabled:!1,class:"bg-light"},s("div",{id:"webcamHolder"},"Webcam"))]}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host yoo-ion-content{background:var(--light,#fff)}:host yoo-ion-content #webcamHolder{width:100%;height:100%}"}},_t=class{constructor(i){t(this,i)}isPositive(t){return!0===t.isPositive||!1===t.isPositive?t.isPositive:t.delta>0}isGrowing(t){return!0===t.isGrowing||!1===t.isGrowing?t.isGrowing:t.delta>0}getArrowIconClassName(t){if(0!==t.delta)return this.isGrowing(t)?"yo-big-arrow-up":"yo-big-arrow-down"}getChartIconClassName(t){if(0!==t.delta)return this.isGrowing(t)?"yo-chart-up":"yo-chart-down"}getDeltaColor(t){if(0!==t.delta)return this.isPositive(t)?"success":"danger"}renderDelta(t,i="column"){if(null==t.delta)return null;let e=t.delta,n=[t.delta,t.deltaSign||null].join(" ");return"row"!==i&&(e=[s("yoo-icon",{class:this.getArrowIconClassName(t)}),s("span",null,n),s("div",{class:"chart-container"},s("yoo-icon",{class:this.getChartIconClassName(t)}))]),s("div",{class:"delta "+this.getDeltaColor(t),style:{color:t.colorHex}},e)}renderTitle(t){return s("div",{class:"title"},s("span",null,f(t.title)))}renderNumber(t,i="column"){return s("div",{class:"number"},t.value&&s("span",null,t.value),"column"===i&&t.isPercent&&s("span",null,"%"))}renderColumns(t){return[t.values.map(t=>s("div",{class:"p-column"},s("div",{class:"top"},this.renderDelta(t)),s("div",{class:"bottom"},this.renderNumber(t),t.title&&this.renderTitle(t))))]}renderGrid(t){return s("div",{class:"p-type-grid-scroll-container swiper-no-swiping"},s("div",{class:"inner-container"},s("div",{class:"p-row header "+t.headers.length}),t.values.map(t=>s("div",{class:"p-row "},t.values.map(t=>t?s("span",{class:t.truncate?"break-lines":null}," ",z(t)?t:f(t.title)," "):null)))))}getValueArr(t){return[...Array.from(t.keys())]}renderKpiGrid(t){return s("div",{class:"p-type-grid-scroll-container swiper-no-swiping"},s("yoo-ion-scroll",{class:"relative",horizontalMode:!0,showScrollbar:!0},s("div",{class:"inner-container"},t.headers.map((i,e)=>s("div",{class:"p-column"},s("div",{class:"p-column-header"},i),this.getValueArr(t.values).map((i,n)=>s("div",{class:"p-column-item"},t.values[n].values[e])))))))}renderRows(t){return[t.values.map(t=>s("div",{class:"p-row"},t.title&&this.renderTitle(t),t.value&&this.renderNumber(t,"row"),t.delta&&this.renderDelta(t,"row")))]}renderChart(t){return s("div",null)}renderHtml(t){return s("div",null,t.value)}renderPropertyTitle(t){return s("div",{class:`details-title ${t.type}`},f(t.title))}renderPropertyEntity(t){switch(t.type){case"columns":return this.renderColumns(t);case"grid":return this.host.classList.contains("kpi")?this.renderKpiGrid(t):this.renderGrid(t);case"rows":return this.renderRows(t);case"chart":return this.renderChart(t);case"html":return this.renderHtml(t);default:return null}}renderPropertyType(t){return s("div",{class:"p-type-"+t.type},this.renderPropertyEntity(t))}renderProperty(t){return s("div",{class:"details"},t.title&&this.renderPropertyTitle(t),t.type&&this.renderPropertyType(t))}render(){const t=K()?"yoo-ion-content":"div";return s(e,{class:p()},this.properties&&s(t,{class:"outer-container"},this.properties.map(t=>this.renderProperty(t))))}get host(){return n(this)}static get style(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{--padding-outer-container:1rem;--list-padding:1.25rem 0.625rem 1.25rem 0.625rem;--list-row-height:38px}:host .outer-container{padding:var(--padding-outer-container)}:host .outer-container .details:first-child .details-title{margin-top:0}:host .outer-container .details{width:100%}:host .outer-container .details .details-title{margin-top:var(--padding-15,.9375rem);padding-bottom:1rem;font-size:var(--font-size-03,1rem);letter-spacing:1px;line-height:1.0625rem;text-align:center;text-transform:uppercase}:host .outer-container .details .title-rows{padding-bottom:1.25rem}:host .outer-container .p-type-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between}:host .outer-container .p-type-columns .p-column{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:38%;height:6.3125rem;margin-bottom:var(--padding-15,.9375rem);padding:.75rem 5% .9375rem 5%;border-radius:8px;background-color:var(--light,#fff);-webkit-box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15));box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15));overflow:hidden}:host .outer-container .p-type-columns .p-column .top{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:100%}:host .outer-container .p-type-columns .p-column .top .delta{-ms-flex-item-align:end;align-self:flex-end;font-size:var(--font-size-02,.875rem)}:host .outer-container .p-type-columns .p-column .top .delta yoo-icon{margin-right:.3125rem}:host .outer-container .p-type-columns .p-column .top .delta yoo-icon.yo-no-data{height:1rem;font-size:var(--font-size-07,1.75rem)}:host .outer-container .p-type-columns .p-column .top .delta yoo-icon.yo-big-arrow-down,:host .outer-container .p-type-columns .p-column .top .delta yoo-icon.yo-big-arrow-up{font-size:var(--icon-size-01,1rem)}:host .outer-container .p-type-columns .p-column .top .delta .chat-container{-ms-flex-item-align:end;align-self:flex-end;margin-top:.5rem}:host .outer-container .p-type-columns .p-column .top .delta .chat-container.yo-chart-down,:host .outer-container .p-type-columns .p-column .top .delta .chat-container.yo-chart-up{font-size:var(--font-size-11,3rem);line-height:.625rem}:host .outer-container .p-type-columns .p-column .bottom{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}:host .outer-container .p-type-columns .p-column .bottom .title{display:-webkit-box;width:100%;height:1.25rem;color:var(--text-color,#807f83);font-size:var(--font-size-03,1rem);font-weight:var(--font-weight-01,300);letter-spacing:1.1px;-webkit-box-orient:vertical;overflow:hidden;word-wrap:break-word;word-break:break-all;-webkit-line-clamp:1}:host .outer-container .p-type-columns .p-column .bottom .number{width:100%;font-size:var(--font-size-04,1.125rem);line-height:1.8125rem}:host .outer-container .p-type-rows{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:1.3125rem 1.25rem .8125rem 1.25rem;border-radius:.5rem;background-color:var(--light,#fff);-webkit-box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15));box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15))}:host .outer-container .p-type-rows .p-row{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between;height:3.5625rem;padding-top:var(--padding-10,.625rem);padding-bottom:.5625rem;border-bottom:solid 1px var(--stable-light,#f1f1f1);font-size:var(--font-size-03,1rem)}:host .outer-container .p-type-rows .p-row .title{width:100%;color:var(--text-color,#807f83);font-weight:var(--font-weight-02,400);line-height:1.125rem}:host .outer-container .p-type-rows .p-row .number{line-height:1.125rem}:host .outer-container .p-type-rows .p-row .delta{-ms-flex-item-align:end;align-self:end;line-height:1.125rem}:host .outer-container .p-type-rows .p-row:last-child{margin-bottom:0;border:none}:host .outer-container .p-type-grid{margin:auto;margin-top:3px;padding:1.3125rem 1.25rem .8125rem 1.25rem;border-radius:.5rem;background-color:var(--light,#fff);-webkit-box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15));box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15))}:host .outer-container .p-type-grid .p-type-grid-scroll-container{width:100%;height:100%;overflow-x:auto;overflow-y:hidden}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;margin-bottom:var(--padding-15,.9375rem)}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row span{width:5.4375rem;font-size:var(--font-size-03,1rem);line-height:1.0625rem}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row span:first-child{color:var(--text-color,#807f83)}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row:not(.header){color:var(--black,#000)}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .outer-container .p-type-grid .p-type-grid-scroll-container .inner-container .p-row.header>span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:4.375rem;margin-right:1.0625rem;text-transform:uppercase}:host .outer-container .p-type-chart chart-high{height:18.75rem}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;text-align:left}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column{padding-right:var(--padding-15,.9375rem)}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-header,:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item{height:var(--list-row-height);padding:.25rem 1rem;white-space:nowrap}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item{white-space:nowrap}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.assertive,:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.danger{color:var(--danger,#ff625f)}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.black,:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.dark{color:var(--black,#000)}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.balanced,:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container .p-column .p-column-item.success{color:var(--success,#04cc99)}:host(.kpi) .outer-container .details .p-type-grid .p-type-grid-scroll-container .inner-container.header>span{margin-right:0}:host(.framed) .outer-container{display:block;margin:1rem;padding:1rem;border-radius:5px;-webkit-box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15));box-shadow:var(--grid-frame-shadow,0 5px 15px 3px rgba(40,47,54,.15))}:host(.web) .outer-container yoo-ion-scroll{padding:var(--padding-20,1.25rem)}:host(.web) .outer-container yoo-ion-scroll .details .p-type-columns .p-column{width:46%;height:6.5625rem;margin:0 var(--padding-5,.3125rem) var(--padding-10,.625rem) var(--padding-5,.3125rem);padding:0}:host(.web) .outer-container yoo-ion-scroll .details .p-type-columns .p-column .bottom{padding:0 0 var(--padding-10,.625rem) var(--padding-15,.9375rem)}:host(.web) .outer-container yoo-ion-scroll .details .p-type-columns .p-column .bottom .title{overflow:hidden}:host(.web) .outer-container yoo-ion-scroll .details .p-type-columns .p-column .top{width:calc(100% - (var(--padding-15)*2));padding-left:var(--padding-15,.9375rem)}"}};export{Ct as yoo_camera_preview_dialog,Ot as yoo_form_capture,kt as yoo_form_capture_map_dialog,At as yoo_form_capture_tag_dialog,Tt as yoo_form_capture_view_dialog,Mt as yoo_form_capture_webcam_dialog,_t as yoo_property_card};