var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i["throw"](e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}c((i=i.apply(e,t||[])).next())})};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return c([e,t])}}function c(a){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,r&&(o=a[0]&2?r["return"]:a[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;if(r=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;r=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];r=0}finally{i=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-d99b9c19.system.js","./p-76deb591.system.js","./p-40fcf55a.system.js","./p-fd4afab3.system.js","./p-e3fa184f.system.js","./p-90888482.system.js","./p-350cb6c0.system.js"],function(e){"use strict";var t,n,i,r,o,a,s,c,l,u,d;return{setters:[function(e){t=e.r;n=e.c;i=e.h;r=e.g},function(e){o=e.V;a=e.fX;s=e.ao;c=e.t;l=e.fY;u=e.al;d=e.p},function(){},function(){},function(){},function(){},function(){}],execute:function(){var h=e("yoo_entity_search",function(){function e(e){t(this,e);this.initialSlide=0;this.isLoading=false;this.search=n(this,"search",7);this.cancel=n(this,"cancel",7);this.selected=n(this,"selected",7);this.clearRecents=n(this,"clearRecents",7);this.fieldFetchData=n(this,"fieldFetchData",7)}e.prototype.updateData=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i,r;return __generator(this,function(c){n=t.tab;this.generalData=null;if(n&&n.id==="general"&&e&&!o(e)&&a(e).length>0){this.generalData=e}else{i=this.config.indexOf(n);r=s(this.host,"[attr-name=grid-"+i+"]");if(r){if(t.appendData){r.items=(r.items||[]).concat(e)}else{r.items=e}}}this.isLoading=false;return[2]})})};e.prototype.upsertData=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(r){n=s(this.host,"[attr-name=grid-"+t+"]");if(n.items){i=n.items.findIndex(function(t){return t._id===e._id});if(i>=0){n.items[i]=Object.assign({},e)}else{n.items.unshift(e);n.items=n.items.slice()}}return[2]})})};e.prototype.removeData=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(r){n=s(this.host,"[attr-name=grid-"+t+"]");if(n.items){i=n.items.findIndex(function(t){return t._id===e._id});if(i>=0){n.items=n.items.filter(function(t){return t._id!==e._id}).slice()}}return[2]})})};e.prototype.componentWillLoad=function(){this.tabs=this.config.map(function(e){return{title:e.title||c(e.collectionName.toUpperCase()),value:e.id}});this.refreshers={};this.grids={}};e.prototype.componentDidLoad=function(){this.currentTagsSelected={};this.currentSortsAndFilters={}};e.prototype.onCancel=function(){this.cancel.emit(null)};e.prototype.refresh=function(e){var t=this;if(this.ionSlides){this.ionSlides.getActiveIndex().then(function(n){if(t.navBar&&t.navBar.selectedTab&&(t.currentSearch||t.config[n]&&t.config[n].collectionName)){t.search.emit({search:t.currentSearch,tab:t.config[n],tags:t.currentTagsSelected[t.navBar.selectedTab.value],sortsAndFilters:t.currentSortsAndFilters[t.navBar.selectedTab.value],currentPage:e?e.currentPage:0,pageSize:e?e.pageSize:20,appendData:e?e.appendData:false,infiniteScroll:e?e.infiniteScroll:null});t.isLoading=true}})}};e.prototype.onGridFetchData=function(e,t){this.refresh(e.detail)};e.prototype.onGridPullToRefresh=function(e){var t=this.grids[e.id];var n=this.refreshers[e.id];if(t&&n){t.pullToRefresh(n)}};e.prototype.onEntitySelect=function(e,t,n){e.stopPropagation();t=l(t);t.collectionName=t.collectionName||n;this.selected.emit({entity:e.detail,tab:t})};e.prototype.onShowFilterAdvanced=function(e){var t=this;if(this.navBar&&this.navBar.selectedTab){this.currentSortsAndFilters=this.currentSortsAndFilters||{};var n=document.createElement("yoo-entity-search-dialog");n.model=e;n.values=this.currentSortsAndFilters[this.navBar.selectedTab.value];var i=function(e){e.stopPropagation();t.fieldFetchData.emit(e.detail)};n.addEventListener("fieldFetchData",i);u(n).then(function(e){if(n){n.removeEventListener("fieldFetchData",i);n=null}if(e&&e.data){t.currentSortsAndFilters[t.navBar.selectedTab.value]=e.data;t.refresh()}})}};e.prototype.onIonSlideDidChange=function(e){var t=this;if(this.ionSlides&&this.navBar){this.ionSlides.getActiveIndex().then(function(e){t.navBar.getActiveIndex().then(function(n){if(n!==e){t.navBar.onSelectTab(t.tabs[e],e)}if(t.currentSearch){t.refresh()}})})}this.generalData=null};e.prototype.onTabSelected=function(e){var t=this;if(this.ionSlides&&this.navBar){this.navBar.getActiveIndex().then(function(e){return t.ionSlides.getActiveIndex().then(function(n){if(n!==e){t.ionSlides.slideTo(e,200,true)}})})}this.generalData=null};e.prototype.onTagSelect=function(e){e.stopPropagation();if(this.navBar&&this.navBar.selectedTab&&this.navBar.selectedTab.value){this.currentTagsSelected[this.navBar.selectedTab.value]=e.detail;this.refresh()}};e.prototype.onRecentSearchSelect=function(e){this.onInputChanged(e)};e.prototype.onRecentClear=function(e){this.clearRecents.emit(e)};e.prototype.onInputChanged=function(e){this.currentSearch=e.detail;this.refresh()};e.prototype.renderHeader=function(){var e=this;return i("yoo-header",null,i("yoo-ion-toolbar",{color:"light",centerTitle:false},i("yoo-ion-buttons",{slot:"start"}),i("yoo-form-input",{value:this.currentSearch,class:"search","icon-prefix":"yo-search",hideOptional:true,forceValueUpdate:true,onInputChanged:function(t){return e.onInputChanged(t)},placeholder:c("SEARCH")}),i("yoo-ion-buttons",{slot:"end"},i("yoo-ion-button",{class:{close:true,"button-clear":true,"text-color":d()},onClick:function(){return e.onCancel()}},d()?i("yoo-icon",{class:"yo-close"}):c("CANCEL")))),i("yoo-navbar",{class:"items-space-around",ref:function(t){return e.navBar=t},withLine:true,tabs:this.tabs,onTabSelected:function(t){return e.onTabSelected(t)}}))};e.prototype.renderBody=function(){var e=this;return i("yoo-ion-content",{class:"bg-light",scrollEnabled:false},i("yoo-ion-slides",{class:"entity-search-display",ref:function(t){return e.ionSlides=t},initialSlide:this.initialSlide,onIonSlideDidChange:function(t){return e.onIonSlideDidChange(t)},options:{autoplay:false}},this.config?this.config.map(function(t,n){return i("yoo-ion-slide",null,i("yoo-ion-content",null,i("div",{class:"content"},t.collectionName&&i("div",{class:"toolbar"},i("yoo-entity-search-tags",{onFilterAdvanced:function(){return e.onShowFilterAdvanced(t)},tags:t.tags,sortsAndFilters:e.currentSortsAndFilters?e.currentSortsAndFilters[t.id]:null,hideAdvancedFilters:t.hideAdvancedFilters===true,onSelected:function(t){return e.onTagSelect(t)}})),i("yoo-ion-refresher",{ref:function(n){return e.refreshers[t.id]=n},slot:"fixed",onIonRefresh:function(n){return e.onGridPullToRefresh(t)},disabled:false},i("yoo-ion-refresher-content",{pullingText:c("PULLTOREFRESH")})),!e.generalData&&i("yoo-grid",{ref:function(n){return e.grids[t.id]=n},class:"entity-search",hideHeader:true,hideEmptyState:t.recents&&t.recents.length>0,isLocal:false,emptyState:t.emptyState||t.collectionName,entityType:t.collectionName,displayType:t.displayType||"card-list","attr-name":"grid-"+n,isCollapsible:t.isCollapsible,onSelected:function(n){return e.onEntitySelect(n,t)},onFetchData:function(n){return e.onGridFetchData(n,t)},icons:t.icons,extraClass:t.extraClass},!e.isLoading&&t.recents&&t.recents.length>0?i("yoo-entity-search-recent",{slot:"emptystate",values:t.recents,onSelected:function(t){return e.onRecentSearchSelect(t)},onClear:function(n){return e.onRecentClear(t)}}):null),e.generalData&&a(e.generalData).map(function(n,r){return i("yoo-grid",{class:"entity-search general",heading:c(n.toUpperCase()),forceHeading:true,hideTotal:true,hideToolbar:true,hideEmptyState:t.recents&&t.recents.length>0,isLocal:true,emptyState:n,entityType:n,displayType:"card-list",onSelected:function(i){return e.onEntitySelect(i,t,n)},onFetchData:function(n){return e.onGridFetchData(n,t)},items:e.generalData[n]})}),e.isLoading&&i("yoo-loader",{class:"fixed lg backdrop",text:"LOADING"}))))}):null))};e.prototype.render=function(){return[this.renderHeader(),this.renderBody()]};Object.defineProperty(e.prototype,"host",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{position:absolute;top:0;left:0;right:0;bottom:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between}:host .header,:host yoo-header{width:unset;padding:.5rem;padding-bottom:0;background:var(--light,#fff)}:host .header yoo-ion-buttons,:host yoo-header yoo-ion-buttons{margin-left:1rem}:host .content yoo-ion-slides,:host yoo-ion-content yoo-ion-slides{position:absolute;top:0;left:0;right:0;bottom:0}:host .content .toolbar,:host yoo-ion-content .toolbar{padding-top:1rem}:host .content yoo-grid.general,:host yoo-ion-content yoo-grid.general{margin-top:1rem}:host yoo-navbar{--width-outer-container:unset}"},enumerable:true,configurable:true});return e}())}}});