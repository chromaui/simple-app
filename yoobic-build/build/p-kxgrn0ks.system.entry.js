var __awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(s,i){function r(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n["throw"](e))}catch(e){i(e)}}function l(e){e.done?s(e.value):new o(function(t){t(e.value)}).then(r,a)}l((n=n.apply(e,t||[])).next())})};var __generator=this&&this.__generator||function(e,t){var o={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(n)throw new TypeError("Generator is already executing.");while(o)try{if(n=1,s&&(i=r[0]&2?s["return"]:r[0]?s["throw"]||((i=s["return"])&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;if(s=0,i)r=[r[0]&2,i.value];switch(r[0]){case 0:case 1:i=r;break;case 4:o.label++;return{value:r[1],done:false};case 5:o.label++;s=r[1];r=[0];continue;case 7:r=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(r[0]===6||r[0]===2)){o=0;continue}if(r[0]===3&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(r[0]===6&&o.label<i[1]){o.label=i[1];i=r;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(r);break}if(i[2])o.ops.pop();o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e];s=0}finally{n=i=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:true}}};System.register(["./p-d99b9c19.system.js","./p-76deb591.system.js","./p-40fcf55a.system.js","./p-fd4afab3.system.js","./p-e3fa184f.system.js","./p-90888482.system.js","./p-350cb6c0.system.js"],function(e){"use strict";var t,o,n,s,i,r,a,l,c,u,h,d,f,p,y;return{setters:[function(e){t=e.r;o=e.c;n=e.h;s=e.g},function(e){i=e.i;r=e.b;a=e.cK;l=e.cJ;c=e.o;u=e.z;h=e.q;d=e.t;f=e.S;p=e.p;y=e.bq},function(){},function(){},function(){},function(){},function(){}],execute:function(){var g=e("yoo_chat",function(){function e(e){t(this,e);this.messages=[];this.allowPhoto=true;this.allowGif=true;this.allowAudio=true;this.allowVideo=true;this.selectedTimeTokens=[];this.loadMoreClicked=o(this,"loadMoreClicked",7);this.sendText=o(this,"sendText",7);this.sendChatMedia=o(this,"sendChatMedia",7);this.closePage=o(this,"closePage",7);this.showMore=o(this,"showMore",7);this.closeDeleteMode=o(this,"closeDeleteMode",7);this.selected=o(this,"selected",7);this.deleteMessages=o(this,"deleteMessages",7);this.conferenceMessageClicked=o(this,"conferenceMessageClicked",7);this.isTyping=o(this,"isTyping",7);this.startVideocall=o(this,"startVideocall",7)}e.prototype.onPlaying=function(e){if(e&&e.detail){this.currentActivePlayerId=e.detail}};e.prototype.scrollToBottom=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if(this.scroll){return[2,this.scroll.scrollToBottom(200)]}return[2]})})};e.prototype.scrollToTop=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,this.scrollToInternal(0)]})})};e.prototype.scrollToInternal=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){if(this.scroll){this.scroll.scrollToPoint(0,e,0)}return[2]})})};e.prototype.forceMessageRefresh=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){this.newMessageArr=e.slice();return[2]})})};e.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:if(!this.ionContent)return[3,2];e=this;return[4,this.ionContent.getScrollElement()];case 1:e.scroll=t.sent();if(i()&&r()&&this.enableKeyboardResizing){a(Keyboard)}t.label=2;case 2:return[2]}})})};e.prototype.componentDidUnload=function(){if(i()&&r()&&this.enableKeyboardResizing){l(Keyboard)}};e.prototype.isSomeoneTyping=function(){return this.usersTyping&&Object.keys(this.usersTyping).length>0};e.prototype.getLastMessage=function(e){if(e===this.newMessageArr.length-1){return true}else if(this.newMessageArr[e].author!==this.newMessageArr[e+1].author){return true}else{return false}};e.prototype.getFirstMessage=function(e){if(e===0){return true}else if(this.newMessageArr[e].author!==this.newMessageArr[e-1].author){return true}else{return false}};e.prototype.isNextImage=function(e){return this.newMessageArr&&this.newMessageArr[e+1]&&!c(this.newMessageArr[e+1].img)};e.prototype.onSendText=function(e){e.stopPropagation();this.scrollToBottom();this.sendText.emit(e.detail)};e.prototype.onSendChatMedia=function(e){e.stopPropagation();this.scrollToBottom();this.sendChatMedia.emit(e.detail)};e.prototype.onPullToRefresh=function(){var e=this;this.loadMoreClicked.emit(true);setTimeout(function(){e.refresher.complete()},300)};e.prototype.onCloseDeleteMode=function(){this.selectedTimeTokens=[];this.closeDeleteMode.emit(false)};e.prototype.onSelectMessages=function(e){var t=this;if(e===void 0){e=true}this.selectedTimeTokens=[];if(e){this.messages.forEach(function(e,o){if(e&&!e.deleted&&e.author&&e.author._id===u().user._id){t.selectedTimeTokens.push(e.timetoken)}})}this.selected.emit(this.selectedTimeTokens)};e.prototype.onClickMessage=function(e,t){var o=this;var n=e.detail||false;this.selectedTimeTokens=[];this.messages.forEach(function(e,s){if(e&&(e.timetoken!==t&&e.selected||e.timetoken===t&&n)){o.selectedTimeTokens.push(e.timetoken)}});this.selected.emit(this.selectedTimeTokens)};e.prototype.onDeleteMessages=function(){var e=this;if(this.selectedTimeTokens.length>0){h([{text:d("DELETE"),cssClass:"danger",handler:function(){e.selectedTimeTokens=[];e.deleteMessages.emit(true)}}],"stable")}};e.prototype.onIsTyping=function(e){var t=e&&e.detail||false;this.isTyping.emit(t)};e.prototype.onMapChatActions=function(e){return this.chatSecondaryActions.map(function(t){return Object.assign({},t,{isVisible:function(){return t.isVisible?t.isVisible(e):true},handler:function(){return t.handler?t.handler(e):""}})})};e.prototype.onHighlightMessage=function(e){if(e&&e.detail&&this.chatSecondaryActions&&this.chatSecondaryActions.length>0){h(this.onMapChatActions(e.detail.message),"danger",{preventOverlayClick:true})}};e.prototype.renderReadOnlyHeader=function(){var e=this;return n("yoo-header",{class:"shadow"},n("yoo-ion-toolbar",{color:"light"},(this.closeIcon||!p())&&n("yoo-ion-buttons",{slot:"start"},n("yoo-ion-button",{color:"text-color",onClick:function(){return e.closePage.emit(true)}},n("yoo-icon",{slot:"icon-only",class:this.closeIcon?this.closeIcon:"yo-left"}))),n("yoo-title",null,this.heading),n("yoo-ion-buttons",{slot:"end"},this.canVideoCall&&n("yoo-ion-button",{color:"text-color",onClick:function(){return e.startVideocall.emit(true)}},n("yoo-icon",{slot:"icon-only",class:"yo-videocamera "+f()})),n("yoo-ion-button",{color:"text-color",onClick:function(){return e.showMore.emit(true)}},n("yoo-icon",{slot:"icon-only",class:"yo-more"})))))};e.prototype.renderEditableHeader=function(){var e=this;return n("yoo-header",{class:"shadow delete-mode-header"},n("yoo-ion-toolbar",{color:"success"},n("yoo-ion-buttons",{slot:"start"},n("yoo-ion-button",{color:"success",onClick:function(){return e.onSelectMessages(true)}},d("SELECTALL"))),n("yoo-ion-buttons",{slot:"end"},n("yoo-ion-button",{color:"success",onClick:function(){return e.onCloseDeleteMode()}},d("CANCEL")))))};e.prototype.renderInputBar=function(){var e=this;return n("yoo-input-bar",{class:"footer",placeholder:this.inputPlaceHolder,otherIds:this.otherIds,keepFocusAfterAction:true,onIsTyping:function(t){e.onIsTyping(t)},allowMention:this.isMultiple,allowPhoto:this.allowPhoto,allowGif:this.allowGif,allowAudio:this.allowAudio,allowVideo:this.allowVideo,onSendAudio:function(t){return e.onSendChatMedia(t)},onSendVideo:function(t){return e.onSendChatMedia(t)},onSendPicture:function(t){return e.onSendChatMedia(t)}})};e.prototype.renderDeleteModeFooter=function(){var e=this;return n("div",{class:"delete-mode-footer "+(this.selectedTimeTokens.length>0?f():"disabled")},n("div",{class:"inner-container",onClick:function(){return e.onDeleteMessages()}},n("yoo-icon",{class:"yo-delete"})," ",d(this.selectedTimeTokens.length<=1?"DELETE_MESSAGE":"DELETE_MESSAGES",{number:this.selectedTimeTokens.length})))};e.prototype.renderTypingIcon=function(){return[n("div",{class:"user-typing"},n("div",{class:"typing-indicator"},n("span",null),n("span",null),n("span",null)))]};e.prototype.renderUserName=function(e){return e&&e.firstName&&e.lastName&&n("div",{class:"username"},e.firstName+" "+e.lastName+" "+d("ISTYPING")+"...")};e.prototype.renderUser=function(e){return n("div",{class:"user-container"},e&&n("yoo-avatar",{class:"m",avatarIconSize:"m",user:e}))};e.prototype.renderIsTypingMultiple=function(){var e=this;return Object.keys(this.usersTyping).map(function(t){return[e.renderUserName(e.usersTyping[t]),n("div",{class:"bottom-part"},e.renderUser(e.usersTyping[t]),e.renderTypingIcon())]})};e.prototype.renderSomeoneIsTyping=function(){return[n("div",{class:"someone-typing-container"},this.isMultiple?this.renderIsTypingMultiple():this.renderTypingIcon())]};e.prototype.renderChatMessage=function(){var e=this;this.newMessageArr=this.messages.filter(function(e){return e&&!e.deleted});return this.newMessageArr.map(function(t,o){return[n("yoo-chat-message",{onConferenceMessageClicked:function(t){e.conferenceMessageClicked.emit(t.detail)},message:t,isLast:e.getLastMessage(o),isFirst:e.getFirstMessage(o),onClicked:function(o){return e.onClickMessage(o,t.timetoken)},isNextImage:e.isNextImage(o),isGroup:e.isMultiple,onPresshold:function(t){return e.onHighlightMessage(t)},currentActivePlayerId:e.currentActivePlayerId})]})};e.prototype.render=function(){var e=this;return[this.disableHeader?null:this.deleteModeEnabled?this.renderEditableHeader():this.renderReadOnlyHeader(),n("yoo-ion-content",{class:this.transparent?"":"bg-light",forceOverscroll:false,ref:function(t){return e.ionContent=t}},n("yoo-ion-refresher",{class:this.transparent?"transparent":"",slot:"fixed",onIonRefresh:function(){return e.onPullToRefresh()},disabled:this.deleteModeEnabled,ref:function(t){return e.refresher=t}},n("yoo-ion-refresher-content",{pullingText:d("PULLTOREFRESH")})),n("div",{class:{"messages-container":true,"iphone-x":y()}},this.messages&&this.renderChatMessage(),this.isSomeoneTyping()&&this.renderSomeoneIsTyping())),this.hideInputBar?null:this.deleteModeEnabled?this.renderDeleteModeFooter():this.renderInputBar()]};Object.defineProperty(e.prototype,"host",{get:function(){return s(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".iframe-root{top:0;right:0;bottom:0;left:0;position:absolute;color:var(--black);overflow-y:auto;scrollbar-width:none}.iframe-root yoo-app .wrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%;width:100%}.iframe-root yoo-app .wrapper.center-center{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%}.iframe-root::-webkit-scrollbar{display:none}:host{--typing-username-padding-left:45px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%}\@-webkit-keyframes slide-up{0%{-webkit-transform:translateY(3rem);transform:translateY(3rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}\@keyframes slide-up{0%{-webkit-transform:translateY(3rem);transform:translateY(3rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}\@-webkit-keyframes slide-down{0%{-webkit-transform:translateY(-3rem);transform:translateY(-3rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}\@keyframes slide-down{0%{-webkit-transform:translateY(-3rem);transform:translateY(-3rem)}to{-webkit-transform:translateY(0);transform:translateY(0)}}:host .delete-mode-header{-webkit-animation:slide-down .4s ease;animation:slide-down .4s ease}:host .messages-container{margin-top:.2rem;padding:.3125rem .625rem 5.625rem .625rem}:host .messages-container,:host .messages-container .someone-typing-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}:host .messages-container .someone-typing-container{padding-top:var(--padding-10,.625rem)}:host .messages-container .someone-typing-container .user-typing{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:56px;height:36px;border-radius:18px;background-color:var(--stable-light)}:host .messages-container .someone-typing-container .user-typing .typing-indicator{background-color:var(--stable-light,#f1f1f1);will-change:transform;width:auto;border-radius:50px;display:-ms-flexbox;display:flex;margin:0 auto;position:relative;-webkit-animation:bulge 2s ease-out infinite;animation:bulge 2s ease-out infinite}:host .messages-container .someone-typing-container .user-typing .typing-indicator:after,:host .messages-container .someone-typing-container .user-typing .typing-indicator:before{content:\"\";position:absolute;bottom:-2px;left:-2px;height:8px;width:8px;border-radius:50%;background-color:var(--stable-light,#f1f1f1)}:host .messages-container .someone-typing-container .user-typing .typing-indicator:after{height:3px;width:3px;left:-3px;bottom:-3px}:host .messages-container .someone-typing-container .user-typing .typing-indicator span{height:8px;width:8px;float:left;margin:0 1px;background-color:var(--stable,#adadad);display:block;border-radius:50%;opacity:.4}:host .messages-container .someone-typing-container .user-typing .typing-indicator span:first-of-type{-webkit-animation:blink 1s .3333s infinite;animation:blink 1s .3333s infinite}:host .messages-container .someone-typing-container .user-typing .typing-indicator span:nth-of-type(2){-webkit-animation:blink 1s .6666s infinite;animation:blink 1s .6666s infinite}:host .messages-container .someone-typing-container .user-typing .typing-indicator span:nth-of-type(3){-webkit-animation:blink 1s .9999s infinite;animation:blink 1s .9999s infinite}\@-webkit-keyframes blink{50%{opacity:1}}\@keyframes blink{50%{opacity:1}}\@-webkit-keyframes bulge{50%{-webkit-transform:scale(1.05);transform:scale(1.05)}}\@keyframes bulge{50%{-webkit-transform:scale(1.05);transform:scale(1.05)}}:host .messages-container .someone-typing-container .username{padding-bottom:3px;padding-left:var(--typing-username-padding-left);color:var(--text-color,#807f83);font-size:var(--font-size-02,.875rem)}:host .messages-container .someone-typing-container .bottom-part{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding-left:var(--padding-5,.3125rem)}:host .delete-mode-footer{display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;min-height:3rem;background:var(--light,#fff);font-weight:var(--font-weight-01,300);-webkit-box-shadow:var(--footer-shadow,0 1px 10px 0 rgba(0,0,0,.15));box-shadow:var(--footer-shadow,0 1px 10px 0 rgba(0,0,0,.15));-webkit-animation:slide-up .4s ease;animation:slide-up .4s ease}:host .delete-mode-footer .text-success{color:var(--success,#04cc99)!important}:host .delete-mode-footer .text-danger{color:var(--danger,#ff625f)!important}:host .delete-mode-footer .text-danger-light{color:var(--danger-light,#f46885)!important}:host .delete-mode-footer .text-energized{color:var(--energized,#fed05b)!important}:host .delete-mode-footer .text-royal{color:var(--royal,#845cff)!important}:host .delete-mode-footer .text-info{color:var(--info,#fc459e)!important}:host .delete-mode-footer .text-dark{color:var(--dark,#2b3648)!important}:host .delete-mode-footer .text-text-color{color:var(--text-color,#807f83)!important}:host .delete-mode-footer .text-light{color:var(--light,#fff)!important}:host .delete-mode-footer .text-always-light{color:var(--always-light,#fff)!important}:host .delete-mode-footer .text-light-orange{color:var(--light-orange,#fcae49)!important}:host .delete-mode-footer .text-stable-light{color:var(--stable-light,#f1f1f1)!important}:host .delete-mode-footer .text-stable{color:var(--stable,#adadad)!important}:host .delete-mode-footer .text-warning{color:var(--warning,#ff6402)!important}:host .delete-mode-footer .text-accent{color:var(--accent,#1fb6ff)!important}:host .delete-mode-footer .inner-container{margin-left:var(--padding-15,.9375rem)}:host .delete-mode-footer.disabled{color:var(--stable-40,hsla(0,0%,67.8%,.4))}:host yoo-input-bar{--padding-input-container:0;position:absolute;bottom:0;width:100%;z-index:40000}"},enumerable:true,configurable:true});return e}())}}});