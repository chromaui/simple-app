var __extends=this&&this.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function a(){this.constructor=e}e.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}();System.register(["./p-d99b9c19.system.js","./p-40fcf55a.system.js"],function(t){"use strict";var e,i,a,s,n;return{setters:[function(t){e=t.r;i=t.c;a=t.h;s=t.g},function(t){n=t.S}],execute:function(){var r="assets/game";var o=function(){function t(){this.gameover=new n}t.prototype.initWithPhaser=function(e,i){t._phaser=i;if(e.assetDir){this.assetDir=e.assetDir}else{this.assetDir=r}this.fieldId=e.fieldId;this.initGameInstance(e)};t.prototype.initGameInstance=function(t){return null};t.prototype.getPreloadGame=function(){return null};t.prototype.getCreateGame=function(){return null};t.prototype.getUpdateGame=function(){return null};return t}();o._phaser=null;function h(t,e){t=Math.ceil(t);e=Math.floor(e);return Math.floor(Math.random()*(e-t))+t}function d(t){var e;var i=0;var a=null;for(e=t.length-1;e>0;e-=1){i=Math.floor(Math.random()*(e+1));a=t[e];t[e]=t[i];t[i]=a}}var l=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e.config={gameWidth:400,gameHeight:600};e.values=[];e.correctValues=[];e.wrongValues=[];e.gameOptions={cardScale:1,cardWidth:167,cardHeight:243,flipSpeed:190,flipZoom:1.5,initViewDuration:1e4,backgroundColor:"#fff",mainLabelColor:"#41307c",cardTextColor:"#1d1f35",correctAnswerColor:"#44C3AA"};e.REVEALED_FRAME=1;e.cards=[];e.texts=[];e.flippingCards=[];e.lastPickedCards=[];return e}e.prototype.initGameInstance=function(t){var e=this;this.values=t.values;this.correctValues=t.correctValues;this.wrongValues=t.wrongValues;this.gameInstance=new o._phaser.Game(this.config.gameWidth,this.config.gameHeight,o._phaser.AUTO,t.fieldId,{preload:function(){return e.getPreloadGame()},create:function(){return e.getCreateGame()},update:function(){return e.getUpdateGame()}})};e.prototype.getPreloadGame=function(){this.gameInstance.load.spritesheet("card",this.assetDir+"/card_sprite.png",this.gameOptions.cardWidth,this.gameOptions.cardHeight)};e.prototype.getCreateGame=function(){this.gameInstance.stage.backgroundColor=this.gameOptions.backgroundColor;this.resetGameData();this.initDeck();this.initHUD()};e.prototype.initDeck=function(){var t=this;this.gameOptions.cardScale=Math.min(this.gameInstance.world.width/2/this.gameOptions.cardWidth,this.gameInstance.world.height/2/this.gameOptions.cardHeight)-.05;this.gameOptions.flipZoom=this.gameOptions.cardScale*1.5;var e=[{x:10,y:15},{x:this.gameInstance.world.width-this.gameOptions.cardWidth*this.gameOptions.cardScale-5,y:15},{x:10,y:this.gameInstance.world.height-this.gameOptions.cardHeight*this.gameOptions.cardScale-15},{x:this.gameInstance.world.width-this.gameOptions.cardWidth*this.gameOptions.cardScale-5,y:this.gameInstance.world.height-this.gameOptions.cardHeight*this.gameOptions.cardScale-15}];d(e);for(var i=0;i<this.values.length;i++){this.cards[i]=this.createCard(i,e[i],true);this.texts[i]=this.createCardText(this.cards[i]);this.createFlippingTweens(i,this.cards[i],this.texts[i])}setTimeout(function(){t.hideAllCards();t.mainLabel.setText("")},this.gameOptions.initViewDuration)};e.prototype.initHUD=function(){var t=Math.round(Math.min(this.gameInstance.world.height*.05,this.gameInstance.world.width*.05));this.mainLabel=this.gameInstance.add.text(0,0,"MEMORY-GAME-INSTRUCTIONS",{fontSize:t+"px",fontWeight:"bold",fill:"#fff",boundsAlignH:"center",boundsAlignV:"middle",backgroundColor:this.gameOptions.mainLabelColor});this.mainLabel.setTextBounds(0,this.gameInstance.world.height/2-15,this.gameInstance.world.width,30)};e.prototype.playerHasWon=function(){var t=true;this.cards.forEach(function(e){if(!e.data.solved){t=false}});return t};e.prototype.createCard=function(t,e,i){var a=this.gameInstance.add.sprite(this.gameOptions.cardScale*this.gameOptions.cardWidth/2+e.x,this.gameOptions.cardScale*this.gameOptions.cardHeight/2+e.y,"card");if(i){a.frame=1}a.data={idx:t,text:this.values[t],revealed:i===true,solved:false};a.anchor.set(.5);a.scale.set(this.gameOptions.cardScale);return a};e.prototype.createCardText=function(t){var e={fontSize:"20px",fill:this.gameOptions.cardTextColor,wordWrap:true,wordWrapWidth:t.width,align:"center",backgroundColor:"transparent"};var i=this.gameInstance.add.text(t.x,t.y,t.data.revealed?t.data.text:"",e);i.anchor.set(.5);return i};e.prototype.createFlippingTweens=function(t,e,i){var a=this;e.inputEnabled=true;e.events.onInputDown.add(function(){a.onTapCard(t,e)});e.flipCardTween=this.gameInstance.add.tween(e.scale).to({x:0,y:this.gameOptions.flipZoom},this.gameOptions.flipSpeed/2,o._phaser.Easing.Linear.None);e.flipTextTween=this.gameInstance.add.tween(i.scale).to({x:0,y:this.gameOptions.flipZoom},this.gameOptions.flipSpeed/2,o._phaser.Easing.Linear.None);e.flipCardTween.onComplete.add(function(){e.frame=1-e.frame;if(e.frame===a.REVEALED_FRAME){e.data.revealed=true;i.setText(a.values[t])}else{e.data.revealed=false;i.setText("")}e.backflipCardTween.start();e.backflipTextTween.start()});e.backflipCardTween=this.gameInstance.add.tween(e.scale).to({x:this.gameOptions.cardScale,y:this.gameOptions.cardScale},this.gameOptions.flipSpeed/2,o._phaser.Easing.Linear.None);e.backflipTextTween=this.gameInstance.add.tween(i.scale).to({x:this.gameOptions.cardScale,y:this.gameOptions.cardScale},this.gameOptions.flipSpeed/2,o._phaser.Easing.Linear.None);e.backflipCardTween.onComplete.add(function(){a.flippingCards[t]=false;a.computeGameState()},this)};e.prototype.onTapCard=function(t,e){if(!this.isSomeCardFlipping()&&!e.data.revealed&&this.canFlipAnotherCard()){this.flippingCards[t]=true;this.lastPickedCards.push(e.data.idx);e.flipCardTween.start();e.flipTextTween.start()}};e.prototype.isSomeCardFlipping=function(){return this.flippingCards.indexOf(true)>=0};e.prototype.canFlipAnotherCard=function(){return this.cards.reduce(function(t,e){if(e.data.revealed===true&&e.data.solved===false){t++}return t},0)<2};e.prototype.hideAllCards=function(){for(var t=0;t<this.values.length;t++){if(this.cards[t].data.revealed===true&&this.cards[t].data.solved===false){this.flippingCards[t]=true;this.cards[t].flipCardTween.start();this.cards[t].flipTextTween.start()}}};e.prototype.computeGameState=function(){var t=this;var e=false;if(this.lastPickedCards.length===2){if(this.lastPickedCards.indexOf(0)>=0&&this.lastPickedCards.indexOf(1)>=0){this.cards[0].data.solved=true;this.cards[1].data.solved=true;this.texts[0].addColor(this.gameOptions.correctAnswerColor,0);this.texts[1].addColor(this.gameOptions.correctAnswerColor,0)}if(this.lastPickedCards.indexOf(2)>=0&&this.lastPickedCards.indexOf(3)>=0){this.cards[2].data.solved=true;this.cards[3].data.solved=true;this.texts[2].addColor(this.gameOptions.correctAnswerColor,0);this.texts[3].addColor(this.gameOptions.correctAnswerColor,0)}e=this.playerHasWon()}if(this.lastPickedCards.length>=2){this.lastPickedCards=[];setTimeout(function(){return t.hideAllCards()},800)}if(e){this.mainLabel.setText("GAMEOVER")}};e.prototype.resetGameData=function(){this.cards=[];this.texts=[];this.flippingCards=[];this.lastPickedCards=[]};return e}(o);var c=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e.config={gameWidth:400,gameHeight:600};return e}e.prototype.initGameInstance=function(t){var e=this;this.gameInstance=new o._phaser.Game(this.config.gameWidth,this.config.gameHeight,o._phaser.AUTO,t.fieldId,{preload:function(){return e.getPreloadGame()},create:function(){return e.getCreateGame()},update:function(){return e.getUpdateGame()}})};e.prototype.getPreloadGame=function(){};e.prototype.getCreateGame=function(){};e.prototype.emitGameOver=function(){this.gameover.next(true)};return e}(o);var p=function(t){__extends(e,t);function e(){var e=t.apply(this,arguments)||this;e.gameWidth=300;e.gameHeight=200;e.wrongValues=[];e.correctValues=[];e.fontStyle={font:"15px Arial",fill:"#fff",boundsAlignH:"center",boundsAlignV:"middle"};e.isPaused=true;e.isGameOver=false;e.words=[];e.clouds=[];e.cloudSpeeds=[];e.backgrounds=[];e.blockSpeed=3;e.nextJump=0;return e}e.prototype.initGameInstance=function(t){var e=this;this.gameInstance=new o._phaser.Game(this.gameWidth,this.gameHeight,o._phaser.AUTO,t.fieldId,{preload:function(){return e.getPreloadGame()},create:function(){return e.getCreateGame()},update:function(){return e.getUpdateGame()}})};e.prototype.getPreloadGame=function(){this.gameInstance.load.image("sky",this.assetDir+"/sky.png");this.gameInstance.load.image("ground",this.assetDir+"/ground.png");this.gameInstance.load.image("cloud",this.assetDir+"/cloud.png");this.gameInstance.load.image("bg_hill_1",this.assetDir+"/bg_hill_1.png");this.gameInstance.load.image("bg_hill_2",this.assetDir+"/bg_hill_2.png");this.gameInstance.load.image("block",this.assetDir+"/block.png");this.gameInstance.load.spritesheet("mario",this.assetDir+"/mario.png",50,50)};e.prototype.getCreateGame=function(){this.gameInstance.physics.startSystem(o._phaser.Physics.ARCADE);this.resetGameData();this.initBackgroundElements();this.initCollectibleObjects();this.initHUD();this.initPlayer();this.initListeners()};e.prototype.getUpdateGame=function(){if(this.gameInstance&&this.gameInstance.physics&&this.gameInstance.physics.arcade){this.gameInstance.physics.arcade.collide(this.player,this.groundTile);this.gameInstance.physics.arcade.overlap(this.player,this.block,this.handleCollision,null,this)}if(!this.isPaused&&!this.isGameOver){if(this.isJumping){this.player.loadTexture("mario",5);this.jumpNow()}else{this.player.animations.play("walk")}for(var t=0;t<this.backgrounds.length;t++){var e=this.backgrounds[t];if(e.x>-600){e.x-=4}else{e.x=this.gameInstance.world.width+600}}for(var t=0;t<this.clouds.length;t++){var i=this.clouds[t];if(i.x>-100){i.x-=this.cloudSpeeds[t]}else{i.x=500}}if(this.block.x>-250){this.block.x-=this.blockSpeed}else{this.block.x=this.gameInstance.world.width+250;this.remainingWordsText.setText("WORDS");if(this.words.length>0){this.currentWord=this.words.shift();this.block.removeChild(this.blockLabel);this.blockLabel=this.gameInstance.add.text(40,5,this.currentWord,this.fontStyle);this.block.addChild(this.blockLabel)}else{this.player.loadTexture("mario",5);this.gameOver()}}}else{this.player.animations.stop()}};e.prototype.initBackgroundElements=function(){this.gameInstance.add.tileSprite(0,0,this.gameWidth,this.gameHeight,"sky");for(var t=0;t<4;t++){var e=h(1,4)===2?1:-1;var i=this.gameInstance.add.sprite(this.gameInstance.world.width/2+e*(30*t),t*30+80,"cloud");i.anchor.set(.5,.5);i.alpha=Math.random();this.clouds.push(i);this.cloudSpeeds.push(h(0,5)+2)}this.backgrounds.push(this.gameInstance.add.sprite(0,this.gameInstance.world.height-100,"bg_hill_1"));this.backgrounds.push(this.gameInstance.add.sprite(800,this.gameInstance.world.height-100,"bg_hill_2"));this.groundTile=this.gameInstance.add.tileSprite(0,this.gameInstance.world.height-16,this.gameInstance.world.width,this.gameInstance.world.height,"ground");this.gameInstance.physics.arcade.enable(this.groundTile);this.groundTile.body.allowGravity=false;this.groundTile.body.immovable=true};e.prototype.initCollectibleObjects=function(){this.block=this.gameInstance.add.sprite(this.gameInstance.world.width+500,this.gameInstance.world.height-60,"block");this.block.animations.add("spin");this.block.animations.play("spin",2,true);this.remainingWordsText=this.gameInstance.add.text(16,20,"WORDS"+":"+this.words.length,this.fontStyle);this.currentWord=this.words.shift();this.blockLabel=this.gameInstance.add.text(40,5,this.currentWord,this.fontStyle);this.block.addChild(this.blockLabel);this.gameInstance.physics.arcade.enable(this.block)};e.prototype.initHUD=function(){var t=this;this.centeredLabel=this.gameInstance.add.text(0,0,"START",this.fontStyle);this.centeredLabel.setTextBounds(0,this.gameInstance.world.height/2-15,this.gameInstance.world.width,30);this.centeredLabel.inputEnabled=true;this.centeredLabel.events.onInputDown.add(function(){t.isPaused=false;t.centeredLabel.setText("");t.centeredLabel.inputEnabled=false});this.pauseLabel=this.gameInstance.add.text(this.gameInstance.world.width-100,20,"PAUSE",this.fontStyle);this.pauseLabel.inputEnabled=true;this.pauseLabel.events.onInputDown.add(function(){t.pauseUnPauseGame()})};e.prototype.initPlayer=function(){this.player=this.gameInstance.add.sprite(30,this.gameInstance.world.height-70,"mario");this.gameInstance.physics.arcade.enable(this.player);this.player.body.bounce.y=.2;this.player.body.gravity.y=700;this.player.body.collideWorldBounds=true;this.player.animations.add("walk",[1,2,3,4],20,true)};e.prototype.initListeners=function(){var t=this;this.gameInstance.input.onDown.add(function(){if(!t.isPaused&&!t.isGameOver){t.isJumping=true}});this.gameInstance.input.onUp.add(function(){if(!t.isPaused&&!t.isGameOver){t.isJumping=false}})};e.prototype.pauseUnPauseGame=function(){if(this.isPaused){this.isPaused=false;this.gameInstance.state.resume();this.centeredLabel.setText("");this.pauseLabel.setText("PAUSE")}else{this.isPaused=true;this.gameInstance.state.pause();this.pauseLabel.setText("PAUSE")}};e.prototype.jumpNow=function(){if(this.gameInstance.time.now>this.nextJump){this.player.body.velocity.y=-400;this.nextJump=this.gameInstance.time.now+1500}};e.prototype.handleCollision=function(t,e){e.x=this.gameInstance.world.width+500;if(this.wrongValues.indexOf(this.currentWord)>=0){t.loadTexture("mario",6);this.gameOver()}else{this.score++;this.remainingWordsText.setText("WORDS"+":"+this.words.length);if(this.words.length>0){this.currentWord=this.words.shift();e.removeChild(this.blockLabel);this.blockLabel=this.gameInstance.add.text(40,5,this.currentWord,this.fontStyle);e.addChild(this.blockLabel)}else{t.loadTexture("mario",5);this.gameOver()}}};e.prototype.resetGameData=function(){this.score=0;this.clouds=[];this.cloudSpeeds=[];this.block={x:-250};this.isGameOver=false;this.isPaused=true;this.isJumping=false};e.prototype.gameOver=function(){this.centeredLabel.setText("GAMEOVER");this.pauseLabel.setText("");this.isGameOver=true;this.gameover.next(true)};return e}(o);var u={runner:"Runner",card:"Card",example:"Example"};function g(t){switch(t){case u.runner:return new p;case u.card:return new l;case u.example:return new c;default:return null}}var m=t("yoo_form_input_game",function(){function t(t){e(this,t);this.gameName=u.runner;this.fieldId="game-div";this.gameProps=null;this.gameOver=i(this,"gameOver",7)}t.prototype.componentDidLoad=function(){var t=this;setTimeout(function(){return t.init()},300)};t.prototype.componentWillUpdate=function(){if(this.isGameOver){this.gameOver.emit(true)}};t.prototype.setGameProps=function(){this.gameProps={fieldId:this.fieldId}};t.prototype.init=function(){var t=this;this.game=g(this.gameName);this.game.gameover.subscribe(function(e){t.isGameOver=e});this.setGameProps();this.game.initWithPhaser(this.gameProps,this.phaser)};t.prototype.render=function(){return a("div",null,a("div",{class:"outer-container",id:this.fieldId}))};Object.defineProperty(t.prototype,"host",{get:function(){return s(this)},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return""},enumerable:true,configurable:true});return t}())}}});